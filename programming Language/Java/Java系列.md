# è®¡ç®—æœºåŸºç¡€
* ç¼–ç  [link](https://www.bilibili.com/video/BV1xD4y1y7yc/?p=3&share_source=copy_web&vd_source=06916e4965d23cba05dd9e3692d8ca39)
ç¼–ç æ–¹å¼å°±æ˜¯ä¸€å¼ è¡¨ï¼šå‡å¦‚æˆ‘æƒ³åœ¨è®¡ç®—æœºé‡Œé¢å­˜`a`ï¼Œé‚£è¯¥å¦‚ä½•ç”¨äºŒè¿›åˆ¶è¡¨ç¤º`a`å‘¢ï¼Ÿ
    * ASCIIï¼ˆAmerica standard code for information interchangeï¼‰(ç¾å›½è§„å®š)
    asciiè¡¨ï¼šå¦‚æœæƒ³å­˜aï¼Œå°±åœ¨åº•å±‚å­˜`0110 0001`(ç¼–ç );ç›¸åï¼Œå¦‚æœä»å†…å­˜ä¸­å–å‡ºæ¥`0110 0001`ï¼Œå°±åœ¨å±å¹•ä¸Šæ˜¾ç¤ºa(è§£ç )
    * GBKï¼ˆå›½æ ‡æ‰©ï¼ˆå±•ï¼‰ï¼‰ï¼ˆä¸­å›½è§„å®šï¼‰
    1ã€GBKå…¼å®¹ASCIIï¼Œæ‰€ä»¥GBKçš„è¡¨0~127çš„ä½ç½®éƒ½è¦è®©ç»™ASCIIï¼Œä»åé¢ç”¨
    2ã€ä¸€ä¸ªæ±‰å­—å¯¹åº”ä¸¤ä¸ªå­—èŠ‚
    > Q: åœ¨GBKä¸­å¦‚ä½•åŒºåˆ†æ±‰å­—å’Œè‹±æ–‡å­—æ¯ï¼Ÿ
    GBKä¸­æ±‰å­—çš„äºŒè¿›åˆ¶ä¸€å®šä»¥1å¼€å¤´ï¼Œä¸”å¿…é¡»å ä¸¤ä¸ªå­—èŠ‚

    * Unicodeï¼ˆå›½é™…ç»Ÿä¸€è§„å®šï¼‰
        * UTF-32
        ä¸€ä¸ªå­—ç¬¦ç”¨4ä¸ªByteå­˜å‚¨ï¼›å¤ªæµªè´¹å†…å­˜
        * UTF-8
        1ã€è‹±æ–‡å’Œæ•°å­—ï¼šå ä¸€ä¸ªå­—èŠ‚
        2ã€æ±‰å­—ï¼šå ä¸‰ä¸ªå­—èŠ‚
* ä»€ä¹ˆæ˜¯ANSIç¼–ç ï¼Ÿ
æ“ä½œç³»ç»Ÿé»˜è®¤ç¼–ç 
* ä»€ä¹ˆæ˜¯BOMï¼Ÿ
    * å…¨ç§°Byte On Mark
    å¦‚æœä¸ä½¿ç”¨BOMï¼Œé‚£ä¸€ä¸ªç©ºæ–‡ä»¶é‡Œå°±æ˜¯ç©ºçš„
    å¦‚æœä½¿ç”¨BOMï¼Œå³ä½¿æ–‡ä»¶å†…å®¹æ˜¯ç©ºçš„ï¼Œä½†æ˜¯æ–‡ä»¶æœ€å¼€å§‹ä¼šå­˜åœ¨è‹¥å¹²ä¸ªå­—èŠ‚ï¼Œç”¨æ¥æ ‡æ˜æ–‡ä»¶çš„ç¼–ç æ ¼å¼
    <img src="BOM.png">
* Javaä¸­charä¸­æ–‡å­—ç¬¦ä¸²åœ¨å†…å­˜ä¸­çš„å­˜åœ¨æ–¹å¼ï¼Ÿ
ä¸€ä¸ªcharä»¥utf-16çš„ç¼–ç æ–¹å¼å ä¸¤ä¸ªå­—èŠ‚è€Œå­˜åœ¨
å¦‚ä½•éªŒè¯ï¼Ÿdebugå°±è¡Œ
* å¦‚ä½•å°†å­—ç¬¦ä¸²ä»¥GBKçš„æ–¹å¼å†™å…¥æ–‡ä»¶ï¼Ÿ
```java
    public static void main(String[] args) throws IOException {
        String str = "å¤§å®¶å¥½ï¼";
        OutputStreamWriter writer = new OutputStreamWriter(new FileOutputStream("a.txt"), "GBK");
        writer.write(str);
        writer.flush();
    }
```
# JDK
## switch
> å¦‚æœ case è¯­å¥å—ä¸­æ²¡æœ‰ break è¯­å¥æ—¶ï¼ŒåŒ¹é…æˆåŠŸåï¼Œä»å½“å‰ case å¼€å§‹ï¼Œåç»­æ‰€æœ‰ case çš„å€¼éƒ½ä¼šè¾“å‡ºã€‚
```java
switch (i){
                case 0:
                    cell.setCellValue("æ‰€åœ¨éƒ¨é—¨");
                    break;
                case 1:
                    cell.setCellValue("å‘˜å·¥å§“å");
                    break;
                case 2:
                    cell.setCellValue("é£Ÿå ‚é€‰æ‹©");
                    break;
                case 3:
                    cell.setCellValue("å°±é¤äººæ•°");
                    break;
                case 4:
                    cell.setCellValue("å°±é¤é‡‘é¢");
                    break;
                case 5:
                    cell.setCellValue("å°±é¤äººå‘˜");
                    break;
                case 6:
                    cell.setCellValue("å¡«æŠ¥æ—¥æœŸ");
                    break;
                case 7:
                    cell.setCellValue("é™„ä»¶");
                    break;
            }
```

## enhanced for statement
* è¯­æ³•
```java
for (V : Ex){
    //some statement
}
```
`:`å³è¾¹æœ‰ä¸¤ç§å¯èƒ½ï¼š
1ã€Exæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡implements Iterable 
2ã€Exæ˜¯ä¸€ä¸ªæ•°ç»„
å¦‚æœExæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå¢å¼ºforå¾ªç¯ä¼šè¢«ç¿»è¯‘ä¸ºå¦‚ä¸‹å½¢å¼çš„æ™®é€šforå¾ªç¯
```java
for (I #i = Expression.iterator(); #i.hasNext(); ) {
    {VariableModifier} TargetType Identifier =
        (TargetType) #i.next();
    Statement
}
```
å¦‚æœExæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå¢å¼ºforå¾ªç¯ä¼šè¢«ç¿»è¯‘ä¸ºå¦‚ä¸‹å½¢å¼çš„æ™®é€šforå¾ªç¯
```java
for (int #i = 0; #i < #a.length; #i++) {
    {VariableModifier} TargetType Identifier = #a[#i];
    Statement
}
```
### å‚è€ƒèµ„æ–™
* [jdkæ–‡æ¡£](https://docs.oracle.com/javase/specs/jls/se8/html/jls-14.html#jls-14.14.2)
* [StackOverflow](https://stackoverflow.com/questions/85190/how-does-the-java-for-each-loop-work)
# JavaåŸºç¡€
* ä»€ä¹ˆæ˜¯devopsï¼Ÿ[link](https://www.ruanyifeng.com/blog/2023/03/platform-engineering.html)
*  ä¸å†…å­˜ç›¸å…³
    * å½“å†™`Person p1`ï¼Œå°±ä¼šåœ¨å†…å­˜ï¼ˆæ ˆï¼‰é‡Œæœ‰ä¸€å—åŒºåŸŸè¡¨ç¤ºp1ï¼Œåœ¨`new Person()`çš„æ—¶å€™ï¼Œæ‰ä¼šåœ¨å†…å­˜ï¼ˆheapï¼‰é‡Œå¼€è¾Ÿä¸€å—åŒºåŸŸè¡¨ç¤ºå¯¹è±¡ï¼Œå¹¶æŠŠè¿™ä¸ªå¯¹è±¡çš„åœ°å€èµ‹ç»™p1
    * å…³äºæ„é€ å™¨ï¼š`é€šè¿‡è°ƒç”¨æ„é€ å™¨ï¼Œæ‰åœ¨å†…å­˜é‡Œåˆ›å»ºå¯¹è±¡`
* æˆ‘ä»¬çŸ¥é“JVMå°±æ˜¯ä¸€ä¸ªç¨‹åºï¼Œé‚£ä»€ä¹ˆæ˜¯JDKï¼Ÿä»€ä¹ˆåˆæ˜¯JREï¼Ÿï¼šJDKï¼ˆJava Development Kitï¼‰=JRE+ä¸€äº›ç¨‹åºï¼ˆjavac,jar.exeï¼‰ï¼›JREï¼ˆJava Runtime Environmentï¼‰= JVM+ä¸€äº›åº“ï¼›ä¸ºä»€ä¹ˆæ‰“å¼€é¡¹ç›®çš„æ—¶å€™æˆ‘ä»¬éœ€è¦é…ç½®JDKå‘¢ï¼Ÿæˆ‘è§‰å¾—ä¸€æ–¹é¢ideaçš„è‡ªåŠ¨ç¼–è¯‘åŠŸèƒ½åº”è¯¥ä¾é JDKä¸­çš„javacï¼Œè¿è¡Œçš„æ—¶å€™éœ€è¦JRE
* ç±»ä¸­çš„ä¸œè¥¿
    * åŒ¿åå¯¹è±¡
    * ä»£ç å—
        * å½¢å¼ï¼š`{}`
        * åˆ†ç±»
            * å¯ä»¥ç”¨staticä¿®é¥°çš„é™æ€ä»£ç å—ï¼š`static{}`ï¼›1.æˆ‘ä»¬çŸ¥é“ï¼Œstaticä¿®é¥°çš„ä¸œè¥¿ä¼šéšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ï¼ˆä»£ç ä¸­å‡ºç°è¿™ä¸ªç±»çš„æ—¶å€™ï¼‰`Person.desc`ï¼Œè€Œé™æ€ä»£ç å—ä¼šéšç€ç±»çš„åŠ è½½è€Œ**æ‰§è¡Œ**
            * è£¸çš„ä»£ç å—/éé™æ€ä»£ç å—ï¼š`{}`ï¼›1.æˆ‘ä»¬çŸ¥é“ï¼Œä¸ç”¨staticä¿®é¥°çš„ä¼šéšç€å¯¹è±¡çš„åˆ›å»ºè€Œåˆ›å»ºï¼Œéé™æ€ä»£ç å—ä¼šéšç€å¯¹è±¡çš„åˆ›å»º`new Person()`è€Œè‡ªåŠ¨æ‰§è¡Œ
* `\t`:è¡¨ç¤ºä¸€ä¸ªtabï¼ˆ8ä¸ªç©ºæ ¼ï¼‰
```java
public static void main(String[] args) {
        System.out.println("Hello\tWorld!"); //Hello	World!
    }
```
* è¯­æ³•
    * ç»§æ‰¿çš„ä¸€ä¸ªåº”ç”¨ï¼šä»£ç å¤ç”¨ å°šç¡…è°·p228
    * æ³¨è§£ï¼ˆAnnotationï¼‰
## ClassLoader
### getSystemResource() method
#### å‚è€ƒèµ„æ–™
1. [herongyang](https://www.herongyang.com/JVM/ClassLoader-getSystemResource-Method-Find-File.html)
2. [What's the default classpath when not specifying classpath?](https://stackoverflow.com/questions/8227682/whats-the-default-classpath-when-not-specifying-classpath)
#### åˆ†æ
å¦‚æœä»£ç ä¸­è°ƒç”¨äº†`ClassLoader.getSystemResource('a.txt')`ï¼š
é‚£ä¹ˆä»£ç ä¼šå°†åŠ è½½èµ„æºçš„ä»»åŠ¡äº¤ç»™å½“å‰ç±»çš„åŠ è½½å™¨,è®©è¯¥ç±»çš„åŠ è½½å™¨å»åŠ è½½èµ„æºgetResources
```java
    public static URL getSystemResource(String name) {
        ClassLoader system = getSystemClassLoader(); //appClassLoader
        if (system == null) {
            return getBootstrapResource(name);
        }
        return system.getResource(name);
    }
```
ç±»-åŠ è½½å™¨(app-classloader)ä¹Ÿä¸æƒ³å¹²è¿™ä¸ªæ´»ï¼Œä»–ä¼šæŠŠè¿™ä¸ªä»»åŠ¡å¾€ä¸ŠæŠ›ï¼Œæ‰”ç»™è‡ªå·±çš„çˆ¶-åŠ è½½å™¨(ext-classloader)
```java
    public URL getResource(String name) {
        URL url;
        if (parent != null) {
            url = parent.getResource(name);
        } else {
            url = getBootstrapResource(name);
        }
        if (url == null) {
            url = findResource(name);
        }
        return url;
    }
```
æ‰€ä»¥æœ€ç»ˆï¼Œè°ƒç”¨çš„æ˜¯ä¸‹é¢çš„æ–¹æ³•
```java
    //Find resources from the VM's built-in classloader
    private static URL getBootstrapResource(String name) {
        URLClassPath ucp = getBootstrapClassPath();
        Resource res = ucp.getResource(name);
        return res != null ? res.getURL() : null;
    }
```
VM's built-in classloader(bootstrap-classloader)ä¼šå»**ä¸€äº›**ç›®å½•ä¸‹å»æ‰¾è¿™ä¸ªèµ„æºï¼Œè¿™äº›ç›®å½•å…¶ä¸­ä¹‹ä¸€å°±æ˜¯default classpath
æ ¹æ®å‚è€ƒèµ„æ–™2ï¼Œdefault classpathå°±æ˜¯classesç›®å½•ä¸‹,**ä¸åŒ…å«å­ç›®å½•ï¼**
å› ä¸ºæ— è®ºæ˜¯è‡ªå·±å¯åŠ¨jvmè¿˜æ˜¯ideaå¸®ä½ å¯åŠ¨ï¼Œå¯åŠ¨ç›®å½•éƒ½æ˜¯classesï¼Œè€Œ`The default value of the class path is "."`

å¦‚æœæƒ³ä»å…¶ä»–ç›®å½•ä¸­åŠ è½½èµ„æºï¼Œå°±å¦‚å‚è€ƒèµ„æ–™1ä¸­æ‰€è¯´:
> If I want the JVM to load the logo.jpg file and the Hello.class from MyZIP.zip file, I need to use "-classpath" option to tell the JVM to search in MyZIP.zip first:
## Jar
* ç¼–è¯‘æ—¶å°†æºæ–‡ä»¶ä¸classesåˆ†å¼€(å½“å‰åœ¨srcç›®å½•ï¼Œè¦å»æ–°å»ºclassessç›®å½•):`javac -d ../classes Hello.java`
* æ‰“jaråŒ…
    1ã€åœ¨classesæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºmanifest.txt
    ```txt
    Main-Class:<ç©ºæ ¼>Hello<å›è½¦>//æ ¼å¼éå¸¸ä¸¥æ ¼
    ```
    2ã€`jar -cvmf manifest.txt app1.jar *.class`
    3ã€`java -jar app1.jar`è¿™æ ·å°±å¯ä»¥è¿è¡ŒjaråŒ…äº†
* package
    * ä¸ºä»€ä¹ˆè¦å¼•å…¥åŒ…ï¼Ÿ
    Javaè¦å†™å‡ºå¯ä»¥é‡ç”¨çš„ç»„ä»¶ï¼šæ¯”å¦‚æˆ‘å†™äº†ä¸€ä¸ªéå¸¸å¥½ç”¨çš„ç±»å«åšutilï¼Œæˆ‘æŠŠæˆ‘çš„ç±»åˆ†äº«ç»™ä½ ç”¨ï¼Œå¯æ°å¥½ä½ éœ€è¦ç”¨æˆ‘çš„uiltæä¾›çš„åŠŸèƒ½å†™ä¸€ä¸ªè‡ªå·±çš„utilç±»ï¼Œè¿™æ—¶å€™ä¸¤ä¸ªclassçš„åå­—å°±å†²çªäº†ã€‚æ”¹åæ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºè¦è§åçŸ¥æ„ï¼›
    Javaå¼•å…¥packageæ¥è§£å†³å‘½åå†²çªã€‚
    å¼•å…¥åŒ…ä»¥åï¼Œæˆ‘çš„utilç±»çš„åå­—æ˜¯com.cbc.util,ä½ çš„utilç±»çš„åå­—æ˜¯com.somebody.util,å°±ä¸ä¼šå‘½åå†²çª
    * ä½¿ç”¨package
    1ã€éœ€è¦åœ¨srcä¸‹å»å»ºç«‹com/headfirstjava,ç„¶ååœ¨com/headfirstjavaä¸‹å†™çš„javaæ–‡ä»¶çš„ç¬¬ä¸€è¡ŒåŠ ä¸Š`package com.headfirstjava;`
    2ã€åœ¨srcä¸‹ç¼–è¯‘ï¼š`E:\code\Java_learn\src>javac -d ../classes com/headfirstjava/*.java`è¿™æ—¶å€™classesæ–‡ä»¶å¤¹ä¸‹å¯ä»¥æ²¡æœ‰ä»»ä½•ä¸œè¥¿ï¼Œç¼–è¯‘å®Œæˆåå°±ä¼šè‡ªåŠ¨ç”Ÿæˆcom/headfirstjavaæ–‡ä»¶å¤¹ä»¥åŠä¸‹é¢çš„*.classæ–‡ä»¶
    3ã€åœ¨classesç›®å½•ä¸‹ï¼š`E:\code\Java_learn\classes>java com.headfirstjava.Hello`ï¼›javaä¼šè‡ªåŠ¨åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹å»æ‰¾com&headfirstjavaæ–‡ä»¶å¤¹ï¼Œç„¶åå»è¿è¡ŒHello.classæ–‡ä»¶ã€‚å¦‚æœæŠŠHello.classæ–‡ä»¶ç§»åŠ¨åˆ°å…¶ä»–åœ°æ–¹ï¼Œéƒ½ä¸èƒ½è¿è¡Œ
    * å°†packageæ‰“æˆjaråŒ…
    1ã€åœ¨classesç›®å½•ä¸‹åˆ›å»ºmanifestæ–‡ä»¶
    2ã€classesç›®å½•ä¸‹ï¼š`jar -cvmf manifest.txt package.jar com`åªéœ€è¦æŒ‡å®šcom
    3ã€classesç›®å½•ä¸‹ï¼š`java -jar .\package.jar`
    > é€šè¿‡ä¸Šé¢å°±å¯ä»¥è§£é‡Šï¼šä¸ºä»€ä¹ˆä¸€ä¸ªç±»ä¸­æœ‰packageï¼ŒæŠŠå®ƒç¼–è¯‘åçš„classæ–‡ä»¶å¤åˆ¶å‡ºæ¥ï¼Œç„¶åç›´æ¥cmdå‘½ä»¤è¡Œå»javaè¿è¡Œä¼šæ˜¾ç¤ºâ€œé”™è¯¯: æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±» Helloâ€
    æƒ³è¦è¿è¡Œå°±è¦åˆ›å»ºå¥½åŒ…ï¼ŒæŠŠclassæ–‡ä»¶æ”¾åˆ°åŒ…é‡Œï¼Œç„¶ååœ¨åŒ…å¤–é¢å»cmdå‘½ä»¤è¡Œjavaè¿è¡Œ
## åŸºæœ¬è¯­æ³•
* 8ç§åŸºæœ¬æ•°æ®ç±»å‹
    * å“ªå…«ç§ï¼Ÿ
    char;boolen;byteã€shortã€intã€long;floatã€double
    * æ•´å‹ï¼šå››ç§æ•´å‹ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
    * char
        * åœ¨Javaä¸­å å‡ ä¸ªå­—èŠ‚ï¼Ÿ
        ä¸¤ä¸ªå­—èŠ‚
        * æœ¬è´¨
        charçš„åº•å±‚å­˜çš„æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œå¯¹åº”çš„æ˜¯è¯¥å­—ç¬¦çš„unicodeç¼–ç ï¼›
        å› ä¸ºcharæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œæ‰€ä»¥`char >> 1`æ˜¯æ— ç¬¦å·å³ç§»ï¼Œç¬¬ä¸€ä½æ°¸è¿œè¡¥0
    * æˆ‘ä»¬è¯´ï¼Œlongå˜é‡èµ‹å€¼ä¸€å®šè¦åœ¨åé¢åŠ ä¸ŠLï¼Œä½†`long l = 1234`ç¼–è¯‘é€šè¿‡ï¼Œä¸ºä»€ä¹ˆï¼Ÿfloatå˜é‡åé¢ä¸€å®šè¦åŠ ä¸ŠFï¼Œ`float f = 12.3`ä¼šå‡ºç°ä»€ä¹ˆç¼–è¯‘é”™è¯¯ä¿¡æ¯ï¼Ÿ
    1ã€1234è¢«çœ‹æˆintï¼Œç„¶åå°†intèµ‹ç»™longï¼Œå±æ€§è‡ªåŠ¨ç±»å‹æå‡ï¼›å¦‚æœå†™æˆ`long l = 123456789`å°±ä¼šç¼–è¯‘æŠ¥é”™
    2ã€12.3è¢«çœ‹ä½œdoubleï¼Œdoubleå¾€floatè½¬ï¼Œç¼–è¯‘æŠ¥é”™
    > åœ¨javaä¸­ï¼Œ123ç±»ä¼¼çš„æ•´æ•°é»˜è®¤ä¸ºintå‹ï¼Œ12.13ç­‰å°æ•°é»˜è®¤ä¸ºdoubleå‹;
    æ‰€ä»¥åœ¨ä»£ç ä¸­è¿™æ ·å†™ï¼š`byte b = a+1`(aæ˜¯byte)å°±ä¼šæŠ¥é”™
* è‡ªåŠ¨ç±»å‹è½¬æ¢&å¼ºåˆ¶ç±»å‹è½¬æ¢ 
    * ä»€ä¹ˆæ˜¯è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼Ÿå…³äºshort,byte,charç‰¹æ®Šæƒ…å½¢ï¼Ÿ
    * ä»€ä¹ˆæ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Ÿ
    ```java
    //å¼ºè½¬çš„å‰ææ˜¯å…ˆä½¿ç”¨å¤šæ€ï¼Œåœ¨è¿›è¡Œå¼ºè½¬
    Object obj = new String();
    String str = (String) obj
    //æ­£å¸¸ç¼–è¯‘ï¼Œä½†è¿è¡Œæ—¶ä¼šæŠ¥é”™
    Object obj = new Object();
    String str = (String) obj
    ```
    * Javaä¸­çš„ç±»å‹è½¬æ¢
    ```java
    //1ã€å‘ä¸Šè½¬æ¢
    Person p = new Person();
    Object obj = (Object) p;
    //2ã€å‘ä¸‹è½¬æ¢
    Object obj = new Object();
    Person p = (Person) obj;

    //è¿™ä¸¤ç§éƒ½èƒ½é€šè¿‡ç¼–è¯‘ï¼Œä½†æ˜¯ç¬¬äºŒç§åœ¨è¿è¡Œæ—¶ä¼šæŠ¥é”™ï¼›
    //ä»å†…å­˜ä¸­å¾ˆå¥½ç†è§£ï¼šå‘ä¸Šè½¬æ¢ï¼Œå…¶å®å†…å­˜ä¸­çš„å¯¹è±¡æ‰€å«çš„æ•°æ®æ˜¯â€œå¤Ÿçš„â€
    //                å‘ä¸‹è½¬æ¢ï¼Œå†…å­˜ä¸­å¯¹è±¡æ‰€å«çš„æ•°æ®æ˜¯â€œä¸å¤Ÿçš„â€
    ```
* å…³äºæ³¨é‡Šï¼š
    * å•è¡Œæ³¨é‡Šï¼š//
    * å¤šè¡Œæ³¨é‡Šï¼š/*   */
    * æ–‡æ¡£æ³¨é‡Šï¼š/**   */ :æ–‡æ¡£æ³¨é‡Šå¯ä»¥ä½¿ç”¨Javadocå‘½ä»¤è§£ææˆdocæ–‡ä»¶ å°šç¡…è°·å®‹p37


* ç±»å’Œç±»ä¸­çš„å†…å®¹
    * æ–¹æ³•
        * ä»€ä¹ˆæ˜¯æ–¹æ³•çš„é‡è½½ï¼Ÿæ€ä¹ˆåˆ¤æ–­å“ªäº›æƒ…å†µæ˜¯ä¸æ˜¯é‡è½½?é‡è½½ä¸è¿”å›å€¼ç±»å‹å’Œæƒé™ä¿®é¥°ç¬¦æ²¡æœ‰å…³ç³»
        * ä»€ä¹ˆæ˜¯å¯å˜ä¸ªæ•°å½¢å‚çš„æ–¹æ³•ï¼Ÿå®ƒä¸å‚æ•°ä¸ºæ•°ç»„ä¹‹é—´çš„å…³ç³»ï¼Ÿï¼ˆä¸èƒ½å…±å­˜&è°ƒç”¨æ–¹å¼ä¸åŒï¼‰ï¼›å¦‚æœæ–¹æ³•å‚æ•°ä¸ºæ•°ç»„ï¼Œæˆ‘ä»¬å¯ä»¥éå†å¾—åˆ°æ‰€æœ‰çš„ä¼ å…¥å˜é‡ï¼Œé‚£ç”¨å¯å˜ä¸ªæ•°å½¢å‚è¯¥æ€ä¹ˆå¾—åˆ°ï¼Ÿã€p209ã€‘
    * åŒ¿åå¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿ `method(new Person()); //ä¸è§„èŒƒçš„å†™æ³•`
    * åŒ¿åå­ç±»çš„å†™æ³•ï¼Ÿ
    ```java
    Person p = new Person(){
        //é‡å†™æ–¹æ³•or do something
    };
    ```
* ä½è¿ç®—
    * `>>`:æœ‰ç¬¦å·å³ç§»ï¼Œæœ€é«˜ä½è¡¥0è¿˜æ˜¯1æŒ‰ç…§è¡¥ç çš„æœ€é«˜ä½
    * `>>>`:æ— ç¬¦å·å³ç§»ï¼Œæœ€é«˜ä½æ°¸è¿œè¡¥0
* JavaæŸ¥çœ‹intåº•å±‚çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼š`Integer.toBinaryString(c)`
* å°æ•°æŸ¥çœ‹åº•å±‚çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼š`Float.floatToIntBits(12.1f);`/`Double.doubleToLongBits(12.3)`
## é¢å‘å¯¹è±¡
* ä¸‰å¤§ç‰¹æ€§çš„å†…å®¹ï¼Ÿ
* Object
    * `equals`ä¸`==`ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ:`==`å¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ¯”è¾ƒçš„æ˜¯å€¼ï¼Œå¦‚æœæ˜¯å¯¹è±¡ï¼Œæ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€ï¼›`equals`æ˜¯è¶…ç±»Objecté‡Œé¢çš„æ–¹æ³•ï¼Œåªæœ‰ç±»æ‰èƒ½è°ƒç”¨ï¼Œæ¯”è¾ƒçš„æ˜¯å†…å­˜åœ°å€ï¼ˆåŸå§‹çš„æ„æ€å°±æ˜¯æ¯”è¾ƒåœ°å€ï¼Œä½†å¦‚æœé‡å†™å°±ä¸ä¸€å®šäº†ï¼‰ï¼›
    * ä¸ºä»€ä¹ˆObjectä¸­çš„`equals`æ¯”è¾ƒçš„æ˜¯åœ°å€ï¼Ÿã€è¯·çœ‹æºç ã€‘
    * é‚£ä¸ºä»€ä¹ˆ`String.equals`æ¯”è¾ƒçš„æ˜¯å†…å®¹ï¼Ÿ
* å°è£…
    * ä¸ºä»€ä¹ˆè¦æœ‰privateå’Œsetæ–¹æ³•ï¼Ÿã€p221ã€‘ï¼›å› ä¸ºprivateï¼Œä»è€Œæœ‰äº†getæ–¹æ³•æ€ä¹ˆç†è§£ï¼Ÿ
    * å°è£…æ€§çš„ä½“ç°ï¼š1.å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›getã€setæ–¹æ³•(æŠŠç±»çœ‹åšæˆä¸€ä¸ªç›’å­ï¼Œæˆ‘ä¸å…è®¸ä½ ç›´æ¥æ“ä½œæˆ‘é‡Œé¢çš„å…ƒç´ ï¼Œè€Œæ˜¯è¦é€šè¿‡æˆ‘æä¾›çš„å£å­æ¥æ“ä½œ)ã€‚2.æ–¹æ³•ç§æœ‰åŒ–...ã€p222ã€‘
    * *å¯¹å°è£…æ€§çš„ç†è§£ï¼ˆé¢è¯•ï¼‰*:ä»ä½¿ç”¨çš„å±‚é¢ç†è§£ï¼šæ­£æ˜¯å› ä¸ºæœ‰å°è£…æ€§ï¼Œæˆ‘ä»¬æ‰å¯ä»¥ç›´æ¥è°ƒç”¨æŸä¸ªæ–¹æ³•æ¥åšåŠŸèƒ½ï¼Œè€Œä¸éœ€è¦å…³æ³¨å…·ä½“çš„æ–¹æ³•å®ç°ï¼›ä»æ“ä½œçš„å±‚é¢ä¸Šè¯´ï¼šæœ‰äº†å°è£…æ€§ï¼Œæ‰èƒ½é™åˆ¶ä½¿ç”¨è€…å¯¹å½“å‰ç±»ä¸­çš„å…ƒç´ çš„ä¿®æ”¹ï¼Œä½ çš„æ“ä½œéœ€è¦æ»¡è¶³ä¸€å®šçš„æ¡ä»¶æ‰ä¼šç”Ÿæ•ˆ
    * å››ç§æƒé™ä¿®é¥°ç¬¦æ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬çš„åŒºåˆ«ï¼Ÿã€p223ã€‘
    * thiså…³é”®å­—
        ```java
        //ä½¿ç”¨åœºæ™¯ä¸€ï¼šè¿™æ—¶çš„thisæ˜¯ç»™ç¼–è¯‘å™¨javacçœ‹çš„
        public Point(int x, int y) {
            this.x = x;
            this.y = y;
        }
        //ä½¿ç”¨åœºæ™¯äºŒï¼ˆæ­»è®°ï¼‰ï¼šå¦‚æœæƒ³åœ¨æ„é€ å™¨ä¸­è°ƒç”¨é‡è½½çš„å¦ä¸€ä¸ªæ„é€ å™¨ï¼Œéœ€è¦ä½¿ç”¨this
        public Rectangle() {
            this(0, 0, 1, 1); //è¿™é‡Œå¦‚æœå†™Rectangle(0,0,1,1)æŠ¥é”™
        }
        public Rectangle(int width, int height) {
            this(0, 0, width, height);
        }
        ```
        * ä¸ºä»€ä¹ˆè¦ç”¨thisï¼Ÿ[link](https://blog.csdn.net/benxiangsj/article/details/124282800)
        * thisæ€ä¹ˆç†è§£? thiså…³é”®å­—ä¸€å®šæ˜¯åœ¨ä¸€ä¸ªç±»ä¸­ä½¿ç”¨ï¼Œå¯ä»¥ç†è§£ä¸ºâ€œå½“å‰æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡â€ã€‚æ‰€ä»¥`this.val = val`è¡¨ç¤ºæŠŠvalèµ‹å€¼ç»™å½“å‰æ­£åœ¨åˆ›å»ºå¯¹è±¡çš„å±æ€§val
        * `this();`ä»€ä¹ˆæ„æ€ï¼Ÿã€p234ã€‘
* æ¥å£
```java
//1ã€æ¥å£å…è®¸**å¤šç»§æ‰¿ï¼**
public interface MyInterface extends interfaceParent1,interfaceParent2 {
    //2ã€æ¥å£ä¸­å¯ä»¥æœ‰å˜é‡ï¼Œä¿®é¥°ç¬¦å†™ä¸å†™éƒ½è¡Œï¼Œé»˜è®¤ä¸”åªèƒ½æ˜¯public static final
    //é€šè¿‡MyInterface.aæ¥è°ƒç”¨
    int a = 0;
    //3ã€æ¥å£ä¸­çš„æ–¹æ³•åŠ ä¸åŠ ä¿®é¥°ç¬¦éƒ½è¡Œï¼Œé»˜è®¤ä¸”åªèƒ½æ˜¯public abstract
    Integer method1();
}
```
* ç»§æ‰¿
    * ç»§æ‰¿ä¸æ¥å£çš„å…³ç³»ï¼š`ç»§æ‰¿åªèƒ½æ˜¯ä¸€ä¸ª,è€Œæ¥å£çš„å®ç°å¯ä»¥æ˜¯å¤šä¸ª.ç»§æ‰¿çš„åŸæ„æ˜¯å¸Œæœ›å¾—åˆ°çˆ¶ç±»çš„ç‰¹æ€§.è€Œå®ç°æ¥å£æ˜¯å¯¹è‡ªèº«ä¸€ä¸ªæ’å…¥å¼çš„æ‰©å±•` [link](https://www.zhihu.com/question/49674278/answer/133404995)
    > æ¥å£çš„å¥½å¤„ï¼š
    1ã€ä¸»æœºä¸CPUä¹‹é—´çš„å…³ç³»ï¼šåªè¦ä¸»æœºç•™å¥½æ¥å£ï¼ŒCPUéµå®ˆæ¥å£ï¼Œé‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿå°±èƒ½å·¥ä½œã€‚
    ä¸éœ€è¦äº†è§£CPUçš„å¤æ‚ç»“æ„
    2ã€å£°æ˜å¥½æ¥å£ï¼Œä¸Šä¸€å±‚å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼–å†™ï¼Œç¼–è¯‘ä¸ä¼šæŠ¥é”™ã€‚ä¸ç®¡æœ‰æ²¡æœ‰å®ç°ç±»
    * ä¸ºä»€ä¹ˆä¸€ä¸ªå­ç±»å¯ä»¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§ï¼Ÿã€p278ã€‘ï¼ˆé€šè¿‡æ„é€ å™¨å°†æ‰€æœ‰çˆ¶ç±»åŠ è½½åˆ°æ–¹æ³•åŒºï¼Œå­ç±»çš„æ„é€ å™¨ä¸€å®šè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼‰
    * å…³äºç»§æ‰¿ï¼š
    <img src="./ç±»ç»§æ‰¿å†…å­˜å…³ç³»å›¾.png" width="300px" />
        * ç»§æ‰¿ï¼Œä¼šç»§æ‰¿çˆ¶ç±»çš„æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼ŒåŒ…æ‹¬privateç±»å‹
        * å†…å­˜ï¼šå±æ€§å†²çªï¼Œä¸¤ä¸ªéƒ½å­˜åœ¨
        * superå…³é”®å­—çš„ä½¿ç”¨ï¼šç”¨super.å±æ€§ï¼Œä¼šä»çˆ¶ç±»å¼€å§‹æ‰¾ï¼Œå¦‚æœçˆ¶ç±»æ²¡æœ‰è¯¥å±æ€§ï¼Œç»§ç»­å¾€ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°**ç¬¬ä¸€ä¸ª**å…·æœ‰è¯¥å±æ€§çš„ç±»ï¼Œå°±ä¸å†å¾€ä¸Šæ‰¾äº†
        > Q:å¦‚æœGrandFaæœ‰ä¸ªæ–¹æ³•methodï¼ŒFatheré‡å†™methodï¼ŒSonç›´æ¥è°ƒç”¨super.method,è°ƒç”¨çš„æ˜¯è°çš„methodï¼Ÿ Father
    * superå…³é”®å­—ï¼š
        * å°ç†è§£ï¼šæ— è®ºæ˜¯thisï¼Œè¿˜æ˜¯superï¼Œéƒ½æ˜¯åœ¨å‡ºç°é‡åçš„æƒ…å†µä¸‹ï¼Œç”¨æ¥æŒ‡æ˜çš„
        * 
    * é—®é¢˜çœ‹ä»£ç  | ç­”æ¡ˆï¼š1ã€å¦‚æœæ˜¾ç¤ºçš„å†™å‡ºæœ‰å‚æ„é€ å‡½æ•°ï¼Œé‚£å°±ä¸ä¼šé»˜è®¤æä¾›æ— å‚æ„é€ å™¨äº†ã€‚2ã€Childç±»ä¼šæä¾›é»˜è®¤çš„æ— å‚æ„é€ å‡½æ•°ï¼Œä½†æ ¹æ®**å­ç±»å¯¹è±¡å®ä¾‹åŒ–çš„å…¨è¿‡ç¨‹**,å­ç±»éœ€è¦è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ å™¨ï¼Œä½†Fatheræ²¡æœ‰æ— å‚æ„é€ å™¨ï¼Œåªå†™äº†ä¸ªæœ‰å‚æ„é€ å™¨ï¼Œè‡ªç„¶æŠ¥é”™
    > å­ç±»å¯¹è±¡å®ä¾‹åŒ–çš„å…¨è¿‡ç¨‹ï¼š
    1ã€ä¸ºä»€ä¹ˆå­ç±»èƒ½å¤Ÿæ‹¥æœ‰çˆ¶ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Ÿ é‚£æ˜¯å› ä¸ºåœ¨åˆ›å»ºå­ç±»å¯¹è±¡çš„æ—¶å€™ä¼šè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼Œå°†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•åŠ è½½åˆ°å †ä¸­ï¼Œä¸€ç›´å‘ä¸Šé€’å½’ï¼Œç›´åˆ°Objectç±»
    2ã€å­ç±»å¯¹è±¡åœ¨å †ä¸­çš„çŠ¶æ€ï¼šæ—¢ç„¶è°ƒç”¨äº†æ‰€æœ‰çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œé‚£åˆå§‹åŒ–å¯¹è±¡æ—¶ï¼Œåœ¨å †ä¸­æ˜¯å­˜åœ¨å¥½å¤šä¸ªæ–¹æ¡†è¿˜æ˜¯ä¸€ä¸ªæ–¹æ¡†ï¼ˆæ¯ä¸ªæ–¹æ¡†ä»£è¡¨ä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Ÿåªæœ‰ä¸€ä¸ªæ–¹æ¡†ï¼Œè™½ç„¶è°ƒç”¨æ‰€æœ‰çˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œä½†å †ä¸­åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬è‡ªå·±newçš„
    ```java
    public class Father {

    private String name = "å¼ ä¸‰";//ç§æœ‰å±æ€§
    private String sex = "ç”·";

    public Father(String name, String sex) {
        this.name = name;
        this.sex = sex;
        }
    }
    public class Child extends Father { //æŠ¥é”™ï¼Œä¸ºä»€ä¹ˆï¼Ÿ
    }
    ```
* å¤šæ€
    * ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿçˆ¶ç±»çš„å¼•ç”¨æŒ‡å‘å­ç±»çš„å¯¹è±¡ï¼Œèƒ½ä¸èƒ½è°ƒçœ‹çˆ¶ç±»ï¼Œæ€ä¹ˆè°ƒï¼Œçœ‹å­ç±»
    * ä¸ºä»€ä¹ˆè¦æœ‰å¤šæ€ï¼Ÿæé«˜æ–¹æ³•çš„é€šç”¨æ€§ã€å‡å°‘æ–¹æ³•çš„é‡è½½ã€p281ã€‘| é€šè¿‡å¤šæ€ï¼Œå°†è§„èŒƒå’Œå®ç°ç›´æ¥åˆ†å¼€ `void doData(Connection conn)`
    * å¤šæ€çš„å±æ€§å€¼å–å†³äºçˆ¶ç±»è¿˜æ˜¯å­ç±»ï¼Ÿ çˆ¶ç±»ã€p282ã€‘
    * ä»€ä¹ˆæ˜¯è™šæ‹Ÿæ–¹æ³•ï¼Ÿ
    * çˆ¶å­ç±»å¯¹è±¡ä¹‹é—´çš„ç±»å‹è½¬æ¢
    å¼ºè½¬æ˜¯å’Œå¤šæ€æ­é…ä½¿ç”¨çš„ï¼›
    å¤šæ€æ˜¯æˆ‘newäº†ä¸€ä¸ªStudentï¼ŒæŠŠå®ƒèµ‹ç»™Personï¼›
    ç„¶åPersonå¯ä»¥å¼ºè½¬ä¸ºStudent
    ```java
    Person p = new Student();//å¤šæ€
    p1 = (Student) p//å¼ºè½¬

    //==========================================
    Person p = new Person();
    s1 = (Student)p //æŠ¥é”™
    ```
* å…³é”®å­—

    * native:è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•å…·ä½“å®ç°è°ƒç”¨çš„æ˜¯åº•å±‚çš„Cæˆ–C++ï¼Œä¸å†ç”¨Javaäº†ã€‚
    * superï¼š`superæ˜¯ä¸ºäº†å…¼å®¹ä»£ç è€Œè®¾è®¡çš„ï¼Ÿ`
    * final
        * ä¿®é¥°å¯¹è±¡
            * ç±»ï¼šè¡¨ç¤ºè¿™ä¸ªç±»ä¸èƒ½è¢«ç»§æ‰¿äº†ï¼ŒåƒStringã€Systemã€‚ï¼ˆä¸ºä»€ä¹ˆè¦æŠŠStringç±»å£°æ˜ä¸ºfinalï¼Ÿå› ä¸ºè¿™ä¸ªç±»çš„åŠŸèƒ½å·²ç»å¾ˆå®Œæ•´äº†ï¼Œä¸éœ€è¦åœ¨ç»§æ‰¿æ¥æ‰©å……åŠŸèƒ½äº†
            * æ–¹æ³•ï¼šè¿™ä¸ªæ–¹æ³•ä¸èƒ½è¢«é‡å†™
            * å±æ€§ï¼šè¡¨æ˜å¯¹è±¡å‡ºç”Ÿæ—¶ï¼Œå®ƒçš„å±æ€§å·²ç»æ˜¯finalçš„äº†/ç¡®å®šä¸‹æ¥äº†ï¼ˆä¸èƒ½ä¿®æ”¹ï¼‰ï¼ˆåœ¨å“ªèµ‹ï¼Ÿ1.ç›´æ¥å†™2.ä»£ç å—3.æ„é€ å™¨|ä¸ºä»€ä¹ˆå¯ä»¥ç”¨1ã€2ã€3æ¥èµ‹å€¼ï¼Œä¸èƒ½åœ¨è‡ªå·±å†™çš„setæ–¹æ³•é‡Œèµ‹å€¼ï¼Ÿï¼‰
        * finalä¸staticçš„åŒºåˆ«
    * abstract
        * æŠ½è±¡ç±»ï¼šè¡¨ç¤ºè¿™ä¸ªç±»ä¸èƒ½è¢«å®ä¾‹åŒ–
        > æŠ½è±¡ç±»ä¸æ¥å£ä¹‹é—´çš„åŒºåˆ«ï¼Ÿ
        æŠ½è±¡ç±»å¯ä»¥æœ‰è‡ªå·±çš„æˆå‘˜å˜é‡ï¼Œæ¥å£åªèƒ½æœ‰æ–¹æ³•ã€‚æ‰€ä»¥ç»§æ‰¿æŠ½è±¡ç±»å¯ä»¥æ¯”å®ç°æ¥å£å¤ç”¨æ›´å¤šçš„ä»£ç 
        * æŠ½è±¡æ–¹æ³•ï¼šæ²¡æœ‰æ–¹æ³•ä½“ï¼›å­ç±»å¯ä»¥é€‰æ‹©å®ç°æŠ½è±¡æ–¹æ³• æˆ–è€… æˆä¸ºæŠ½è±¡ç±»
    * static ï¼ˆæ¥æºï¼šåœ¨å°šç¡…è°·JavaWebp259 12min20sä¸­ï¼Œä¸ºä»€ä¹ˆfindCookieæ–¹æ³•è¦ç”¨public staticï¼šï¼‰ã€å½“å‰ï¼šåŸºç¡€p317ã€‘
        * ä¸ºä»€ä¹ˆè¦ä½¿ç”¨staticï¼Ÿ
        æ€ä¹ˆé€šè¿‡å¤šçº¿ç¨‹å®ç°å–ç¥¨ï¼Ÿå‡è®¾ç¥¨æ•°å…±`tickets=100`å¼ ï¼Œå¦‚æœ`tickets`ä¸ç”¨staticä¿®é¥°ï¼Œä¼šå‘ç°æ¯ä¸ªçº¿ç¨‹å„å–100å¼ ï¼Œä¸å®é™…ä¸ç¬¦
        * staticçš„ä½¿ç”¨
            * staticä¿®é¥°å±æ€§ï¼šå½“æˆ‘ä»¬newå¤šä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œæ¯ä¸ªå¯¹è±¡é‡Œéƒ½æœ‰ä¸€ä»½éé™æ€å±æ€§ï¼ˆç§°ä¸ºå®ä¾‹å˜é‡ï¼‰ï¼›ä½†è¿™äº›å¯¹è±¡å…±äº«ä¸€ä»½é™æ€å±æ€§ï¼ˆstaticä¿®é¥°çš„ï¼‰
            > staticå˜é‡åœ¨æ–¹æ³•åŒºä¸­çš„é™æ€åŸŸé‡Œ
            æ‰€ä»¥å½“newä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå®ƒçš„æ™®é€šæˆå‘˜å˜é‡åœ¨å †ä¸­ï¼Œè€Œstaticå˜é‡åœ¨æ–¹æ³•åŒºä¸­
            * staticä¿®é¥°æ–¹æ³•ï¼šéšç€ç±»çš„åŠ è½½è€ŒåŠ è½½ï¼Œå¯ä»¥é€šè¿‡ç±».æ–¹æ³•æ¥è°ƒç”¨
        * staticåœ¨å†…å­˜é‡Œçš„çŠ¶æ€ï¼šstaticä¿®é¥°çš„æ–¹æ³•ã€å˜é‡åœ¨å†…å­˜ä¸­å°±åªæœ‰ä¸€ä¸ªï¼Œä¸åƒå¯¹è±¡æ¯æ¬¡newä¸€ä¸ªå°±ä¼šåœ¨å†…å­˜é‡Œæœ‰ä¸€ä¸ªå¯¹è±¡ï¼›ä¼šéšç€ç±»çš„åŠ è½½è€ŒåŠ è½½
        > classæ–‡ä»¶è¢«åŠ è½½åˆ°æ–¹æ³•åŒºåï¼Œä¹‹äºå˜é‡ï¼šåªæœ‰é™æ€æˆå‘˜å˜é‡è¢«åˆ†é…å†…å­˜ï¼Œå…¶ä»–çš„å˜é‡è¿˜éƒ½æ˜¯æ­»çš„ã€‚ä¹‹äºæ–¹æ³•ï¼šåªæœ‰é™æ€æ–¹æ³•è¢«åˆ†é…å†…å­˜æˆä¸ºä¸€ä¸ªæ ˆå¸§ï¼Œå…¶ä»–çš„æ–¹æ³•è¿˜éƒ½æ˜¯æ­»çš„ï¼›
        å½“newå‡ºæ¥ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šåœ¨å †ä¸­ä¸ºéé™æ€æˆå‘˜å˜é‡åˆ†é…å†…å­˜ï¼Œå¹¶åˆå§‹åŒ–ï¼›
        å½“å¯¹è±¡è°ƒç”¨æŸä¸ªéé™æ€æ–¹æ³•çš„æ—¶å€™ï¼Œjvmçš„æ‰§è¡Œå¼•æ“æ‰ä¼šæŠŠè¯¥æ–¹æ³•å°è£…ä¸ºæ ˆå¸§
        ä»¥ä¸Šï¼Œå›ç­”ä¸‹åˆ—é—®é¢˜ï¼š
        ä¸ºä»€ä¹ˆé™æ€æ–¹æ³•ä¸èƒ½è°ƒç”¨éé™æ€å˜é‡ï¼šéé™æ€å˜é‡åœ¨å†…å­˜ä¸­è¿˜ä¸å­˜åœ¨
        * æ€ä¹ˆç†è§£é™æ€æ–¹æ³•ä¸èƒ½è°ƒç”¨éé™æ€æ–¹æ³•ï¼šä»ç±»çš„åŠ è½½è¿‡ç¨‹åˆ†æ
    * package
        * ä¸ºä»€ä¹ˆè¦æœ‰åŒ…è¿™ä¸ªæ¦‚å¿µï¼špackageåº”è¯¥å’Œimportç»“åˆç€çœ‹ã€‚æˆ‘è§‰å¾—å°±æ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œæ–¹ä¾¿ä½¿ç”¨
* è‡ªåŠ¨è£…ç®±&è‡ªåŠ¨æ‹†ç®±
ä»€ä¹ˆæ˜¯è‡ªåŠ¨è£…ç®±ï¼Ÿ
è‡ªåŠ¨è£…ç®±æ˜¯æŒ‡å¯ä»¥æŠŠä¸€ä¸ªintç›´æ¥èµ‹å€¼ç»™Integerã€‚åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­å®é™…ä¸Šä¼šè°ƒç”¨Integer.valueOfæ–¹æ³•
è‡ªåŠ¨æ‹†ç®±æ˜¯æŒ‡å¯ä»¥æŠŠä¸€ä¸ªIntegerç›´æ¥èµ‹å€¼ç»™intã€‚åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­å®é™…ä¸Šä¼šè°ƒç”¨Integer.intValueæ–¹æ³•
```java
//int->Integer
Object tese(){
    int i = 0;
    return i;
}
```
* åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„åŒ…è£…ç±»æ€ä¹ˆæ”¹å˜é‡Œé¢çš„valueå€¼ï¼Ÿ
> Furthermore, Integer is immutable, meaning you can't change its value. 
* å†…éƒ¨ç±»
    * é™æ€å†…éƒ¨ç±»
    * æˆå‘˜å†…éƒ¨ç±»
    * æ–¹æ³•å†…éƒ¨ç±»
    * åŒ¿åå†…éƒ¨ç±»
    ```java
    new çˆ¶ç±»(å‚æ•°åˆ—è¡¨){
        //åŒ¿åå†…éƒ¨ç±»çš„å®ç°
    }
    new çˆ¶æ¥å£(å‚æ•°åˆ—è¡¨){
        //åŒ¿åå†…éƒ¨ç±»çš„å®ç°
    }
    Comparator<String> con = new Comparator<String>() {
        @Override
        public int compare(String o1, String o2) {
            return 0;
        }
    };
    ```
    ä½œä¸ºç±»ä¸­çš„å±æ€§
    ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å†…éƒ¨ç±»ï¼Ÿ
    ä¸€ä¸ªç±»åªè¢«å½“å‰ç±»ä½¿ç”¨ï¼Œè€Œä¸è¢«å…¶ä»–ç±»ä½¿ç”¨
    æˆå‘˜å†…éƒ¨ç±»çš„ä¾‹å­ï¼šçœ‹jdkæºç ä¸­LinkedListä¸­çš„Node
    * å±€éƒ¨å†…éƒ¨ç±»
    åœ¨æ–¹æ³•ã€ä»£ç å—ã€æ„é€ å™¨ä¸­
## å¼‚å¸¸å¤„ç†
* ä¸ºä»€ä¹ˆè¦æœ‰å¼‚å¸¸å¤„ç†ï¼Ÿ
å¯èƒ½ç”¨æˆ·å¿˜è®°äº†è¾“å…¥å­—ç¬¦ä¸²ï¼Œè€Œåå°åˆä¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œä¸€äº›æ“ä½œã€‚ç»“æœæ˜¯å½“ç”¨æˆ·ä¸€ç‚¹å‡»ç™»å½•æŒ‰é’®ï¼Œå‡ºç°nullexceptionä»¥åŠä¸€è¿ä¸²ä»£ç ï¼Œè¿™å¯¹ç”¨æˆ·æ¥è¯´ä½“éªŒæ„Ÿæå·®ã€‚å¦‚æœç”¨ä¸‹é¢çš„ä»£ç æ¥å¤„ç†å¼‚å¸¸,å½“ç”¨æˆ·ä¸å°å¿ƒè¯¯æ“ä½œå¼•å‘å¼‚å¸¸æ—¶ï¼Œå¯ä»¥æœ‰ä¸€ä¸ªå¾ˆå‹å¥½çš„æç¤ºä¿¡æ¯
```java
    try {
        str.length();
    } catch (Exception e) {
        System.out.println("xxxxï¼Œè¯·é‡è¯•");
    }
```
> RuntimeExceptionå¯ä»¥ä¸å¤„ç†
* å¸¸è§çš„å¼‚å¸¸ä»¥åŠå¤ç°ï¼Ÿã€p373ã€‘
* å¦‚æœä¸å¤„ç†å¼‚å¸¸ï¼Œæ¥ä¸‹æ¥çš„ä»£ç è¿˜ä¼šèµ°å—ï¼Ÿå¦‚æœå¤„ç†åï¼Œæ¥ä¸‹æ¥çš„ä»£ç è¿˜ä¼šèµ°å—ï¼Ÿ
* å¤„ç†å¼‚å¸¸çš„ä¸¤ç§æ–¹å¼ï¼štry-catch & throws
    * try-catch
        * åœ¨try-catchä¸­ï¼Œå¦‚æœåœ¨tryä¸­æŸä¸€æ¡è¯­å¥å‡ºç°å¼‚å¸¸ï¼Œé‚£tryä¸­è¯¥æ¡è¯­å¥çš„ä¸‹é¢è¯­å¥è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿä¸ä¼š
        * å¦‚æœcatchä¸­å¤šæœ‰ä¸ªcatché¡¹åŒ¹é…è¯¥å¼‚å¸¸ï¼Œè¿›å…¥å“ªä¸ªcatchï¼Ÿè¿˜ä¼šè¿›å…¥å…¶ä»–çš„catchè¯­å¥å—ï¼Ÿ é€ä¸ªåŒ¹é…ï¼Œä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œå°±è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œå¤„ç†å®Œæˆåç›´æ¥è·³å‡ºtry-catch
        ```java
        String str = null;
        try {
            str.length();
        } catch (NullPointerException e){
            System.out.println("nullpointerexc");
        } catch (Exception e) {
            System.out.println("exc");
        }
        //è¾“å‡ºï¼šnullpointerexc
        ```
        * å¦‚ä¸‹é¢ä»£ç :å¦‚æœç¬¬ä¸€ä¸ªfw.closeå‘ç”Ÿå¼‚å¸¸ï¼Œè¿˜ä¼šæ‰§è¡Œç¬¬äºŒä¸ªtry-catchå—ï¼Ÿå½“ç„¶ï¼Œtry-catchå°±æ˜¯å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œå°±æ²¡äº‹äº†ï¼Œç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç 
        ```java
        finally{
            try {
                if(fw != null)
                    fw.close();
            } catch (IOException e) {
                e.printStackTrace();
            }

            try {
                if(fr != null)
                    fr.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        ```
    * throws
        * è¯¥æ–¹æ³•å¯èƒ½å‡ºç°å¼‚å¸¸ï¼Œé€šè¿‡throwså°†å¼‚å¸¸æ‰”ç»™è°ƒç”¨è€…ï¼Œç”±è°ƒç”¨è€…è¿›è¡Œå¼‚å¸¸å¤„ç†
        ```java
        public static void main(String[] args){
            try {
                method2();
            } catch (IOException e) {
                e.printStackTrace();
            }
	    }
        public static void method2() throws IOException{
            //do something
	    }
        ```
        * å¦‚æœmethod()é€šè¿‡throwså¤„ç†å¼‚å¸¸ï¼Œé‚£å½“å¼‚å¸¸å‡ºç°çš„æ—¶å€™ï¼Œmethod()æ–¹æ³•ä¸­çš„ä¸‹é¢çš„ä»£ç è¿˜ä¼šæ‰§è¡Œå—ï¼Ÿ ä¸ä¼š
        * å…³äºå­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸è¦å°äºçˆ¶ç±»æŠ›å‡ºçš„å¼‚å¸¸
        ```java
        class SuperClass{
            public void method() throws IOException {

            }
        }
        class SubClass extends SuperClass{
            @Override
            public void method() throws Exception {//ç¼–è¯‘æŠ¥é”™
                super.method();
            }
        }
        ```
        > ä¸ºä»€ä¹ˆï¼Ÿç”±äºå¤šæ€
    * throwï¼šè‡ªå·±åˆ›å»ºå¼‚å¸¸
    * catchä¸­å¸¸ç”¨çš„æ–¹æ³•ï¼Ÿã€p375ã€‘
    * finallyï¼šå¦‚æœæœ‰è¿”å›å€¼ï¼Œé‚£è¿™ä¸ªtry-catchçš„æ‰§è¡Œæµç¨‹ï¼Ÿ
> try-catchä¸throwsä¸¤ç§å¤„ç†å¼‚å¸¸çš„åŒºåˆ«ï¼Ÿ
throwså¤„ç†å¼‚å¸¸ï¼šä¸€ä¸ªæ–¹æ³•é€è¡Œæ‰§è¡Œï¼Œå½“æŸä¸€è¡Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œå°±ä¼šåœ¨å †ä¸­åˆ›å»ºä¸€ä¸ªexceptionå¯¹è±¡ï¼Œå¹¶ä¸”ç›´æ¥ç»“æŸï¼ˆæ–¹æ³•ä¸­å‰©ä½™çš„è¡Œä¸æ‰§è¡Œäº†ï¼‰
å¦‚æœä»£ç ä¸­æ¶‰åŠåˆ°æµæ“ä½œï¼Œtry-catchè¦æ¯”throwså¥½ã€‚åŸå› æ˜¯æœ€åä¸€æ­¥é€šå¸¸è¦æŠŠæµå…³æ‰ï¼Œå¦‚æœthrowsäº†ï¼Œåœ¨å‡ºç°å¼‚å¸¸æ—¶å°±ç›´æ¥é€€å‡ºäº†ï¼Œæ²¡æœ‰å…³é—­æµï¼Œå¯¼è‡´å†…å­˜æ³„æ¼

* æ³¨ï¼šæ¶‰åŠåˆ°æµæ—¶çš„å¼‚å¸¸å¤„ç†
åªéœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š1ã€è¦ç”¨try-catchï¼Œä¸èƒ½ç”¨throws 2ã€finallyä¸­è¦åˆ¤æ–­æ˜¯å¦ä¸ºç©º
```java
    FileReader reader = null;
    try {
        reader = new FileReader("a.txt");
        int data = reader.read();
        System.out.println(data);
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            if (reader != null) //importantï¼
            //å¯èƒ½ä¸Šé¢åˆ›å»ºæµçš„æ—¶å€™æŠ¥å¼‚å¸¸äº†ï¼Œæµæ²¡åˆ›å»ºå‡ºæ¥ï¼Œä½†æ— è®ºæ€ä¹ˆæ ·éƒ½è¦æ‰§è¡Œfinallyæ“ä½œï¼Œæ‰€ä»¥è¦åˆ¤ç©º
            reader.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
```

* `try-finally`
    * ä¸ºä»€ä¹ˆè¦ä½¿ç”¨`try-finally`?
    çœ‹ä¸‹é¢çš„ä»£ç :å‘ç°è¿™ä¸ª`lock.unlock()`æœ‰ç‚¹é—®é¢˜ï¼Œå¦‚æœå½“ticketså‡ä¸º0ï¼Œé‚£å°±ç›´æ¥breakäº†ï¼Œå³ç›´æ¥è·³å‡ºwhileå¾ªç¯ï¼Œè¿™ä¸ªğŸ”’æ°¸è¿œä¹Ÿé‡Šæ”¾ä¸æ‰ï¼›
    è¿™æ—¶å°±è¦æŠŠè¿™ä¸ª`lock.unlock()`æ”¾è¿›finallyé‡Œé¢ï¼Œ**è¿™æ ·å³ä½¿breakäº†ï¼Œä¹Ÿä¼šå…ˆæ‰§è¡Œfinallyé‡Œçš„ä»£ç åï¼Œåœ¨è·³å‡ºwhileå¾ªç¯**ã€‚
    ```java
    public void run() {
        while(true){
            lock.lock();
            if (tickets > 0) {
                System.out.println(Thread.currentThread().getName() + ":" + tickets);
                tickets--;
            } else break;
            lock.unlock();
        }
    }
    ```

## æ³¨è§£
* å…ƒæ³¨è§£ï¼šä¿®é¥°æ³¨è§£çš„æ³¨è§£
1ã€Targetï¼šè¡¨ç¤ºè¯¥æ³¨è§£å¯ä»¥æ”¾åœ¨å“ª
2ã€Rententionï¼šè¯¥æ³¨è§£ä½•æ—¶ç”Ÿæ•ˆ
3ã€
4ã€
* æ³¨è§£çš„ç”¨æ³•ï¼Ÿ æ³¨è§£å¹¶ä¸ä¸ŠåŠ ä¸Šæ³¨è§£å°±ä¼šæœ‰ä»€ä¹ˆä½œç”¨ï¼Œå£°æ˜æ³¨è§£æ˜¯ç»™åå°„ç”¨çš„
* æ³¨è§£çš„å†™æ³•
```java
public @interface Target {
    ElementType[] value(); //æ³¨è§£çš„å±æ€§ï¼Œå¯ä»¥ç»™valueå±æ€§èµ‹å€¼ï¼Œå› ä¸ºå‰é¢å£°æ˜çš„æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥å¯ä»¥èµ‹å€¼å¤šä¸ª
    //è°ƒç”¨æ—¶ï¼š@Target(value={ElementType.TYPE,ElementType.FIELD})
    String value1();//å¯ä»¥ç»™value1å±æ€§èµ‹å€¼ï¼Œå› ä¸ºå‰é¢å£°æ˜çš„æ˜¯å•ä¸ªå˜é‡ï¼Œæ‰€ä»¥å¯ä»¥èµ‹å€¼å¤šä¸ª
    //è°ƒç”¨æ—¶ï¼š@Target(value1="Hello")
}
//å¦‚æœå†™å¾—æ—¶å€™ä»€ä¹ˆéƒ½ä¸åŠ ï¼Œé»˜è®¤ç»™valueå±æ€§èµ‹å€¼
@Target(ElementType.TYPE) //é»˜è®¤ç»™valueå±æ€§èµ‹å€¼
public class annotationTest{

}
```
--------

* ç»§æ‰¿
    * ç±»ä¸ç±»ä¹‹é—´çš„ç»§æ‰¿
        * å­ç±»å¯ä»¥å¯¹çˆ¶ç±»ä¸­çš„æ–¹æ³•è¿›è¡Œ**é‡å†™**æˆ–è€…åŠŸèƒ½**æ‰©å……**ï¼Œæ€ä¹ˆç†è§£ï¼Ÿ

    * åå°„
        * çœ‹çœ‹`Test.class`æ–‡ä»¶é‡Œæœ‰ä»€ä¹ˆä¸œè¥¿ï¼š`javap -v Test`(.classæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé€šè¿‡javapåæ±‡ç¼–)
        * åå°„ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯æ“ä½œclassç±»ï¼Œè¿™ä¸ªç±»æ˜¯classæ–‡ä»¶çš„å¯¹è±¡åŒ–ï¼Œé‚£åå°„ä¸ºä»€ä¹ˆå«åå°„ï¼Ÿ
        * ä»€ä¹ˆæ—¶å€™ç”¨åå°„ï¼šéœ€è¦æ ¹æ®å­—ç¬¦ä¸²æ¥è°ƒç”¨å¯¹åº”çš„ç±»æˆ–è€…æ–¹æ³•æ—¶ï¼ˆå­—ç¬¦ä¸²æ˜¯å¯ä»¥å˜å¾—ï¼‰
        * æˆ‘åœ¨BaseServletä¸­doGetä¸­å†™åå°„ä»£ç ï¼Œç„¶åæˆ‘ç”¨å¦ä¸€ä¸ªServletç»§æ‰¿BaseServletï¼Œä¸ºä»€ä¹ˆæˆ‘è¿™ä¸ªServletä¸­ä¸éœ€è¦å†™dogetæ–¹æ³•ï¼Œç›´æ¥å†™loginæ–¹æ³•ï¼Œå°±å¯ä»¥æ­£å¸¸è¿è¡Œï¼Ÿå› ä¸ºç»§æ‰¿ å°šç¡…è°·p259åœ¨CookieServletä¸­æ²¡æœ‰dogetæ–¹æ³•çš„ç–‘é—®
* æ³›å‹ç¨‹åºè®¾è®¡
    * ä¸ºä»€ä¹ˆ`Deque<Integer>`å°–æ‹¬å·é‡Œåªèƒ½æ˜¯Integerä¸èƒ½æ˜¯intï¼Ÿ Javaæ ¸å¿ƒå·1p320
## é›†åˆ 
* Collectionæ¥å£
    * å¾€Collectionä¸­å­˜è‡ªå®šä¹‰å¯¹è±¡çš„æ—¶å€™ï¼Œè‡ªå®šä¹‰ç±»è¦é‡å†™å“ªäº›æ–¹æ³•ï¼Ÿ
    equalsæ–¹æ³•
    å¯¹äºListè€Œè¨€ï¼Œå°½ç®¡addæ“ä½œä¸éœ€è¦å¯¹è±¡é‡å†™æ–¹æ³•ï¼Œä½†remove/containsæ“ä½œä¼šè°ƒç”¨equalsæ–¹æ³•ã€‚
    å¯¹äºsetè€Œè¨€ï¼Œåœ¨æ·»åŠ çš„æ—¶å€™å°±ä¼šç”¨åˆ°equalsæ–¹æ³•å’ŒhashCodeæ–¹æ³•
    * `Person[] res = Collection.toArray(new Person[0])`
    å°†é›†åˆè½¬åŒ–ä¸ºæ•°ç»„,æ‹¬å·é‡Œé¢éœ€è¦ä¸€ä¸ªæ•°ç»„çš„é¦–åœ°å€ï¼Œä¸ºäº†èŠ‚çœç©ºé—´ï¼Œå°±å†™æˆäº†`Person[0]`
    * List
        * Listçš„å¸¸ç”¨æ–¹æ³•
        å¢ã€åˆ ã€æ”¹ã€æŸ¥ã€æ’ã€é•¿åº¦ã€éå†
        addã€removeã€setã€getã€addã€sizeã€iterator
        * ArrayList
            * `RandomAccess`æ¥å£
            1ã€éœ€è¦èƒŒæ™¯
            `RandomAccess`æ˜¯ç»™ç®—æ³•çœ‹çš„ï¼Œå¦‚Collectionsä¸­çš„binarySearchï¼Œå¦‚æœæŸä¸ªListå®ç°ç±»RandomAccessæ¥å£ï¼Œé‚£ä¹ˆå°±ä¼šé€‰æ‹©æ›´é«˜æ•ˆçš„äºŒåˆ†å®ç°ï¼ˆç›´æ¥é€šè¿‡ä¸‹æ ‡è®¿é—®çš„indexBinarySearchï¼‰ã€‚å¦‚ArrayList
            å¦åˆ™åªèƒ½é€šè¿‡iteratorå»ä¸€ä¸ªä¸ªçš„ç§»åŠ¨ï¼ˆiteratorBinarySearchï¼‰ã€‚å¦‚LinkedList
            * æ‰©å®¹æœºåˆ¶
            åœ¨addç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ä¼šä¸Šæ¥newçš„Objectæ•°ç»„ä¸º10ï¼Œä¸æ–­å¾€é‡Œé¢åŠ å…ƒç´ ï¼Œå¦‚æœä¸å¤Ÿäº†å°±ä¼šæ‰©ä¸ºåŸæ¥çš„1.5å€ï¼ˆ`oldC = oldC + (oldC>>1)`ï¼‰
        * ArrayListä¸Vector
        ArrayListä½œä¸ºListçš„ä¸»è¦å®ç°ç±»ï¼›Vectorä½œä¸ºListçš„å¤è€å®ç°ç±»
        ArrayListä¸vectorä¹‹é—´çš„å…³ç³»åƒstringbufferå’Œstringbuilder
        å› ä¸ºarraylistæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ‰€ä»¥æ‰§è¡Œæ•ˆç‡æ¯”è¾ƒé«˜ï¼›
        è€Œvectoræ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ‰€ä»¥é€šå¸¸ä½¿ç”¨arraylistè€Œä¸ç”¨vector
        > ArrayListçš„è¡¥å……ï¼š
        jdk7ä½¿ç”¨ArrayListç©ºå‚æ„é€ å™¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ª16çš„æ•°ç»„
        jdk8ä½¿ç”¨ç©ºå‚æ„é€ å™¨ï¼Œä¸ä¼šåˆ›å»ºæ•°ç»„ï¼Œç›´åˆ°æ·»åŠ ç¬¬ä¸€ä¸ªæ•°æ®çš„æ—¶å€™æ‰ä¼šnewæ•°ç»„
        * ArrayListä¸LinkedList
        ArrayListåº•å±‚ä½¿ç”¨æ•°ç»„ï¼›é¢‘ç¹æŸ¥è¯¢ä½¿ç”¨ArrayList
        LinkedListåº•å±‚ä½¿ç”¨åŒå‘é“¾è¡¨ï¼›é¢‘ç¹åˆ é™¤ã€æ’å…¥ä½¿ç”¨LinkedList
        * iterator
        å¯¹ä¸¤ä¸ªæŒ‡é’ˆçš„å°è£…ä½“
        åœ¨ArrayListä¸­ï¼Œiteratoræ˜¯ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå¯¹å¤–æä¾›åŠŸèƒ½
    * set
    æ— åºæ€§&ä¸å¯é‡å¤æ€§ï¼›å¦‚ä½•ç†è§£æ— åºæ€§å’Œä¸å¯é‡å¤æ€§ï¼Ÿ
    æ— åºæ€§ï¼šæ— åºæ€§æ˜¯æŒ‡æ·»åŠ çš„å…ƒç´ çš„ä½ç½®åœ¨==é€»è¾‘ä¸Š==æ˜¯æ— åºçš„ã€‚
    æ¯”å¦‚Listæ¥å£ä¸­çš„å®ç°ç±»æ˜¯æœ‰åºçš„ï¼Œæ— è®ºæ˜¯ArrayListè¿˜æ˜¯LinkedListï¼Œåœ¨é€»è¾‘ä¸Šè‚¯å®šç¬¬äºŒä¸ªæ’å…¥çš„å…ƒç´ åœ¨ç¬¬ä¸€ä¸ªæ’å…¥çš„å…ƒç´ çš„åé¢ï¼›
    è€ŒHashSet/HashMapå´ä¸æ˜¯ï¼Œæ’å…¥å…ƒç´ çš„ä½ç½®ç”±hashCodeé…åˆä¸Šä¸€ä¸ªå‡½æ•°æ±‚å¾—ã€‚æ‰€ä»¥å¾ˆæœ‰å¯èƒ½åæ’å…¥çš„å…ƒç´ åœ¨å…ˆæ’å…¥å…ƒç´ çš„å‰é¢
    <img src="./setæ— åº.png" width=400px>
    ä½¿ç”¨Setè¦é‡å†™æ·»åŠ ç±»ä¸­equals()å’ŒhashCode()
        * HashSet
        * LinkedHashSet
        hashsetçš„å­ç±»ï¼›éå†æ—¶ä¼šæŒ‰ç…§å½“åˆæ·»åŠ çš„é¡ºåºéå†
        <img src="LinkedHashSet.png" width=300px>
        * TreeSet
        1ã€åº•å±‚ä½¿ç”¨çº¢é»‘æ ‘å®ç°ï¼Œå¯¹è±¡èƒ½å¤Ÿæ’åº
        2ã€ä½¿ç”¨TreeSetæ—¶ï¼Œé‡Œé¢åªèƒ½å­˜ç›¸åŒç±»çš„å¯¹è±¡
        3ã€æ³¨æ„ï¼šTreeSetåˆ¤æ–­å¯¹è±¡æƒ³ä¸æƒ³åŒä½¿ç”¨çš„æ—¶å€™CompareToæ–¹æ³•çš„è¿”å›å€¼ï¼šå¦‚æœè¿”å›å€¼ä¸º0å°±è®¤ä¸ºä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸åŒçš„ã€‚ä¸åƒHashSetå…ˆæ ¹æ®hashCodeå†æ ¹æ®equasl()
* Mapæ¥å£
<img src="./Map.png" width=400px>
HashMapä½œä¸ºMapçš„ä¸»è¦å®ç°ç±»ï¼›Hashtableä½œä¸ºMapçš„å¤è€å®ç°ç±»;
HashMapçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡é«˜ï¼›Hashtableçº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡ä½
HashMapå¯ä»¥å­˜nullçš„keyæˆ–è€…valueï¼›è€ŒHashtableä¸èƒ½
LinkedHashMapç»§æ‰¿HashMapï¼Œå¯ä»¥åœ¨éå†çš„æ—¶å€™æŒ‰ç…§æ·»åŠ çš„é¡ºåºå»éå†
TreeMapå¯ä»¥ä¿è¯æŒ‰ç…§keyè¿›è¡Œæ’åºï¼Œå®ç°æ’åºéå†
    * HashMap
        * HashMapçš„æ‰©å®¹æœºåˆ¶
        åœ¨putç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ä¼šnewä¸€ä¸ªé•¿åº¦ä¸º16çš„Nodeæ•°ç»„(table);
        å¦‚æœå¾€é‡Œé¢æ”¾çš„å…ƒç´ è¶…è¿‡äº†thresholdï¼Œå°±ä¼šå»æ‰©å®¹ï¼š
        æ–°æ•°ç»„çš„sizeæ˜¯åŸæ¥çš„2å€`newCap = oldCap << 1`;æ–°çš„thresholdæ˜¯åŸæ¥çš„2å€`newThr = oldThr << 1`
        å¾€æ–°çš„Nodeæ•°ç»„é‡Œé¢ç§»åŠ¨çš„ç­–ç•¥ï¼šä¼šè®¡ç®—åœ¨æ–°çš„Nodeæ•°ç»„é‡Œé¢çš„ä½ç½®ï¼›
        HashMapä¸­é“¾ï¼Œç®—ä¸Štableä¸­å…ƒç´ ï¼Œæœ€å¤šèƒ½æ”¾8ä¸ªï¼›å¼€å§‹æ”¾ç¬¬ä¹ä¸ªçš„æ—¶å€™
        * HashMapä¸­çš„factorçš„ä½œç”¨
        factorç”¨æ¥æŒ‡ç¤ºå½“mapä¸­çš„å…ƒç´ ä¸ªæ•°è¾¾åˆ°Nodeæ•°ç»„ç™¾åˆ†ä¹‹å¤šå°‘æ—¶ï¼Œå¯¹Nodeæ•°ç»„è¿›è¡Œæ‰©å®¹
        æœ‰ä¸¤ä¸ªç›®çš„:1ã€ä½¿å¾—åœ¨Mapä¸­çš„é“¾è¡¨æ¯”è¾ƒå°‘2ã€Nodeæ•°ç»„åˆ©ç”¨ç‡é«˜
        * HashMap putå…ƒç´ çš„è¿‡ç¨‹
        é€šè¿‡å¯¹hashè¿›è¡Œè¿ç®—(`i = (n-1)&hash`)ç®—å‡ºè¯¥å…ƒç´ åœ¨Nodeæ•°ç»„ä¸­çš„ä½ç½®i
        å¦‚æœè¯¥ä½ç½®ä¸ºnullï¼Œç›´æ¥æ’å…¥
        å¦åˆ™è¿›è¡Œæ¯”è¾ƒï¼š1ã€å¦‚æœhashå€¼ä¸€æ · å¹¶ä¸”ï¼ˆåœ°å€ä¸€æ ·||equalsè¿”å›trueï¼‰ï¼Œç›´æ¥ä¿®æ”¹ 2ã€å¦åˆ™ç´§æ¥ç€ä¸é“¾è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªæ¯”è¾ƒ
        * HashMapä¸­çš„Nodeæ•°ç»„çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯2çš„å¹‚æ¬¡æ–¹ï¼Ÿ
        æºä»£ç ä¸­çš„`(n - 1) & hash `ç­‰ä»·äº`hash%n`ã€‚å‰ææ˜¯nå¿…é¡»ä¸º2çš„å€æ•°
    ```java
    final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
        Node<K,V>[] tab; Node<K,V> p; int n, i;
        if ((tab = table) == null || (n = tab.length) == 0)
            //å¦‚æœtableæ•°ç»„æ²¡æœ‰åˆå§‹åŒ–ï¼Œå°±å»newä¸€ä¸ªé•¿åº¦ä¸º16çš„Nodeæ•°ç»„
            n = (tab = resize()).length;
        if ((p = tab[i = (n - 1) & hash]) == null)//ç¡®å®šæ·»åŠ è¿›æ¥çš„å…ƒç´ åœ¨tableæ•°ç»„ä¸­çš„ä½ç½®
            tab[i] = newNode(hash, key, value, null);
        else {
            Node<K,V> e; K k;
            if (p.hash == hash &&
                ((k = p.key) == key || (key != null && key.equals(k))))
                e = p;
            else if (p instanceof TreeNode)
                e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);
            else {
                for (int binCount = 0; ; ++binCount) {
                    if ((e = p.next) == null) {
                        p.next = newNode(hash, key, value, null);
                        if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st
                            treeifyBin(tab, hash);
                        break;
                    }
                    if (e.hash == hash &&
                        ((k = e.key) == key || (key != null && key.equals(k))))
                        break;
                    p = e;
                }
            }
            if (e != null) { // existing mapping for key
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                afterNodeAccess(e);
                return oldValue;
            }
        }
        ++modCount;//è¢«ä¿®æ”¹çš„æ¬¡æ•°+1
        if (++size > threshold)//mapä¸­çš„æ€»æ•°é‡+1
            resize();
        afterNodeInsertion(evict);
        return null;
    }
    ```
    ä¼šå»newä¸€ä¸ªé•¿åº¦ä¸º16çš„Nodeæ•°ç»„
    <img src="HashMap_jdk7.png" width=600px>
    <img src="HashMap_jdk8.png" width=600px>
    * Properties:
    1ã€å¸¸ç”¨æ¥å¤„ç†é…ç½®æ–‡ä»¶
    2ã€ä½œä¸ºHashMapçš„å­ç±»ï¼Œå®ƒçš„ç‰¹åˆ«ä¹‹å¤„å°±æ˜¯keyå’Œvalueéƒ½æ˜¯Stringç±»å‹
    ```java
    //==========a.cbc=============
    //å…¶å®æ–‡ä»¶ååªæ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œåªè¦ç¨‹åºèƒ½æ‰¾åˆ°å°±è¡Œï¼Œä¸ç®¡åç¼€æ˜¯.txtè¿˜æ˜¯.cbc
    name=Tom
    password=123456
    //===========ä½¿ç”¨================
    public static void main(String[] args) throws IOException {
        Properties prop = new Properties();
        prop.load(new FileReader("a.cbc"));//new FileReaderè¿˜æ˜¯new FileInputStreaméƒ½å¯ä»¥
        String name = prop.getProperty("name");
        System.out.println(name);
    }
    ```
    > Warningï¼
    é…ç½®æ–‡ä»¶ä¸‹é¢ä¸¤ç§å†™æ³•æ˜¯ä¸ä¸€æ ·çš„!
    driver=com.mysql.jdbc.Driver
    å½“pros.getproperty()çš„æ—¶å€™ï¼Œdriver="com.mysql.jdbc.Driver";
    driver="com.mysql.jdbc.Driver"
    å½“pros.getproperty()çš„æ—¶å€™ï¼Œdriver=" "com.mysql.jdbc.Driver" ";
    å¤šä¸ªå¼•å·!
## æ³›å‹ï¼ˆjdk5å¼•å…¥ï¼‰
* ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ³›å‹ï¼Ÿï¼ˆä½¿ç”¨æ³›å‹ä¸Objectçš„åŒºåˆ«ï¼‰
1ã€å¯ä»¥æ¶ˆé™¤castçš„ä»£ç 
2ã€ä½¿ç”¨æ³›å‹å¯ä»¥ä¿è¯é›†åˆé‡Œé¢å­˜çš„æ•°æ®éƒ½æ˜¯ç›¸åŒç±»å‹çš„ã€‚Objectä»€ä¹ˆä¸œè¥¿éƒ½å¯ä»¥å¾€é‡Œé¢æ”¾ï¼Œå¾ˆå®¹æ˜“å¼•å‘runtimexceptionã€‚æ’é™¤è¿è¡Œæ—¶å¼‚å¸¸è¦æ¯”ç¼–è¯‘å¼‚å¸¸èŠ±è´¹æ›´é•¿çš„æ—¶é—´
> æ³¨ï¼šæ³›å‹çš„ç±»å‹ä¸èƒ½æ˜¯åŸºæœ¬æ•°æ®ç±»å‹
* è‡ªå®šä¹‰æ³›å‹ç±»
> æ³¨ï¼š
1ã€è‡ªå®šä¹‰æ³›å‹ç±»ä¸­çš„æ„é€ å™¨å°±æ˜¯æ­£å¸¸çš„æ„é€ å™¨ï¼Œä¸ç”¨å¸¦æ³›å‹
* æ³›å‹ç±»
```java
public class A <T>{
    public T method(){ //å’Œæ™®é€šæ–¹æ³•ä¸€æ ·ï¼Œåªä¸è¿‡void/intè¢«æ¢æˆäº†T
        //
    }
}
```
* æ³›å‹æ–¹æ³•
```java
å¦‚æœåœ¨ä¸€ä¸ªæ™®é€šçš„ç±»ä¸­ä½¿ç”¨æ³›å‹ï¼Œå†™æˆå¦‚ä¸‹æ–¹å¼ï¼š
public class A{
    public int indexof(T[] arr,T target){
        for (int i = 0; i < arr.length; i++){
            if (arr.equals(target)) return i;
        }
        return -1;
    }
}
ä¼šç¼–è¯‘æŠ¥é”™ã€‚è§£å†³æ–¹æ³•æœ‰ä¸¤ç§ï¼š
1ã€å°†ç±»å˜æˆæ³›å‹ç±»
2ã€å°†æ–¹æ³•å˜ä¸ºæ³›å‹æ–¹æ³•
public class A{
    public <T> int indexof(T[] arr,T target){
        for (int i = 0; i < arr.length; i++){
            if (arr.equals(target)) return i;
        }
        return -1;
    }
}
```
* `T`çš„é™å®š
    * èƒŒæ™¯ï¼šä½¿ç”¨`T`ï¼Œå°±å¯ä»¥çœ‹æˆObjectã€‚å¦‚æœæˆ‘æƒ³å¯¹è¿™ä¸ª`T`åŠ ä¸Šä¸€äº›é™åˆ¶ï¼šæ¯”å¦‚Tå¿…é¡»ä¸ºNumberçš„å­ç±»ã€‚è€Œä¸æ˜¯Objectçš„å­ç±»
    * ä¸Šé™ä¸ºæŸä¸ªç±»
    ```java
    public class NumberPair<U extends Number,V extends Number>{

    }
    ```
    * ä¸Šé™ä¸ºæŸä¸ªæ¥å£
    ```java
    public <T extends Comparable> T max(T[] arr){ //è¦æ±‚ä¼ è¿›æ¥çš„ç±»å‹Tè¦å®ç°Comparable

    }
    ```
    * ä¸Šé™ä¸ºE
    ```java
    public <T extends E> void addAll(T[] arr){

    }
    ```
* é€šé…ç¬¦ï¼š`?`
    * `<? extends E>`
    ```java
    public void addAll(DynamicArray<? extends E> arr){

    }
    ç­‰ä»·äº
    public <T extends E> void addAll(DynamicArray<T> arr){

    }
    ```
    * `<? super E>`:ä¸çŸ¥é“ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯ç±»å‹Tæ˜¯Eçš„çˆ¶ç±»
## å¸¸ç”¨ç±»
* String
    * å¸¸ç”¨æ–¹æ³•
        * å°†Stringè½¬åŒ–ä¸ºcharæ•°ç»„ï¼šString.toCharArry();
        * å°†charæ•°ç»„è½¬åŒ–ä¸ºStringï¼šè°ƒç”¨Stringçš„æ„é€ å™¨
        > ä¸ºä»€ä¹ˆå°†charæ•°ç»„ä¼ ç»™Stringçš„æ„é€ å™¨ï¼Œè¿˜éœ€è¦åœ¨newä¸€ä¸ªæ–°çš„charæ•°ç»„ï¼Œç„¶ååœ¨åœ¨è°ƒç”¨copyofæ–¹æ³•å¤åˆ¶ï¼Ÿä¸èƒ½ç›´æ¥å°†ä¼ è¿›æ¥çš„charæ•°ç»„ç›´æ¥èµ‹ç»™Stringé‡Œé¢çš„valueå—ï¼Ÿ
        APIä¸­å†™çš„å¾ˆæ¸…æ¥šï¼Œè¿™æ ·åšå°±ç®—å¯¹åŸæ¥çš„charæ•°ç»„åšä¿®æ”¹ï¼Œä¹Ÿä¸ä¼šå½±å“String
        * å¿½ç•¥å¤§å°å†™è¿›è¡Œå­—ç¬¦ä¸²æ¯”è¾ƒï¼šequalsIgnoreCase
        > æ³¨ï¼š`"C".equalsIgnoreCase(str)`è¿™æ ·å†™çš„ç›®çš„æ˜¯ä¸ºäº†é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸
        * å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå¤§å†™ï¼štoUpperCase
    * ä»€ä¹ˆæ˜¯Stringçš„ä¸å¯å˜æ€§ï¼Ÿ
    æ— è®ºå¯¹åŸæœ‰çš„Stringåšä»»ä½•ä¿®æ”¹æ“ä½œï¼Œéƒ½ä¼šé‡æ–°é€ ä¸€ä¸ªæ–°çš„Stringï¼Œè€Œä¸æ”¹å˜åŸæ¥çš„
    ä½“ç°ï¼š1ã€`str += "World"`2ã€`str.replace(a,m)`
    > **important**
    `String str = new String("hello");`åº•å±‚è¿‡ç¨‹ï¼š
    0ã€å½“ç±»è¿›è¡ŒåŠ è½½çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨æ–¹æ³•åŒºä¸­å¼€è¾Ÿå†…å­˜ï¼Œåˆ›å»ºä¸€ä¸ª`"hello"`å­—ç¬¦ä¸²
    1ã€åœ¨æ‰§è¡Œnewçš„æ—¶å€™ï¼Œå°±ä¼šåœ¨å †ä¸­å¼€è¾Ÿå†…å­˜ï¼Œå¹¶ä¸”å°†å †ä¸­Stringé‡Œé¢çš„valueèµ‹ä¸ªåœ°å€ï¼ŒæŒ‡å‘æ–¹æ³•åŒºä¸­`"hello"`å­—ç¬¦ä¸²ä¸­çš„value
    å›¾å¦‚ä¸‹ï¼š
    <img src="./String.png" width=500px>
    ```java
    //Notice 2:

    /*
        1ã€å­—é¢é‡æˆ–è€…å­—é¢é‡çš„ç»„åˆéƒ½åœ¨å¸¸é‡æ± 
        2ã€åªè¦æ¶‰åŠåˆ°å˜é‡ï¼Œéƒ½åœ¨å †ç©ºé—´
        String str1 = "JavaEE"
        String str = str1 + "Hadoop"
        str1å’ŒHadoopéƒ½åœ¨å¸¸é‡æ± ä¸­ï¼Œä½†stråœ¨å †ä¸­
    */


    //è¿™ç§å½¢å¼ç¼–è¯‘å™¨ä¼šç›´æ¥æŠŠ"JavaEEHadoop"æ”¾è¿›å¸¸é‡æ± ï¼Œæ‰€ä»¥è¿è¡Œæ—¶å¸¸é‡æ± ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªStringå®ä¾‹JavaEEHadoopï¼Œè€Œä¸ä¼šåˆ†åˆ«å­˜åœ¨Javaå’ŒHadoopä¸¤ä¸ªString
    String str2 = "JavaEE"+"Hadoop";

    //è¿™ç§å½¢å¼ï¼šåªè¦æ¶‰åŠä¸€ä¸ªå˜é‡+ï¼Œéƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªString
    String str1 = "JavaEE";
    String str3 = str1+"Hadoop";
    ```
    * `intern()`æ–¹æ³•
    ```java
    String s1 = "java";
    String s3 = "javaHadoop";
    String s5 = s1+"Hadoop";
    String s8 = s5.intern();
    s8 == s3 //true
    /*
    s5.intern()è¿è¡Œæµç¨‹è§£æï¼š
    å› ä¸ºs5æ˜¯"javaHadoop",æ‰€ä»¥é¦–å…ˆå»è¿è¡Œæ—¶å¸¸é‡æ± é‡Œé¢å»æ‰¾ï¼Œå­˜ä¸å­˜åœ¨å­—ç¬¦ä¸²str.equals(s5)==trueï¼Œå¦‚æœå­˜åœ¨ï¼Œç›´æ¥å°†è¯¥å­—ç¬¦ä¸²åœ°å€è¿”å›ç»™s8
    å¦‚æœä¸å­˜åœ¨ï¼Œåœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­åˆ›å»ºå¯¹è±¡ï¼Œå¹¶å°†åœ°å€è¿”å›ç»™s8
    */
    ```
    * 
    ```java
    Person p1 = new Person("Hello",1);
    Person p2 = new Person("Hello",2);
    p1.name == p2.name //true,ä¸ºä»€ä¹ˆï¼Ÿ
    ```
    <img src="Stringv1.png">

    * StringBuffer & StringBuilder
    1ã€Stringå’ŒStringBufferæ˜¯JDK1.0ä¸€å—æ¨å‡ºçš„
    2ã€StringBuilderæ˜¯JDK1.5æ¨å‡ºçš„ï¼Œç›®çš„æ˜¯å¯¹StringBufferåœ¨çº¿ç¨‹æ–¹é¢è¿›è¡Œæ”¹è‰¯
    > StringBufferæ•ˆç‡æ¯”è¾ƒä½ï¼Œå› ä¸ºæ˜¯çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œæ–¹æ³•éƒ½æ˜¯synchronizedçš„
* Random
    * æ„é€ å™¨Random(seed):å¦‚æœseedä¸€æ ·ï¼Œéšæœºå‡ºæ¥çš„æ•°ä¹Ÿä¸€æ ·ï¼Œæ‰€ä»¥ä¸€èˆ¬è¿™æ ·ç”¨`new Random(System.currentTimeMillis());`
    * random.nextInt(4):ä»0~3ä¸­éšæœºå–ä¸€å€¼
### Javaå­—ç¬¦ä¸²å ä½ç¬¦
* å‚è€ƒï¼š[CSDN](https://blog.csdn.net/weixin_41919486/article/details/122521836)
### Arrays
* `Arrays.sort()`
    * åŸºæœ¬æ•°æ®ç±»å‹ï¼Œé»˜è®¤ä»å°åˆ°å¤§
    * `sort(T[] a, Comparator<? super T> c)`
        * ä½¿ç”¨èƒŒæ™¯ï¼š
        1ã€å¯¹Stringæ•°ç»„éœ€è¦ä»å¤§åˆ°å°æ’åºï¼šè‡ªå·±å†™ä¸ªComparator
        2ã€å¯¹Stringæ•°ç»„ï¼Œæƒ³è¦å¿½ç•¥å¤§å°å†™è¿›è¡Œä»å°åˆ°å¤§æ’åºï¼š`Arrays.sort(arr,String.CaseInsensitiveComparator)`
* `Arrays.toString()`ï¼š
    * éœ€è¦èƒŒæ™¯ï¼šè¾“å‡ºæ•°ç»„ã€‚å¦‚æœç›´æ¥è¾“å‡ºstrï¼Œè¾“å‡ºçš„æ˜¯ä¸€ä¸ªåœ°å€
    * Arraysé‡Œæœ‰ä¹ä¸ªé‡è½½çš„toStringæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºå…«ä¸ªåŸºæœ¬æ•°æ®ç±»å‹+ä¸€ä¸ªå¯¹è±¡ç±»å‹
### Collections
* `reverse`
```java
//åè½¬list
Collections.reverse(list);
```
* `reverseOrder`
reverseOrderåº•å±‚ä»ç„¶æ˜¯è°ƒç”¨ç±»é‡Œé¢çš„compareToæ–¹æ³•ã€‚
æ‰€ä»¥åªæœ‰åƒStringè¿™æ ·å·²ç»é‡å†™äº†compareToæ–¹æ³•çš„ç±»ï¼Œæ‰èƒ½ä½¿ç”¨reverseOrderæ–¹æ³•
* `binarySearch`ï¼šé’ˆå¯¹List
é»˜è®¤ä¼ å…¥çš„Listéœ€è¦ä»å°åˆ°å¤§æ’åºï¼Œå¦‚æœæ˜¯ä»å¤§åˆ°å°æ’åºæƒ³è¦ä½¿ç”¨binarySearchï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªé€†åºçš„Comparator`Collection.binarySearch(list,7,Collections.reverseOrder())`;
* `sort`ï¼šé’ˆå¯¹List


### æ—¶é—´ç›¸å…³
* `System.currentTimeMillis()`
* Dateç±»
    * util.Dateçš„ä½¿ç”¨
    ```java
    public class DateTest {
        public static void main(String[] args) {
            Date date = new Date();
            System.out.println(date);
            //2023-4-11 æ˜ŸæœŸäºŒ
            //getYearå¾—åˆ°çš„æ˜¯è·ç¦»1900å¹´ä¹‹é—´çš„ï¼Œæ‰€ä»¥res+1900æ‰æ˜¯ç°åœ¨çš„å¹´ä»½
            System.out.println(date.getYear());//123
            //å¦‚æœ1æœˆï¼Œè¿”å›0ï¼›æ‰€ä»¥ç°åœ¨çš„æœˆä»½æ˜¯res+1
            System.out.println(date.getMonth());//3
            //å‘¨æ—¥ä¸º0
            System.out.println(date.getDay());//2
        }
    }
    ```
    * util.Dateä¸sql.Dateä¹‹é—´çš„åŒºåˆ«
    1ã€sql.Dateæ¶‰åŠæ•°æ®åº“ï¼šæ•°æ®åº“ä¸­çš„intå¯¹åº”Javaä¸­çš„intï¼›æ•°æ®åº“ä¸­çš„varcharå¯¹åº”Javaä¸­çš„Stringï¼›æ•°æ®åº“ä¸­çš„Dateå°±å¯¹åº”Javaä¸­çš„sql.Date
    2ã€sql.Dateç»§æ‰¿äºutil.Date
    3ã€å¦‚ä½•å°†util.Dateè½¬åŒ–ä¸ºsql.Dateï¼Ÿ
    ```java
    public class SimpleDateFormatTest {
        public static void main(String[] args) throws ParseException {
            Date date = new Date();
            java.sql.Date date1 = new java.sql.Date(date.getTime());
        }
    }   
    ```
* SimpleDataFormat
    * å¦‚ä½•é€šè¿‡simpledataformatå°†`2000-11-03`è½¬åŒ–ä¸ºDataä¸­çš„æ•°å€¼ï¼Ÿ
    ```java
    public class SimpleDateFormatTest {
        public static void main(String[] args) throws ParseException {
            String str = "2023-04-11";
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
            Date date = sdf.parse(str);
            System.out.println(date);
        }
    }
    ```
    * å°†Dateè½¬åŒ–ä¸º`2023-04-11 15:51:16 æ˜ŸæœŸäºŒ`çš„å½¢å¼
    ```java
    public class SimpleDateFormatTest {
        public static void main(String[] args) {
            SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss E");
            String res = sdf.format(new Date());
            System.out.println(res);
        }
    }
    ```
* æ¯”è¾ƒå™¨
    * comparableæ¥å£
        * compareToçš„å†™æ³•ï¼š
        this(A) compateTo(B)
        å¦‚æœAæ¯”Bå¤§ï¼Œè¿”å›æ­£ï¼›Aæ¯”Bå°ï¼Œè¿”å›è´Ÿã€‚è¿™æ ·å†™æ’åºçš„æ—¶å€™é»˜è®¤ä»å°åˆ°å¤§
        * ä½¿ç”¨ï¼š
        1ã€ç±»ç»§æ‰¿æ¥å£ï¼Œé‡å†™compareToæ–¹æ³•
        2ã€å°†å®ä¾‹å¡åˆ°æ•°ç»„é‡Œé¢ï¼Œä½¿ç”¨Arrays.sort()è¿›è¡Œæ’åº
    å¦‚ä½•å¯¹å¯¹è±¡æ•°ç»„è¿›è¡Œæ’åºï¼Ÿ
    * comparatoræ¥å£
        * ä¸ºä»€ä¹ˆå¼•å…¥comparatoræ¥å£ï¼Ÿ
        ä¸€ä¸ªç±»å·²ç»å®ç°ç±»comparableæ¥å£ï¼Œä½†æƒ³æŒ‰ç…§å…¶ä»–è§„åˆ™æ’åºï¼Œè€Œä¸”ä¸æƒ³æ”¹ç±»ä¸­çš„æºä»£ç ï¼šä¾‹å¦‚æƒ³è¦Stringä»å¤§åˆ°å°å»æ’åºï¼›æˆ–è€…ç›¸å¯¹JDKé‡Œé¢çš„ç±»å®ç°æ’åºåŠŸèƒ½ï¼ˆJDKé‡Œæ²¡æœ‰å®ç°comparableæ¥å£çš„ç±»ï¼Œä½†æˆ‘ä»¬åˆä¸èƒ½æ”¹jdkçš„æºç 
        * comparatorçš„ä½¿ç”¨
        å®ç°compareæ–¹æ³•ï¼ŒA compare Bï¼šå¦‚æœAå¤§äºBè¿”å›æ­£ï¼Œå°äºè¿”å›è´Ÿã€‚é»˜è®¤ä»åˆ°å¤§
        ```java
        Arrays.sort(str, new Comparator<String>() {
            @Override
            public int compare(String o1, String o2) { //æ¥å£çš„åŒ¿åå®ç°ç±»
                return -o1.compareTo(o2);
            }
        });
        ```
* numberç±»
    * BigDecimal
        * ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Big Decimalï¼Ÿ
        BigDecimalåœ¨å•†ä¸šä¸­ä»£æ›¿doubleç±»å‹ï¼Œå®ç°æ›´å¥½çš„ç²¾åº¦ç®¡ç†
        ```java
            public static void main(String[] args) {
            double a = 0.1;
            double b = 0.00000000000001;
            double c = a+b;
            System.out.println(c); //ç³»ç»Ÿè¾“å‡º0.10000000000001001
        }
        ```
## IO
* Fileç±»
    > ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Fileç±»è¿›è¡ŒIOï¼Ÿ
    1ã€Javaä¸­ä¸‡äº‹ä¸‡ç‰©çš†å¯¹è±¡ï¼Œç”¨fileæ¥è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶
    2ã€file.getAbsolutePath()æœ‰æ—¶çœŸçš„æŒºæœ‰ç”¨çš„
* `OutPutStream`ä¸ºä»€ä¹ˆè¦åœ¨closeä¹‹å‰æ‰§è¡Œflushæ“ä½œï¼Ÿ
ä¸æ“ä½œç³»ç»Ÿçš„å®ç°æœ‰å…³ï¼Œæœ‰å¯èƒ½åœ¨writeä¹‹åï¼Œæ•°æ®å¹¶ä¸æ˜¯ç›´æ¥å†™å…¥æ–‡ä»¶ï¼Œè€Œæ˜¯åœ¨å†…å­˜ä¸­ç¼“å­˜ç€ï¼Œå¦‚æœç›´æ¥closeæ‰äº†ï¼Œå¯èƒ½ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼›
é€šè¿‡flushæ“ä½œï¼ŒæŒ‡ç¤ºoså°†writeçš„æ‰€æœ‰æ•°æ®å†™å…¥ç£ç›˜
```java
    //è¿è¡Œåä¼šå‘ç°a.txté‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰
    public static void main(String[] args) throws IOException {
        String str = "å¤§å®¶å¥½ï¼";
        FileWriter fw = new FileWriter("a.txt");
        fw.write(str);
    }
```
* èŠ‚ç‚¹æµï¼ˆæ–‡ä»¶æµï¼‰
    * FileReader&FileWriter
        * read():è¿”å›è¯»å…¥å­—ç¬¦çš„ç¼–ç æ•°å­—ï¼Œå¦‚æœåˆ°äº†æ–‡ä»¶æœ«å°¾ï¼Œè¿”å›-1
            ```java
            char[] cbuf = new char[5];
            int len;
            fr.read(cbuf); //æ–‡ä»¶çš„å†…å®¹ï¼šhelloWorld123
            while((len = fr.read(cbuf)) != -1){
                for(int i = 0;i < cbuf.length;i++){
                    System.out.print(cbuf[i]); //ç¬¬ä¸‰æ¬¡è¾“å‡º123ldï¼Ÿ
                }
            }
            ```
        * FileInputStream&FileOutputStream

* å¤„ç†æµ  
    > æ³¨ï¼šå¦‚æœæŠŠæµæƒ³è±¡æˆä¸€æ ¹ç®¡å­ï¼ŒèŠ‚ç‚¹æµå°±æ˜¯è£¸çš„ç®¡å­ï¼Œè€Œå¯¹è±¡æµåŒ…è£¹åœ¨èŠ‚ç‚¹æµä¸Š
    ä»ä»£ç å±‚é¢ï¼šå¤„ç†æµåœ¨åˆ›å»ºæ—¶ï¼Œä¼ ç»™æ„é€ å™¨çš„å‚æ•°éƒ½æ˜¯æµå¯¹è±¡ï¼Œè€Œä¸åƒèŠ‚ç‚¹æµä¸€æ ·å‚æ•°ä¸ºfile/String

    * ç¼“å†²æµ
        * ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¼“å†²æµï¼Ÿç¼“å†²æµæ˜¯å¯¹èŠ‚ç‚¹æµçš„è¿›ä¸€æ­¥å°è£…ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†æé«˜ä¼ è¾“æ•ˆç‡
        * BufferedInputStream&BufferedOutpurStream
        > æ³¨æ„ï¼šBufferedæµåœ¨æ„é€ çš„æ—¶å€™éœ€è¦ä¼ å…¥ä¸€ä¸ªèŠ‚ç‚¹æµã€‚ï¼ˆä½“ç°ç¼“å†²æµåŒ…åœ¨èŠ‚ç‚¹æµçš„å¤–é¢ï¼‰
        åœ¨å…³é—­æµçš„æ—¶å€™ï¼Œéœ€è¦å…ˆå…³Bufferedæµï¼Œåœ¨å…³èŠ‚ç‚¹æµã€‚ä½†ç”±äºå…³é—­ç¼“å†²æµçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨çš„æŠŠèŠ‚ç‚¹æµå…³é—­ï¼Œæ‰€ä»¥èŠ‚ç‚¹æµçš„å…³é—­ä¸å†™ä¹Ÿè¡Œ

        >Q:ä¸ºä»€ä¹ˆBufferedStreamä¼šæ¯”FileStreamæ•ˆç‡é«˜?
        BufferedStreamä¸åº•å±‚äº¤äº’çš„æ¬¡æ•°æ¯”è¾ƒå°‘ï¼Œä¸åº•å±‚äº¤äº’ä¸€æ¬¡ï¼Œå®ƒä¼šä¸€ä¸‹å–å¾ˆå¤šæ•°æ®å¹¶ä¿å­˜åœ¨è‡ªå·±ç±»ä¸­çš„bufferä¸­ã€‚
        ç”¨BufferedStreamè¿›è¡Œreadæ“ä½œï¼Œå®é™…ä¸Šæ˜¯å°†bufferä¸­æ•°æ®çš„ä¸€éƒ¨åˆ†ç»™ä½ ï¼Œè€Œä¸éœ€è¦åœ¨å‘åº•å±‚å»è¦
        * BufferedReader&BufferedWriter
            * readline()
    * è½¬æ¢æµ
        * InputStreamReader&OutputStreamWriter
    * å…¶ä»–å¤„ç†æµ
        * æ‰“å°æµï¼šPrintStream&PrintWriter
        > æ³¨ï¼šå› ä¸ºSystem.outå°±æ˜¯ä¸€ä¸ªPrintStreamï¼Œæ‰€ä»¥PrintStreamé€šå¸¸ä¸System.setOut()æ­é…ä½¿ç”¨ï¼Œè¿™æ ·å†ç”¨System.outçš„æ—¶å€™å°±ä¸ä¼šè¾“å‡ºåˆ°æ§åˆ¶å°äº†
        * System.in&System.out
        > ä¸ºä»€ä¹ˆç”¨System.outæ—¶ï¼Œå¦‚æœpojoé‡å†™to_stringå’Œä¸é‡å†™to_stringè¾“å‡ºçš„å†…å®¹ä¸ä¸€æ ·ï¼Ÿ
        è¯·çœ‹System.out.printæ–¹æ³•çš„æºä»£ç 
        * æ•°æ®æµï¼šdataInputStream&dataOutputStream
            * ç”¨æ³•ï¼šå°†åŸºæœ¬æ•°æ®ç±»å‹or Stringè¾“å‡ºè‡³æœ¬åœ°æ–‡ä»¶
        * å¯¹è±¡æµï¼šObjectInputStream&ObjectOutputStream
            * ç”¨æ³•ï¼šå°†ä¸€ä¸ªå¯¹è±¡å†™å…¥æœ¬åœ°æ–‡ä»¶ï¼ˆåºåˆ—åŒ–ï¼‰
            * å¦‚ä½•å°†è‡ªå·±æ‰‹å†™çš„Personç±»åºåˆ—åŒ–&ååºåˆ—åŒ–
            ```java
            public class Person implements Serializable {//å¿…é¡»è¦implements Serializableæ¥å£
                int age;
                String name;

                public Person(int age, String name) {
                    this.age = age;
                    this.name = name;
                }

                @Override
                public String toString() {
                    return "Person{" +
                            "age=" + age +
                            ", name='" + name + '\'' +
                            '}';
                }
            }
            //=========================================================
            public static void main(String[] args) throws Exception {
                ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("oos.txt"));
                oos.writeObject(new Person(1,"cbc"));

                ObjectInputStream ois = new ObjectInputStream(new FileInputStream("oos.txt"));
                Object o = ois.readObject();
                System.out.println(o);
            }            
            ```
        > åºåˆ—åŒ–&ååºåˆ—åŒ–
        1ã€åºåˆ—åŒ–å°±æ˜¯å°†å¯¹è±¡æ•°æ®ä¿å­˜åˆ°æœ¬åœ°ï¼›ååºåˆ—åŒ–å°±æ˜¯å°†å¯¹è±¡ä»æ–‡ä»¶ä¸­è¯»å…¥å†…å­˜
        2ã€ä¸€ä¸ªç±»æƒ³è¦åºåˆ—åŒ–çš„æ¡ä»¶ï¼šâ‘ å®ç°serializableæ¥å£â‘¡ç»™ä¸€ä¸ªserialVersionUIDâ‘¢ç±»ä¸­çš„æ‰€æœ‰å±æ€§ä¹Ÿè¦å¯åºåˆ—åŒ–ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹é»˜è®¤å¯åºåˆ—åŒ–ï¼‰
        3ã€å¦‚æœä¸€ä¸ªç±»ä¸­çš„å±æ€§è¢«staticæˆ–è€…transientä¿®é¥°ï¼Œåˆ™ä¸èƒ½åºåˆ—åŒ–
        (
            firstly:ä»å†…å­˜å±‚é¢æ¥äº†è§£ï¼šåºåˆ—åŒ–æ˜¯å°†å †ä¸­å¯¹è±¡çš„æ•°æ®è¿›è¡Œä¿å­˜ï¼Œä½†staticä¿®é¥°çš„å˜é‡å€¼å­˜åœ¨æ–¹æ³•åŒºï¼Œè‡ªç„¶ä¿å­˜ä¸äº†
            secondly:transientå…³é”®å­—åº”è¯¥æ˜¯ç»™åºåˆ—åŒ–çš„æ“ä½œè€…çœ‹çš„
        )
        å…³äºserialVersionUIDçš„ä¸€äº›è¯´æ˜ï¼š
        1ã€è¿™ä¸ªUIDå¯ä»¥ä¸å†™ï¼Œå¦‚æœä¸å†™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªï¼Œä½†å­˜åœ¨é—®é¢˜
        2ã€å‡å¦‚æˆ‘ä½¿ç”¨Personç±»çš„å¯¹è±¡personè¿›è¡Œåºåˆ—åŒ–ä¸ºperson.datï¼Œç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªUIDã€‚
        ä½†å¦‚æœæˆ‘å¯¹Personç±»è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œé‚£è¿™æ—¶Personç±»çš„UIDå°±ä¼šæ›´æ–°ã€‚è¿™æ—¶å°†person.datååºåˆ—åŒ–æ—¶å°±æ‰¾ä¸åˆ°å¯¹åº”çš„ç±»äº†
        æ‰€ä»¥ä¸€èˆ¬UIDä¸€å®šè¦å†™
        * RandomAccessFileç±»
## ç½‘ç»œç¼–ç¨‹
* ByteArrayOutputStream
    * ä¸ºä»€ä¹ˆç”¨å®ƒï¼Ÿ
    æƒ…æ™¯ï¼šæœ‰ä¸€ä¸ªç½‘ç»œè¾“å…¥æµï¼Œä¼ è¾“çš„æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæˆ‘æƒ³åœ¨å†…å­˜å±‚é¢ï¼ˆç¨‹åºä¸­ï¼‰è¾“å‡ºä¸€ä¸‹ä¼ è¿‡æ¥çš„å†…å®¹ï¼Œè¯¥æ€ä¹ˆå†™ï¼Ÿ
    å› ä¸ºä¼ è¾“å†…å®¹æœ‰ä¸­æ–‡ã€æœ‰è‹±æ–‡ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥è¾“å‡ºByteæ•°ç»„è½¬Stringï¼Œå¯èƒ½ä¹±ç 
    * ä¼˜ç‚¹ï¼šè¯¥ç±»ä¸­æœ‰ä¸ªbufferï¼Œå¦‚æœä¸å¤Ÿäº†è¿˜å¯ä»¥è‡ªå·±å¢åŠ ï¼Œæ‰€ä»¥å°†Byteæ•°ç»„å†™è¿›ByteArrayOutputStreamä¸­ï¼Œæœ€åé€šè¿‡ç±»çš„to_Stringæ–¹æ³•æ‰“å°åˆ°console
* Socket
    <img src="./socket.png" width="550px">
    * socket.shoutdownOutput
## åå°„
newå¯¹è±¡çš„ç¬¬äºŒç§æ–¹å¼
* ä¸ºä»€ä¹ˆéœ€è¦åå°„ï¼Ÿ
åŠ¨æ€æ€§
éœ€æ±‚ï¼šç»™ä½ ä¸åŒç±»çš„åç§°ï¼Œç»™æˆ‘è¿”å›ä¸åŒç±»çš„å®ä¾‹(å¯¹è±¡)
```java
   public void test2(){
        for(int i = 0;i < 100;i++){
            int num = new Random().nextInt(3);//0,1,2
            String classPath = "";
            switch(num){
                case 0:
                    classPath = "java.util.Date";
                    break;
                case 1:
                    classPath = "java.lang.Object";
                    break;
                case 2:
                    classPath = "www.java.Person";
                    break;
            }
            try {
                Object obj = getInstance(classPath);
                System.out.println(obj);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
    public Object getInstance(String classPath) throws Exception {
        Class clazz =  Class.forName(classPath);
        return clazz.newInstance();
    }
```
> åå°„ä¸å°è£…æ€§çŸ›ç›¾å—ï¼Ÿ
* è·å–classå¯¹è±¡çš„å››ç§æ–¹å¼
```java
        //æ–¹å¼ä¸€ï¼š
        Class c1 = Person.class;
        System.out.println(c1);

        //æ–¹å¼äºŒï¼šé€šè¿‡è¿è¡Œæ—¶ç±»çš„å¯¹è±¡,è°ƒç”¨getClass()
        Person p1 = new Person();
        Class c2 = p1.getClass();
        System.out.println(c2);

        //*å¸¸ç”¨ï¼šæ–¹å¼ä¸‰ï¼šè°ƒç”¨Classçš„é™æ€æ–¹æ³•ï¼šforName(String classPath)
        Class c3 = Class.forName("com.example.pojo.Person");
        System.out.println(c3);

        System.out.println(c1 == c2);
        System.out.println(c1 == c3);

        //æ–¹å¼å››ï¼šä½¿ç”¨ç±»çš„åŠ è½½å™¨ï¼šClassLoader  (äº†è§£)
        ClassLoader classLoader = ReflectionTest.class.getClassLoader();
        Class c4 = classLoader.loadClass("www.gh110.com");
        System.out.println(c4);
```
Some Questions
1ã€Classå®ä¾‹å’Œæ–¹æ³•åŒºçš„æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªä¸œè¥¿å—ï¼Ÿ
ä¸æ˜¯
<img src="./åå°„Classå¯¹è±¡çš„ä½ç½®.png" width=400px>
2ã€ä¸€ä¸ªPersonç±»åŠ è½½è¿›æ¥ä¼šç”Ÿæˆä¸€ä¸ªClasså¯¹è±¡ï¼Œé‚£Classç±»å‘¢ï¼Ÿ
æ ¹æ®ä¸‹é¢çš„ä»£ç ï¼ŒClassç±»åŠ è½½è¿›æ¥ä¹Ÿä¼šæœ‰ä¸€ä¸ªClasså¯¹è±¡
```java
Class classClass = Class.class;
System.out.println(classClass);
```
* ä½¿ç”¨ClassLoaderåŠ è½½é…ç½®æ–‡ä»¶
```java
        Properties pros = new Properties();
        //æ­¤æ—¶çš„æ–‡ä»¶é»˜è®¤åœ¨å½“å‰çš„moduleä¸‹ã€‚
        //è¯»å–é…ç½®æ–‡ä»¶çš„æ–¹å¼ä¸€ï¼š
//        FileInputStream fis = new FileInputStream("jdbc.properties");
//        pros.load(fis);

        //è¯»å–é…ç½®æ–‡ä»¶çš„æ–¹å¼äºŒï¼šä½¿ç”¨ClassLoader
        //é…ç½®æ–‡ä»¶é»˜è®¤è¯†åˆ«ä¸ºï¼šå½“å‰moduleçš„srcä¸‹
        ClassLoader classLoader = ClassLoaderTest.class.getClassLoader();
        InputStream is = classLoader.getResourceAsStream("jdbc1.properties");
        pros.load(is);
```
## æ—¥å¿—
* ä¸ºä»€ä¹ˆéœ€è¦æ—¥å¿—ï¼Ÿ
æ¯”å¦‚è¯´ä¸€ä¸ªä¾›ç”¨æˆ·è¿›è¡Œå¢åˆ æ”¹æŸ¥çš„é¡¹ç›®ï¼Œå¦‚æœæˆ‘æƒ³çŸ¥é“ç”¨æˆ·çš„æ¯ä¸€æ­¥æ“ä½œçš„ä¿¡æ¯ï¼ˆå‡ æœˆå‡ å·å‡ æ—¶å‡ åˆ†ï¼Œè¿›è¡Œäº†ä»€ä¹ˆæ“ä½œï¼Œæ“ä½œçš„æ•°æ®æ˜¯ä»€ä¹ˆï¼‰ï¼Œè¯¥æ€ä¹ˆåšï¼Ÿ
å½“ç„¶å¯ä»¥æŠŠè¿™äº›è®°å½•å­˜åˆ°æ•°æ®åº“é‡Œï¼Œä½†ä¸å»ºè®®ï¼›
ä¹Ÿä¸èƒ½ç›´æ¥åœ¨ä»£ç ä¸­soutï¼Œå› ä¸ºä»£ç æ˜¯éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šçš„ï¼Œ1ã€é¦–å…ˆæœåŠ¡å™¨ä¸Šå¯èƒ½ä¸æ­¢ä¸€ä¸ªé¡¹ç›®åœ¨è¿è¡Œï¼Œå°±ç®—ä½ ä½¿ç”¨ä¸€ä¸ªå±å¹•ç›¯ç€æœåŠ¡å™¨çš„è¾“å‡ºçœ‹ï¼Œä¿¡æ¯ä¹Ÿæ˜¯å¾ˆä¹±çš„2ã€å°±ç®—åªæœ‰ä¸€ä¸ªé¡¹ç›®åœ¨è¿è¡Œï¼Œä½ ä¹Ÿå¯ä»¥ç›¯ç€å±å¹•çœ‹ï¼Œé‚£å¦‚æœæˆ‘æƒ³çŸ¥é“å‡ ä¸ªæœˆå‰çš„è®°å½•ï¼Œä½ éš¾é“è¦ä¸€ç›´å¾€ä¸Šç¿»ï¼Ÿ

æ—¥å¿—çš„åŠŸèƒ½ç®€è€Œè¨€ä¹‹å°±æ˜¯å°†ç¨‹åºçš„è¾“å‡ºè½¬å†™åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼ˆä½¿ç”¨soutæ˜¯å°†ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œä½¿ç”¨æ—¥å¿—å¯ä»¥å°†ä¿¡æ¯è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼‰ã€‚æ¯ä¸ªé¡¹ç›®å¼•å…¥è‡ªå·±çš„æ—¥å¿—ï¼Œæœ€åçš„ç»“æœå°±æ˜¯å¤šå‡ºæ¥å‡ ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªé¡¹ç›®å°†è‡ªå·±æƒ³è¦è¾“å‡ºçš„ä¿¡æ¯è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ã€‚
è¿™æ ·å°±ç®—æˆ‘æ‰¾å‡ ä¸ªæœˆä¹‹å‰çš„æ•°æ®ï¼Œä¹Ÿå¾ˆå®¹æ˜“æ‰¾åˆ°
## ç±»çš„æ‰©å±•
### æšä¸¾ç±»ï¼ˆenumï¼‰
* æšä¸¾ç±»çš„å‰èº«
```java
    class Size {
        public static final int SMALL = 0;
        public static final int MEDIUM = 1;
        public static final int LARGE = 2;
    }
``` 
* ä¸ºä»€ä¹ˆä½¿ç”¨æšä¸¾ç±»ï¼Ÿ

```java
enum Size{
    SMALL,
    MEDIUM,
    LARGE;
}
ç­‰ä»·äº
public final class Size extends Enum<Size> {
        public static final Size SMALL = new Size("SMALL",0);
        public static final Size MEDIUM = new Size("MEDIUM",1);
        public static final Size LARGE = new Size("LARGE",2);
        private static Size[] VALUES = new Size[]{SMALL, MEDIUM, LARGE};
        private Size(String name, int ordinal){
            super(name, ordinal);
        }
        public static Size[] values(){ //ç¼–è¯‘å™¨è‡ªå·±åŠ çš„
            Size[] values = new Size[VALUES.length];
            System.arraycopy(VALUES, 0, values, 0, VALUES.length);
            return values;
        }
        public static Size valueOf(String name){ //ç¼–è¯‘å™¨è‡ªå·±åŠ çš„
            return Enum.valueOf(Size.class, name);
        }
    }
```

## jdkæ–°ç‰¹æ€§
* Lambdaè¡¨è¾¾å¼ï¼ˆä¸€ç§è¯­æ³•ï¼‰
    * Lambadå‡ºç°çš„èƒŒæ™¯
    å®˜è¯ï¼šæ›´ç®€æ´balabala
    ç™½è¯ï¼šå…¶ä»–ç¼–ç¨‹è¯­è¨€é‡Œæœ‰ï¼ŒJavaä¸€çœ‹è¿˜æŒºå¥½ï¼Œç›´æ¥'å€Ÿé‰´'è¿‡æ¥
    * Lambdaè¡¨è¾¾å¼çš„æœ¬è´¨
    `Comparable cmp = (o1,o2) -> Integer.compare(o1,o2)`:Lambdaè¡¨è¾¾å¼æ•´ä½“ä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼›è¿™ä¸ªå¯¹è±¡å®ç°äº†xxï¼ˆComparableï¼‰æ¥å£
    ```java
    Runnable runnable = ()->{
    //some code here  
    };
   
    Runnable runnable = new Runnable() {
        @Override
        public void run() {
            //some code here      
        }
    };    
    ```
    * ä½¿ç”¨Lambdaè¡¨è¾¾å¼çš„è¦æ±‚ï¼šè¯¥æ¥å£ä¸ºå‡½æ•°å¼æ¥å£
    å³åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•
* å‡½æ•°å¼æ¥å£
    * `@FunctionalInterface`
    éªŒè¯è¯¥æ¥å£æ˜¯å¦ç¬¦åˆå‡½æ•°å¼æ¥å£çš„è¦æ±‚
* Lambdaè¡¨è¾¾å¼çš„æ—¥å¸¸ä½¿ç”¨
ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ¥æ”¶ä¸€ä¸ªå˜é‡
ä¹Ÿå¯ä»¥æ¥æ”¶ä¸€ä¸ªæ–¹æ³•ï¼ˆæ–¹æ³•æä¾›ä¸€å¥—æ‰§è¡Œé€»è¾‘ï¼Œæ•°æ®ç”±å¯¹è±¡è‡ªå·±æä¾›ï¼šå¦‚list.foreach()ï¼‰
å¦‚æœä¸€ä¸ªæ–¹æ³•éœ€è¦æ¥æ”¶æ–¹æ³•ä½œä¸ºå‚æ•°ï¼Œä¸€èˆ¬é€šè¿‡æ¥å£å®ç°
å½“ä¼ é€’å‚æ•°çš„æ—¶å€™ï¼Œæœ‰ä»¥ä¸‹å†™æ³•
```java
//1
list.forEach(new Consumer<String>() {
            @Override
            public void accept(String s) {

            }
        });
//2 Lambdaè¡¨è¾¾å¼
list.forEach(curString->{
    System.out.println(curString);
});
//3 Lambdaè¡¨è¾¾å¼è¿›é˜¶ï¼šæ–¹æ³•å¼•ç”¨
list.forEach(System.out::println);
```
* ç†è§£æ–¹æ³•å¼•ç”¨
ä½¿ç”¨æ–¹æ³•å¼•ç”¨çš„æ—¶å€™ï¼Œè¯´æ˜è¯¥å‚æ•°éœ€è¦ä¸€ä¸ªå‡½æ•°
è€Œå‡½æ•°æˆ‘åªå…³å¿ƒå‚æ•°å’Œå‡½æ•°ä½“
# Stream
## reference
* [Introduction to Java 8 Streams -by daeldung](https://www.baeldung.com/java-8-streams-introduction)
# å¹¶å‘/å¼‚æ­¥ç¼–ç¨‹
## ä¸ºä»€ä¹ˆéœ€è¦å¤šçº¿ç¨‹ï¼Ÿ
åœ¨ä¸€ä¸ªserviceä¸­ï¼Œå¯èƒ½éœ€è¦æŸ¥è¯¢å¤šæ¬¡æ•°æ®åº“(å¯èƒ½ä¸æ˜¯åŒä¸€å¼ è¡¨ï¼Œç”šè‡³å¯èƒ½ä¸æ˜¯åŒä¸€ä¸ªæ•°æ®åº“)ï¼Œå°†å¤šæ¬¡çš„æŸ¥è¯¢ç»“æœå°è£…æˆVo
> aã€è¯»å–æ–‡ä»¶1 ï¼ˆ10msï¼‰
bã€å¤„ç†1çš„æ•°æ®ï¼ˆ1msï¼‰
cã€è¯»å–æ–‡ä»¶2 ï¼ˆ10msï¼‰
dã€å¤„ç†2çš„æ•°æ®ï¼ˆ1msï¼‰
eã€è¯»å–æ–‡ä»¶3 ï¼ˆ10msï¼‰
fã€å¤„ç†3çš„æ•°æ®ï¼ˆ1msï¼‰
gã€æ•´åˆ1ã€2ã€3çš„æ•°æ®ç»“æœ ï¼ˆ1msï¼‰

**å•çº¿ç¨‹æ€»å…±å°±éœ€è¦34msã€‚**
é‚£å¦‚æœä½ åœ¨è¿™ä¸ªè¯·æ±‚å†…ï¼ŒæŠŠabã€cdã€efåˆ†åˆ«åˆ†ç»™3ä¸ªçº¿ç¨‹å»åšï¼Œå°±åªéœ€è¦12msäº†ã€‚
## ä½¿ç”¨å¤šçº¿ç¨‹çš„å‡ ç§æ–¹å¼
* çº¿ç¨‹çš„åˆ›å»ºå’Œä½¿ç”¨
    * æœ‰å‡ ç§æ–¹å¼åˆ›å»ºçº¿ç¨‹? (2+2JDK5.0)
        1. ç»§æ‰¿threadç±»ï¼Œé‡å†™runæ–¹æ³•
        > ä¸ºä»€ä¹ˆè°ƒstart()æ–¹æ³•ä¼šæ‰§è¡Œrun()ï¼Ÿ 
        the Java Virtual Machine calls the run method of this thread.-JavaAPI
        2. å®ç°Runnableæ¥å£ï¼Œå®ç°runæ–¹æ³•ï¼Œ`new Thread(p).start();`
        > Q:ä¸ºä»€ä¹ˆé€šè¿‡å®ç°runnableæ¥å£è¿™ç§æ–¹å¼ï¼Œticketså°±å¯ä»¥æŠŠstaticå»æ‰ï¼Ÿ
        å› ä¸ºmythreadå¯¹è±¡å‘¢åœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½ï¼Œticketså˜é‡å­˜åœ¨è¿™ä¸ªå¯¹è±¡ä¸­ã€‚é€šè¿‡çº¿ç¨‹è°ƒç”¨runæ–¹æ³•çš„æ—¶å€™ï¼Œä¿®æ”¹çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ä¸­çš„åŒä¸€ä¸ªtickets
        3. FutureTask+Callableæ¥å£
        <img src="./FutureTask+Callable.png">
        è°ƒç”¨futuretaské‡Œé¢çš„runæ–¹æ³•
        runæ–¹æ³•å®é™…è°ƒç”¨callableä¸­çš„callæ–¹æ³•ï¼Œå¹¶å°†ç»“æœå‚¨å­˜èµ·æ¥
        ```java
        public class CallableTest {
            static int a;
            static class MyCallable implements Callable<Integer>{
                @Override
                public Integer call() throws Exception {
                    System.out.println("enter thread!");
                    for (int i = 0; i < 2000; i++) a++;
                    return a;
                }
            }
            public static void main(String[] args) throws ExecutionException, InterruptedException {
                FutureTask<Integer> task1 = new FutureTask<>(new MyCallable());
                Thread t1 = new Thread(task1);
                t1.start();
                //å¦‚æœt1è¿˜æ²¡æœ‰æ‰§è¡Œç»“æŸï¼Œé‚£ä¹ˆget()æ–¹æ³•ä¼šä¸€ç›´é˜»å¡
                Integer res = task1.get();
            }
        }        
        ```
        4. ä½¿ç”¨çº¿ç¨‹æ± 
        ä½¿ç”¨çº¿ç¨‹æ± çš„å¥½å¤„
        ä¸ä½¿ç”¨çº¿ç¨‹æ± ï¼Œäººä¸ºçš„åˆ›å»ºçº¿ç¨‹é”€æ¯çº¿ç¨‹æœ‰ä»¥ä¸‹é—®é¢˜ï¼š
        1ã€ä¸èŠ‚åˆ¶ï¼šæ¥ä¸€ä¸ªè¯·æ±‚æˆ‘å°±ä¼šåˆ†é…ä¸€ä¸ªçº¿ç¨‹ï¼ŒCPU&å†…å­˜ç©ºé—´æ€¥å‰§ä¸‹é™
        2ã€åšäº†ä¸€äº›æ²¡å¿…è¦çš„é‡å¤åŠ¨ä½œï¼šåˆ›å»º-å¤„ç†-é”€æ¯ï¼Œåˆåˆ›å»º-å¤„ç†-åˆé”€æ¯ï¼šå¤šæ¬¡çš„åˆ›å»º&é”€æ¯åŠ¨ä½œï¼Œæ²¡å¿…è¦ï¼›ä¸èƒ½å¾ˆå¥½çš„å¤ç”¨
        ```java
        public class ThreadPoolTest {
            static class MyRunnable implements Runnable{
                @Override
                public void run() {
                    String name = Thread.currentThread().getName();
                    System.out.println(name);
                }
            }
            public static void main(String[] args) {
                ExecutorService executorService = Executors.newFixedThreadPool(4);
                for (int i = 0; i < 10; i++) executorService.submit(new MyRunnable());
                executorService.shutdown();
            }
        }        
        ```
## çº¿ç¨‹æ± è¯¦è§£
### ä¸ºä»€ä¹ˆéœ€è¦çº¿ç¨‹æ± ï¼Ÿ
å¦‚æœåœ¨é¡¹ç›®ä¸­éœ€è¦æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œå¦‚æœä½¿ç”¨åŸç”Ÿçš„çº¿ç¨‹åˆ›å»ºæ–¹å¼(ä½¿ç”¨çº¿ç¨‹çš„å‰ä¸‰ç§)ï¼Œå°±ä¼šé¢‘ç¹çš„æ¶‰åŠçº¿ç¨‹çš„åˆ›å»ºä»¥åŠçº¿ç¨‹çš„é”€æ¯ï¼›

ä¸ä½¿ç”¨çº¿ç¨‹æ± ï¼Œäººä¸ºçš„åˆ›å»ºçº¿ç¨‹é”€æ¯çº¿ç¨‹æœ‰ä»¥ä¸‹é—®é¢˜ï¼š
1ã€ä¸èŠ‚åˆ¶ï¼šæ¥ä¸€ä¸ªè¯·æ±‚æˆ‘å°±ä¼šåˆ†é…ä¸€ä¸ªçº¿ç¨‹ï¼ŒCPU&å†…å­˜ç©ºé—´æ€¥å‰§ä¸‹é™
2ã€åšäº†ä¸€äº›æ²¡å¿…è¦çš„é‡å¤åŠ¨ä½œï¼šåˆ›å»º-å¤„ç†-é”€æ¯ï¼Œåˆåˆ›å»º-å¤„ç†-åˆé”€æ¯ï¼šå¤šæ¬¡çš„åˆ›å»º&é”€æ¯åŠ¨ä½œï¼Œæ²¡å¿…è¦ï¼›ä¸èƒ½å¾ˆå¥½çš„å¤ç”¨
> ps: åœ¨ä»¥åçš„ä¸šåŠ¡ä»£ç ä¸­ï¼Œä½¿ç”¨å¤šçº¿ç¨‹åªé€šè¿‡çº¿ç¨‹æ± ï¼Œå…¶ä»–ä¸‰ç§æ–¹æ³•éƒ½ä¸ç”¨
### åˆ›å»ºçº¿ç¨‹æ± çš„æ–¹å¼
```java
//1ã€ä½¿ç”¨JUCä¸­çš„Executorså·¥å…·ç±»
ExecutorService executorService = Executors.newFixedThreadPool(4);
//2ã€ä½¿ç”¨åŸç”Ÿçš„ThreadPoolExecutor
/*  ThreadPoolExecutoræ„é€ å™¨çš„ä¸ƒå¤§å‚æ•°ï¼š
        1ï¼‰int corePoolSizeï¼šçº¿ç¨‹æ± åˆ›å»ºå¥½ä»¥åï¼Œå­˜åœ¨çš„çº¿ç¨‹æ•°é‡ï¼›è¿™äº›çº¿ç¨‹ä¼šä¸€ç›´å­˜åœ¨
        2ï¼‰int maximumPoolSizeï¼šè§„å®šçº¿ç¨‹æ•°çš„ä¸Šé™(åŒ…æ‹¬core)
        3ï¼‰int keepAliveTimeï¼šé™¤äº†æ ¸å¿ƒçº¿ç¨‹ä¹‹å¤–çš„çº¿ç¨‹ï¼Œå¦‚æœç©ºé—²äº†keepAliveTimeï¼Œé‚£ä¹ˆå°±é”€æ¯
        4ï¼‰unitï¼šå’ŒkeepAliveTimeé…åˆä½¿ç”¨ï¼šå¦‚æœunit=SECONDï¼ŒkeepAliveTime=10ï¼Œé‚£å°±ä»£è¡¨10s
        5ï¼‰BlockingQueue<Runnable> workQueue:é€šè¿‡service.submit()æäº¤çš„çº¿ç¨‹ä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰çº¿ç¨‹æœ‰ç©ºï¼Œå°±ä¼šå…ˆè¢«æ”¾è¿›workQueueé‡Œï¼Œç­‰å¾…è¢«çº¿ç¨‹æ‰§è¡Œ
        6ï¼‰ThreadFactory threadFactoryï¼šçº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹çš„æ—¶å€™ï¼Œæ‰€ä½¿ç”¨çš„çº¿ç¨‹å·¥å‚
        æœ‰ä»€ä¹ˆç”¨ï¼Ÿå¯ä»¥æ¨¡ä»¿Executorså·¥å…·ç±»ä¸­çš„defaultThreadFactoryï¼Œæ¥è‡ªå®šä¹‰çº¿ç¨‹çš„åç§°
        7ï¼‰handlerï¼šå¦‚æœé˜»å¡é˜Ÿåˆ—æ»¡äº†ï¼Œç”±handlerå¤„ç†æ‹’æ¥æ‰§è¡Œä»»åŠ¡
        æœ‰ä»€ä¹ˆç”¨ï¼Ÿå¯ä»¥æ¨¡ä»¿ThreadPoolExecutorä¸­çš„AbortPolicyæ¥è‡ªå®šä¹‰å½“é˜»å¡é˜Ÿåˆ—æ»¡äº†æ‰§è¡Œä»€ä¹ˆæ“ä½œ(AbortPolicyæ‰§è¡Œçš„æ“ä½œæ˜¯æŠ›å¼‚å¸¸)
*/
```
### çº¿ç¨‹æ± è¿è¡Œæµç¨‹
<img src="./çº¿ç¨‹æ± è¿è¡Œæµç¨‹.png">



## synchronized
* èƒŒæ™¯
åœ¨ä½¿ç”¨å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œå¦‚æœå¤šçº¿ç¨‹ä¹‹é—´å…±äº«å˜é‡ï¼Œé‚£å°±è¦åŠ ä¸Šä¸€äº›æªæ–½ã€‚å¦åˆ™ä¼šå¯¼è‡´è¿è¡Œç»“æœå‡ºé”™
å¦‚ä¸‹ä¹°ç¥¨çš„ä¾‹å­ï¼š
```java
public class SellTickets {
    public static class Runnable01 implements Runnable{
        private Integer tickets = 100;
        @Override
        public void run() {
            while (tickets > 0){
                try {
                    Thread.sleep(100);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                String name = Thread.currentThread().getName();
                System.out.println(name+" ï¼š "+"ç¬¬"+tickets+"å¼ ç¥¨å·²å–å‡º");
                tickets--;
            }
        }
    }

    public static void main(String[] args) {
        Runnable01 r1 = new Runnable01();
        new Thread(r1).start();
        new Thread(r1).start();
    }
}
```

* åŒæ­¥æ–¹æ³•ä¸­çš„é”å¯¹è±¡æ˜¯è°ï¼Ÿ
é”å¯¹è±¡æ˜¯æ–¹æ³•çš„è°ƒç”¨è€…
å¦‚æœä¸åŠ staticï¼Œè°ƒç”¨è€…å°±æ˜¯this
å¦‚æœåŠ ä¸Šstaticï¼Œè°ƒç”¨è€…å°±æ˜¯.classå¯¹è±¡
* å¯¹è±¡åœ¨å†…å­˜ä¸­çš„æ ·å­
<img src="./object.jpg" size=500px>


## volatile
* ä½¿ç”¨volatileçš„ç»“æœæ˜¯ï¼š
å½“æŸä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œä¿®æ”¹åï¼Œå…¶ä»–çº¿ç¨‹å°±ç«‹åˆ»èƒ½å¾—åˆ°ä¿®æ”¹åçš„ç»“æœ
* ä½œç”¨ï¼š
1ã€è¢«volatileä¿®é¥°çš„å˜é‡aï¼Œåªè¦æœ‰çº¿ç¨‹ä¿®æ”¹a,é‚£ä¹ˆå…¶ä»–çº¿ç¨‹å°±ç«‹åˆ»å¯ä»¥çœ‹åˆ°è¿™ä¸ªaè¢«ä¿®æ”¹äº†
2ã€ç¦æ­¢æŒ‡ä»¤é‡æ’
> volatileå¯ä»¥ä¿è¯åœ¨å­—èŠ‚ç æ‰§è¡Œgetstatic,getfiledï¼Œæ”¾è¿›æ“ä½œæ•°æ ˆé‡Œé¢çš„æ•°æ®ä¸€å®šæ˜¯æ­£ç¡®çš„ã€‚ä½†æ˜¯è¿™å¹¶ä¸æ˜¯è¯´æ˜ä½¿ç”¨volatileå°±ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› ä¸ºåœ¨æ‰§è¡Œå­—èŠ‚ç çš„æ—¶å€™ä»ç„¶å­˜åœ¨åŸå­æ€§é—®é¢˜
å³volatileä¿è¯ä¸€è‡´æ€§ï¼Œä½†ä¸ä¿è¯åŸå­æ€§
* ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ï¼Ÿ(ä½¿ç”¨åœºæ™¯)
ä¸€ä¸ªçº¿ç¨‹å†™ï¼Œå¤šä¸ªçº¿ç¨‹è¯»
1ã€æ ‡å¿—flag
2ã€å•ä¸€èµ‹å€¼
3ã€è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼šå†™æ“ä½œåŠ ä¸Šsynchronizedï¼Œè¯»æ“ä½œä¸åŠ é”ï¼Œå˜é‡å£°æ˜ä¸ºvolatile
```java
//=================before:å­çº¿ç¨‹ä¸€ç›´å¾ªç¯
public class VolatileTest {
    static boolean flag = true;
    static class MyThread extends Thread{
        @Override
        public void run() {
            while(flag){

            }
            System.out.println("å­çº¿ç¨‹ç»“æŸ");
        }
    }
    public static void main(String[] args) throws InterruptedException {
        MyThread t1 = new MyThread();
        t1.start();
        Thread.sleep(10);
        flag = false;
    }
}
//=================after:æ­£å¸¸ç»“æŸ=========================
public class VolatileTest {
    static volatile boolean flag = true;
    static class MyThread extends Thread{
        @Override
        public void run() {
            while(flag){

            }
            System.out.println("å­çº¿ç¨‹ç»“æŸ");
        }
    }
    public static void main(String[] args) throws InterruptedException {
        MyThread t1 = new MyThread();
        t1.start();
        Thread.sleep(10);
        flag = false;
    }
}
```
## å¹¶å‘ç¼–ç¨‹çš„åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§
* åŸå­æ€§
ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å–å€¼ï¼ŒåŒæ—¶åŠ 1ï¼Œç›¸ç»§å†™å›ï¼Œä¼šå‘ç°+1æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œå¯ç»“æœåªå¤šäº†1
* å¯åŠ æ€§
mainçº¿ç¨‹ï¼Œå­çº¿ç¨‹ï¼Œå­çº¿ç¨‹ä¸æ–­åœ°whileï¼Œå½“flagä¸ºfalseçš„æ—¶å€™é€€å‡ºwhileï¼Œmainçº¿ç¨‹å»ä¿®æ”¹flagçš„å€¼
* æœ‰åºæ€§
ä¾‹å­åŒå¯åŠ æ€§
* synchronizedè§£å†³äº†æ‰€æœ‰é—®é¢˜
> Qï¼šsynchronizedæ˜¯å¦‚ä½•è§£å†³å¯è§æ€§é—®é¢˜çš„ï¼Ÿ
è¿›å…¥synchronizedå—çš„å†…å­˜è¯­ä¹‰æ˜¯æŠŠåœ¨synchronizedå—å†…ä½¿ç”¨åˆ°çš„å˜é‡ä»çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­æ¸…é™¤ï¼Œè¿™æ ·åœ¨synchronizedå—å†…ä½¿ç”¨åˆ°è¯¥å˜é‡æ—¶å°±ä¸ä¼šä»çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­è·å–ï¼Œè€Œæ˜¯ç›´æ¥ä»ä¸»å†…å­˜ä¸­è·å–ã€‚é€€å‡ºsynchronizedå—çš„å†…å­˜è¯­ä¹‰æ˜¯æŠŠåœ¨synchronizedå—å†…å¯¹å…±äº«å˜é‡çš„ä¿®æ”¹åˆ·æ–°åˆ°ä¸»å†…å­˜ã€‚-ã€ŠJavaå¹¶å‘ç¼–ç¨‹ä¹‹ç¾ã€‹
* ä»€ä¹ˆæ˜¯åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§ï¼Ÿ
æ˜¯æŒ‡åœ¨å¯¹å…±äº«å˜é‡è¿›è¡Œæ“ä½œæ—¶ï¼Œæ“ä½œä¸€å®šé€šè¿‡æŸç§æœºåˆ¶æ»¡è¶³åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§ã€‚å¦åˆ™å¤šçº¿ç¨‹ç¨‹åºçš„è¿è¡Œç»“æœæ˜¯é”™è¯¯çš„
1ã€åŸå­æ€§
é€šè¿‡é”synchronzedæ¥ä¿è¯åŸå­æ€§
ï¼ˆpsï¼šä¿è¯åŸå­æ€§è‡ªç„¶å°±ä¿è¯å¯è§æ€§ï¼Œå¦‚æœä¿è¯äº†åŸå­æ€§ï¼Œä¸¤ä¸ªçº¿ç¨‹æ ¹æœ¬ä¸å¯èƒ½åŒæ—¶å¯¹å…±äº«å˜é‡è¿›è¡Œæ“ä½œï¼Œè‡ªç„¶ä¸å­˜åœ¨å¯è§æ€§çš„é—®é¢˜ï¼‰
2ã€å¯è§æ€§
ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶åœ¨æ“ä½œæ•°æ ˆä¸­å¯¹å…±äº«å˜é‡è¿›è¡Œæ“ä½œ
## çº¿ç¨‹çš„æ“ä½œ
### `join()`
å¦‚æœmainæ–¹æ³•é‡Œè°ƒç”¨`thread.join()`æ–¹æ³•ï¼Œé‚£ä¹ˆåªæœ‰åœ¨threadè¿è¡Œç»“æŸåæ‰èƒ½ç»§ç»­è¿è¡Œåé¢çš„è¯­å¥
```java
public class VolatileTest {
static int a = 0;
static class MyThread extends Thread{
    @Override
    public void run() {
        a = 20;
    }
}
public static void main(String[] args) throws InterruptedException {
    MyThread myThread = new MyThread();
    myThread.start();
    myThread.join();
    System.out.println(a); //aå¿…ä¸º20
    }
}   
```
### `wait()&nofity()`
> very important!
wait()&notify()å¿…é¡»åœ¨`synchronized()`åŒæ­¥ä»£ç å—ä¸­è°ƒç”¨
* å¤šçº¿ç¨‹å‡ºç°çš„èƒŒæ™¯
CPUè¶Šæ¥è¶Šå¿«ï¼Œè¿›ç¨‹ä¹‹é—´è¿›è¡Œåˆ‡æ¢å‘æŒ¥ä¸äº†cpuçš„å…¨éƒ¨æ€§èƒ½ï¼Œè€Œä¸”ä»£ä»·å¾ˆé«˜ï¼ˆä¿å­˜çš„å†…å®¹å¾ˆå¤šï¼‰ï¼Œæ‰€ä»¥å°†è¿›ç¨‹çš„æ‰§è¡Œè¿›ä¸€æ­¥ç»†åŒ–ä¸ºçº¿ç¨‹ã€‚
* æ”¯æŒå¤šçº¿ç¨‹åå‡ºç°çš„é—®é¢˜
1ã€åŸå­æ€§
å› ä¸ºçº¿ç¨‹å…±äº«ä¸€äº›å†…å­˜ï¼Œæ‰€ä»¥åœ¨å¤šä¸ªçº¿ç¨‹æƒ³è¦ä¿®æ”¹åŒä¸€ä¸ªå†…å­˜æ—¶ï¼Œå°±ä¼šå‘ç”ŸåŸå­æ€§é—®é¢˜ï¼ˆå†…å­˜çš„è®¿é—®ä¸èƒ½äº’æ–¥ï¼‰ã€‚å¾—åˆ°çš„ç»“æœä¸€èˆ¬éƒ½æ˜¯é”™çš„
2ã€çº¿ç¨‹çš„åŒæ­¥ï¼ˆçº¿ç¨‹2çš„æ‰§è¡Œéœ€è¦çº¿ç¨‹1ç®—å‡ºçš„ç»“æœï¼‰
* å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ï¼Ÿ
1ã€åŸå­æ€§ï¼ˆé”æ€æƒ³ï¼‰
* æ“ä½œç³»ç»Ÿå¦‚ä½•æ”¯æŒå¤šçº¿ç¨‹/å¹¶å‘ï¼Ÿ
é”çš„å®ç°éœ€è¦ç¡¬ä»¶å’Œosçš„å…±åŒå¸®åŠ©
ç¡¬ä»¶æä¾›ä¸€äº›åŸå­æŒ‡ä»¤ï¼ˆtest-and-set,compare-and-swapï¼‰,é€šè¿‡è¿™äº›åŸå­æŒ‡ä»¤ï¼Œå¯ä»¥å®ç°é”çš„åŸºæœ¬åŠŸèƒ½ï¼ˆäº’æ–¥ï¼‰ï¼Œä½†æ•ˆç‡ä¸é«˜
oså¯ä»¥é€šè¿‡ä¸€äº›æ•°æ®ç»“æ„oræ€æƒ³å¯¹åŸºæœ¬é”è¿›è¡Œæ”¹è¿›ï¼Œä½¿å¾—å…¶æ•ˆç‡æ›´é«˜
> ä»€ä¹ˆæ˜¯CASï¼Ÿ
CAS(compare-and-swap)æ˜¯ç¡¬ä»¶ä¸­çš„ä¸€ä¸ªåŸå­æŒ‡ä»¤ï¼Œæ¯”è¾ƒå½“å‰å€¼ä¸æ‰€æœŸå¾…çš„å€¼æ˜¯å¦ç›¸åŒ...
è¿™ä¸€ç³»åˆ—æ“ä½œéƒ½æ˜¯åŸå­çš„ï¼Œå³ä¸èƒ½è¢«æ‰“æ–­çš„
* æ¦‚å¿µ
    * ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ ä¸€ä¸ªè¿›ç¨‹ä¸­çš„ä¸€æ¡æ‰§è¡Œè·¯å¾„
    * ä»€ä¹ˆå«ä¸€ä¸ªç¨‹åºæ”¯æŒå¤šçº¿ç¨‹ï¼Ÿ
    * å¤šçº¿ç¨‹å°±ä¸€å®šå¿«å—ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹å¤šçº¿ç¨‹åè€Œæ›´æ…¢ï¼Ÿ
    * ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦å¤šçº¿ç¨‹ï¼Ÿ å¦‚æœç³»ç»Ÿçš„æŸä¸ªåŠŸèƒ½éœ€è¦ç­‰å¾…æ—¶é—´ï¼Œé‚£å°±éœ€è¦æŠŠå®ƒæ”¾åœ¨çº¿ç¨‹é‡Œï¼Œè¿™æ ·çš„ç›®çš„æ˜¯è·å¾—æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼ˆå¤–å–ä¾‹å­ï¼‰
    * ä½¿ç”¨çº¿ç¨‹çš„å¥½å¤„
    ä»¥å¤–å–è½¯ä»¶ä¸ºä¾‹å­ï¼Œå¦‚æœä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œé‚£ä¹ˆåœ¨åŠ è½½å›¾ç‰‡è¿™ä¸ªä»»åŠ¡æ˜¯åœ¨ä¸»ç¨‹åºå®Œæˆçš„ã€‚åœ¨å›¾ç‰‡åŠ è½½å®Œæˆä¹‹å‰ï¼Œä¸‹é¢çš„ä»£ç éƒ½è¦ç­‰å¾…ï¼Œä¸èƒ½æ‰§è¡Œã€‚
    ä½¿ç”¨å¤šçº¿ç¨‹åï¼Œå¯ä»¥æŠŠåŠ è½½å›¾ç‰‡è¿™ä¸ªä»»åŠ¡åˆ†ç»™ä¸€ä¸ªçº¿ç¨‹ï¼ˆåå¤‡å¤„ç†å™¨ï¼‰ï¼Œä¸»ç¨‹åºç»§ç»­æ‰§è¡Œï¼ˆæ•ˆç‡é«˜ï¼‰
## JUCä¸‹çš„ç±»
* é˜»å¡é˜Ÿåˆ—
å’Œé˜Ÿåˆ—ç±»ä¼¼ï¼Œåªä¸è¿‡å¦‚æœé˜Ÿåˆ—ä¸­æ»¡äº†åœ¨å¾€é‡Œé¢æ·»åŠ å…ƒç´ ï¼Œä¼šé˜»å¡æ·»åŠ å…ƒç´ çš„çº¿ç¨‹
åŒç†ï¼Œåœ¨å¾€å¤–æ‹¿çš„æ—¶å€™ï¼Œå¦‚æœé˜Ÿåˆ—ä¸ºç©ºï¼Œä¼šé˜»å¡æ‹¿å…ƒç´ çš„çº¿ç¨‹

* çº¿ç¨‹çš„å®‰å…¨é—®é¢˜
    * ä¸ºä»€ä¹ˆçº¿ç¨‹ä¼šæœ‰å®‰å…¨é—®é¢˜ï¼Ÿ
    å¤šçº¿ç¨‹çš„å¥½å¤„å°±æ˜¯é€šè¿‡å……åˆ†å‹æ¦¨CPUï¼Œæ¥è·å¾—æ›´é«˜çš„æ•ˆç‡ï¼›ä½†ç¼ºç‚¹æ˜¯å¦‚æœå¤šçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®æ—¶ï¼Œå¾€å¾€ä¼šå‡ºç°é”™è¯¯
    ä¸¾ä¸ªæ —å­ï¼šå–ç¥¨ç¯èŠ‚ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›å…¥ifè¯­å¥ï¼›
    > å¦‚ä½•ç†è§£ï¼šåªè¦çº¿ç¨‹ä¸­æ“ä½œäº†å…±äº«æ•°æ®ï¼Œå°±ä¸€å®šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿ
    ä¸ä»…æ˜¯ifè¯­å¥ï¼Œå°±ç®—ç®€å•çš„åŠ å‡åœ¨å¤šçº¿ç¨‹ä¸­éƒ½ä¼šå‡ºç°é—®é¢˜
    ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¯¹`i`è¿›è¡Œ+1000æ“ä½œï¼Œä½†`i=i+1000`ä¼šè¢«åˆ†ä¸ºå¤šä¸ªå­—èŠ‚ç æŒ‡ä»¤ï¼Œå¦‚æœç¬¬ä¸€ä¸ªçº¿ç¨‹å…ˆæŠŠiæ”¾è¿›æ“ä½œæ•°æ ˆï¼Œç„¶ååˆ‡æ¢ç¬¬äºŒä¸ªçº¿ç¨‹ã€‚æœ€ç»ˆç»“æœå°±æ˜¯ä¸¤ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œäº†+1000æ“ä½œï¼Œä½†iåªå¤šäº†1000
    * è§£å†³çº¿ç¨‹å®‰å…¨çš„é—®é¢˜(é€šè¿‡ğŸ”’)
        1. åŒæ­¥ä»£ç å—
        ```java
            synchronized (obj) { //ojbæ˜¯ä»»æ„å¯¹è±¡ï¼Œå……å½“é”ï¼›å”¯ä¸€è¦æ±‚å°±æ˜¯å¤šçº¿ç¨‹ä¸­ï¼Œobjå®ä¾‹å”¯ä¸€
            //å¦‚æœRunnableæ¥å£ï¼Œobjé€šå¸¸ç”¨this,å¦‚æœç»§æ‰¿ï¼Œobjé€šå¸¸MyClass.class
                if (tickets > 0) {
                    try {
                        Thread.sleep(100);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                    System.out.println(Thread.currentThread().getName() + ":" + tickets);
                    tickets--;
                } else break;
            }
        ```
        2. åŒæ­¥æ–¹æ³•ï¼šåœ¨æ–¹æ³•ä¸ŠåŠ ä¸Šsynchronized
        æ³¨æ„ç‚¹ï¼šåœ¨æ–¹æ³•ä¸ŠåŠ ä¸Šsynchronizedé»˜è®¤ä½¿ç”¨thisä½œä¸ºobjï¼Œè¿™ç§ç”¨æ³•å¯¹extendsæ¥è¯´æ— æ•ˆï¼Œæ‰€ä»¥åœ¨extendsæ—¶è¦å°†æ­¤åŒæ­¥æ–¹æ³•å£°æ˜ä¸ºstaticçš„ï¼Œå®ƒå°±ä¼šä½¿ç”¨classä½œä¸ºobj
        3. ä½¿ç”¨Lock
        ```java
        Lock lock = new ReentrantLock();
        public void run() {
            while(true){
                try{
                    lock.lock();
                    if (tickets > 0) {
                        System.out.println(Thread.currentThread().getName() + ":" + tickets);
                        tickets--;
                    } else break;
                }finally {
                    lock.unlock();
                }
            }
        }
        ```
* ä½¿ç”¨ğŸ”’çš„å¼Šå¤„ï¼šæ­»é”é—®é¢˜
* çº¿ç¨‹çš„é€šä¿¡é—®é¢˜
    * é—®é¢˜å¼•å…¥
    å¦‚ä½•è®©ä¸¤ä¸ªçº¿ç¨‹**äº¤æ›¿**æ‰“å°1~100ä¹‹é—´çš„æ•°ï¼Ÿ
    ```java
    //extendsæ–¹æ³•
    public void run() {
        while (true){
            synchronized (WaitTest.class){
                WaitTest.class.notify();
                if (i < 100){
                    i++;
                    System.out.println(Thread.currentThread().getName()+":"+i);
                    try {
                        WaitTest.class.wait();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }else break;
            }
        }
    }
    ```
    é€šè¿‡wait(),notify();
    > æ³¨ï¼š
    1ã€wait()è°ƒç”¨åï¼Œå½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡æ€ï¼Œåªæœ‰å…¶ä»–çº¿ç¨‹è°ƒç”¨notifyï¼Œè¯¥çº¿ç¨‹æ‰èƒ½ç»§ç»­æ‰§è¡Œï¼›
    2ã€wait()è°ƒç”¨åï¼Œå½“å‰çº¿ç¨‹ä¼šè¿›å…¥é˜»å¡æ€å¹¶é‡Šæ”¾æ‰åŒæ­¥é”
    3ã€wait()å’Œnotify()æ˜¯ç”±é”æ¥è°ƒç”¨çš„ï¼
> é¢è¯•é¢˜ï¼šsleep()å’Œwait()çš„å¼‚åŒ
ç›¸åŒç‚¹ï¼šè°ƒç”¨åï¼Œéƒ½è¿›å…¥é˜»å¡æ€
ä¸åŒç‚¹ï¼š
    1ã€waitè°ƒç”¨åä¼šé‡Šæ”¾æ‰é”ï¼Œè€Œsleepä¸ä¼š
    2ã€æ‰€å±çš„ç±»ä¸åŒ
    3ã€è°ƒç”¨æ¡ä»¶ä¸åŒ
## JMM
* ã€å·¥ä½œå†…å­˜ï¼Œä¸»å†…å­˜ã€‘ä¸ã€JVMä¸­æ–¹æ³•åŒºï¼Œæ ˆ..ã€‘æœ‰ä»€ä¹ˆåŒºåˆ«/å…³ç³»ï¼Ÿ
éƒ½æ˜¯å¯¹JVMå†…å­˜çš„çš„åˆ’åˆ†ï¼Œåªä¸è¿‡ç«™å¾—è§’åº¦ä¸åŒ
ä»åŠŸèƒ½ä¸Šåˆ’åˆ†ï¼šæ ¹æ®å†…å­˜åŒºåŸŸåŠŸèƒ½çš„ä¸åŒå¯ä»¥åˆ’åˆ†ä¸ºæ–¹æ³•åŒºï¼Œå †ï¼Œæ ˆç­‰
ä»çº¿ç¨‹çš„è§’åº¦ä¸Šåˆ’åˆ†ï¼šåªæœ‰å·¥ä½œå†…å­˜å’Œä¸»å†…å­˜
å¦‚æœç¡¬è¦ä¸€ä¸€å¯¹åº”ï¼Œæˆ‘è§‰å¾—å·¥ä½œå†…å­˜æœ‰ç‚¹åƒè™šæ‹Ÿæœºæ ˆï¼ˆçº¿ç¨‹ç§æœ‰ï¼‰ï¼Œè€Œæ–¹æ³•åŒºå’Œå †å¯¹åº”ä¸»å†…å­˜ï¼ˆçº¿ç¨‹å…±äº«ï¼‰  
* JMMæ˜¯ä¸€ç»„è§„èŒƒ/é¾Ÿè…š
* JMMè§„å®šï¼ŒJavaä¸­çš„æ‰€æœ‰å˜é‡éƒ½å­˜åœ¨ä¸»å­˜é‡Œï¼›å½“çº¿ç¨‹ä½¿ç”¨æŸä¸ªå˜é‡æ—¶ï¼Œä¼šå…ˆæŠŠè¿™ä¸ªå˜é‡èµ‹å€¼åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜
> å·¥ä½œå†…å­˜=å¯„å­˜å™¨+ç¼“å­˜

```java
public class JMM {
    static int counter = 0;

    public static void main(String[] args) throws InterruptedException {
        for (int i = 0; i < 10; i++){
            new Thread(()->{
                for (int j = 0; j < 10000; j++){
                    counter++;
                }
            }).start();
        }
        Thread.sleep(500);
        System.out.println("counter: "+counter);
    }
}
```
å¦‚ä¸Šä»£ç ï¼Œæˆ‘ä»¬çŸ¥é“å¤šçº¿ç¨‹æ“ä½œå…±äº«å˜é‡ï¼Œå¦‚æœä¸åŠ ä»»ä½•é™åˆ¶ï¼Œç»“æœè‚¯å®šä¼šå‡ºé”™ã€‚
å¦‚ä½•è§£é‡Šå‡ºé”™åŸå› ï¼Ÿ
å‡ºé”™åŸå› å°±æ˜¯JMMï¼›
å› ä¸ºJMMè§„å®šï¼Œåœ¨æ“ä½œå˜é‡ä¹‹å‰ï¼Œè¦æŠŠå˜é‡ä»ä¸»å†…å­˜(è¯¥æƒ…å†µæ˜¯æŒ‡ï¼šå †)å¤åˆ¶åˆ°å·¥ä½œå†…å­˜(çº¿ç¨‹ç§æœ‰çš„è™šæ‹Ÿæœºæ ˆä¸­æ ˆå¸§çš„æ“ä½œæ•°æ ˆä¸­)
æˆ‘æ¥æ¨¡æ‹Ÿä¸€ä¸‹å‡ºé”™åŸå› ï¼š
counterå¤åˆ¶åˆ°çº¿ç¨‹1çš„æ“ä½œæ•°æ ˆä¸­ï¼Œæ­¤æ—¶CPUåˆ‡æ¢çº¿ç¨‹
counterå¤åˆ¶åˆ°çº¿ç¨‹2çš„æ“ä½œæ•°æ ˆä¸­ï¼Œæ­¤æ—¶CPUåˆ‡æ¢çº¿ç¨‹
counterå¤åˆ¶åˆ°çº¿ç¨‹3çš„æ“ä½œæ•°æ ˆä¸­ï¼Œæ­¤æ—¶CPUåˆ‡æ¢çº¿ç¨‹
çº¿ç¨‹1æ‰§è¡Œ+1æ“ä½œ
çº¿ç¨‹2æ‰§è¡Œ+1æ“ä½œ
çº¿ç¨‹3æ‰§è¡Œ+1æ“ä½œ
çº¿ç¨‹1å†™å›counter
çº¿ç¨‹2å†™å›counter
çº¿ç¨‹3å†™å›counter
æ­¤æ—¶çº¿ç¨‹å…±æ‰§è¡Œäº†3æ¬¡+1æ“ä½œï¼Œä½†æ˜¯counterçš„å€¼æ˜¯1
> PSï¼šå…¶å®JMMè¿™ä¸ªè§„å®šï¼Œä»å­—èŠ‚ç ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ã€‚å¦‚ä¸‹å›¾

<img src="./JMM.png">
å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œè¯·çœ‹åŸå­ç±»

## åŸå­ç±»
å¦‚ä¸Šè¿°æ‰€ç¤ºï¼Œæ™®é€šçš„`int counter`åœ¨å¤šçº¿ç¨‹æ‰§è¡Œ`++`æ“ä½œçš„æ—¶å€™ï¼Œå› ä¸ºä¸èƒ½ä¿è¯åŸå­æ€§å¯¼è‡´ç»“æœå‡ºé”™ï¼›å¦‚ä½•è§£å†³è¿™ä¸€é—®é¢˜ï¼Ÿ
å¯ä»¥é€šè¿‡åŸå­ç±»ï¼Œå¦‚ä¸‹é¢ä»£ç æ‰€ç¤º
```java
    static AtomicInteger counter = new AtomicInteger(0);

    public static void main(String[] args) throws InterruptedException {
        for (int i = 0; i < 10; i++){
            new Thread(()->{
                for (int j = 0; j < 10000; j++){
                    counter.incrementAndGet();
                }
            }).start();
        }
        Thread.sleep(500);
        System.out.println("counter: "+counter.toString());
    }
    
}
```
ä¸ºä»€ä¹ˆé€šè¿‡åŸå­ç±»ï¼Œå°±å¯ä»¥ä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œä»è€Œå¾—åˆ°æ­£ç¡®çš„ç»“æœï¼Ÿ
æ¢å¥è¯è¯´ï¼ŒåŸå­ç±»ä¸­çš„++ï¼Œå®ƒä¹‹æ‰€ä»¥å®‰å…¨çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ
è¯·çœ‹ä¸‹èŠ‚ï¼šCAS
## CAS
<img src="./CAS.png">

* åŸå­ç±»ä¸­çš„CASæ¯”ç›´æ¥`counter++`å¥½åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ
ä¸»è¦æ˜¯å¥½åœ¨æœ€åä¸€æ­¥ï¼šCASå¹¶ä¸ä¼šç›´æ¥æŠŠå€¼å†™å›ï¼Œè€Œæ˜¯è¿›è¡ŒCAS(compare and swap)
1.å¦‚æœä¸»å†…å­˜ä¸­çš„å€¼ä¸å·¥ä½œå†…å­˜ä¸­çš„old valueç›¸åŒï¼Œå°±ç›´æ¥å†™å›ã€‚å› ä¸ºç›¸åŒä»£è¡¨æ²¡æœ‰çº¿ç¨‹åŠ¨è¿‡ä¸»å†…å­˜ä¸­çš„å€¼
2.å¦‚æœä¸ç›¸åŒï¼Œå°±æŠŠä¸»å†…å­˜ä¸­çš„å€¼å–è¿‡æ¥ï¼Œé‡æ–°æ‰§è¡Œ`++`æ“ä½œ(è‡ªæ—‹)
> ps:CAS(compare and swap)æ“ä½œæ˜¯åŸå­æ“ä½œï¼šæ„å‘³ç€åŒä¸€æ—¶åˆ»ï¼Œåªä¼šæœ‰ä¸€ä¸ªcasæ–¹æ³•åœ¨è¿è¡Œ

* ä»€ä¹ˆæ˜¯CAS
åœ¨Javaå±‚é¢æ˜¯ä¸€ä¸ªåŸå­æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œè¿™ä¸ªæ–¹æ³•çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä¿è¯å…¶ä»–çº¿ç¨‹è¿›ä¸æ¥ï¼›
è¿™ä¸ªæ–¹æ³•çš„å†…å®¹æ˜¯ï¼šæ‹¿ç€è‡ªå·±çš„æœŸå¾…å€¼expectå’Œå†…å­˜ä¸­çš„å€¼æ¯”è¾ƒä¸€ä¸‹ï¼Œå¦‚æœç›¸ç­‰å°±æ›´æ–°å†…å­˜ã€‚ä¸ç›¸ç­‰å°±è‡ªæ—‹
* ä¸ºä»€ä¹ˆéœ€è¦casï¼Ÿ
casæ˜¯ä¸€ç§æ— é”ç®—æ³•ï¼Œä½¿ç”¨synchronizedä¿è¯æ•°æ®ä¸€è‡´æ€§æ•ˆç‡ä¸é«˜ï¼›ä½¿ç”¨casæ˜¯å¯¹synchronizedçš„ä¸€ç§ä»£æ›¿ï¼Œç›®çš„æ˜¯æé«˜æ•ˆç‡
> casä¸ºä»€ä¹ˆæ¯”é”é«˜æ•ˆï¼Ÿ
ä»jvmå†…å­˜å¸ƒå±€ä¸Šæƒ³è±¡ï¼š
é”ï¼šå¦‚æœä¸€æ—¦åŠ é”ï¼Œå–å€¼-è¿ç®—-æ”¾å›å€¼ï¼Œå®Œå…¨ä¸²è¡ŒåŒ–
casï¼šå–å€¼ï¼šä½ å–ä½ çš„ï¼Œæˆ‘å–æˆ‘çš„ï¼›è¿ç®—ï¼šä½ ç®—ä½ çš„ï¼Œæˆ‘ç®—æˆ‘çš„ï¼›æœ€åä¸€æ­¥æ”¾å›å€¼ï¼šéœ€è¦è¿›è¡Œæ¯”è¾ƒä¸€ä¸‹
* casçš„ä½¿ç”¨
åœ¨å¹¶å‘åœºæ™¯ä¸‹å¯¹åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œæ“ä½œæ—¶ï¼Œé€šå¸¸ä¸ä½¿ç”¨synchronizedï¼Œè€Œä½¿ç”¨åŸºäºcasçš„åŸå­ç±»
* casçš„ç¼ºç‚¹
1ã€å¦‚æœå¹¶å‘å†²çªæ¯”è¾ƒå¤šï¼Œæˆ‘è®¤ä¸ºcasæ•ˆç‡æ¯”è¾ƒä½ã€‚å› ä¸ºæ¯æ¬¡åœ¨å†™å›å€¼å¾—æ—¶å€™å‘ç°å…±äº«å˜é‡å·²ç»è¢«æ”¹äº†ï¼Œé‚£å°±éœ€è¦æŠ›å¼ƒå‰é¢è¾›è‹¦ç®—æ¥å¾—ç»“æœä»æ–°æ¥è¿‡
2ã€abaé—®é¢˜
* ABAé—®é¢˜
çº¿ç¨‹1åœ¨å†™å›ä¹‹å‰è¦çœ‹ä¸€ä¸‹å…±äº«å˜é‡æœ‰æ²¡æœ‰è¢«æ”¹è¿‡ï¼Œå³é€šè¿‡å•ä¸ªå€¼æ˜¯å¦æ”¹å˜æ¥åˆ¤æ–­è¿™ä¸ªå˜é‡æœ‰æ²¡æœ‰è¢«åŠ¨è¿‡ï¼Œå…¶å®è¿™æ˜¯æœ‰é—®é¢˜çš„ã€‚å³ä½¿å€¼è¿˜æ˜¯é‚£ä¸ªå€¼ï¼Œä½†å¯èƒ½åœ¨æ­¤ä¹‹å‰çº¿ç¨‹äºŒå·²ç»æŠŠè¿™ä¸ªå€¼ç»™æ”¹äº†ï¼Œåªä¸è¿‡åé¢åˆæ”¹å›æ¥äº†ã€‚
ä½¿ç”¨automicStampledReferenceå’Œæ­£ç¡®çš„ç¼–ç æ–¹å¼æ¥è§£å†³abaé—®é¢˜
> todo:ABAé—®é¢˜æœ‰ä»€ä¹ˆåå¤„ï¼Ÿ

## é”
å¦‚ä¸Šæ‰€è¿°ï¼Œå¤šçº¿ç¨‹è®¿é—®å…±äº«å˜é‡ï¼Œå¦‚æœä¸åŠ ä»»ä½•æªæ–½ï¼Œæ˜¯ä¼šå‡ºç°è¿ç®—é”™è¯¯çš„ï¼›
ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œé™¤äº†ä½¿ç”¨åŸºäºCASçš„åŸå­ç±»å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é”
### synchronizedé”
å…¶å®synchronizedé”åŸç†å¾ˆç®€å•ï¼Œå½“æŸä¸ªçº¿ç¨‹åœ¨è®¿é—®ä¸»å†…å­˜å‰ï¼Œéœ€è¦å»â€˜æŠ¢é”â€™ï¼Œå¦‚æœèƒ½æŠ¢åˆ°ï¼šå°±æ‰§è¡Œ1ã€å¤åˆ¶åˆ°å·¥ä½œå†…å­˜2ã€æ•°æ®å¤„ç†3ã€å†™å›å†…å­˜4ã€é‡Šæ”¾é”
å¯ä»¥çœ‹å‡ºé”çš„ä½œç”¨å°±æ˜¯é™åˆ¶**æœ‰ä¸”åªæœ‰ä¸€ä¸ªçº¿ç¨‹**åœ¨è¿›è¡Œæ•°æ®æ“ä½œ

#### synchronizedé”å‡çº§
åœ¨JDK1.6ä¹‹å‰ï¼Œsynchronizedé”æ˜¯é‡é‡çº§é”
å¦‚ä¸Šæ‰€è¿°ï¼Œå¦‚æœçº¿ç¨‹æŠ¢åˆ°äº†é”ï¼Œå°±ä¼šç»§ç»­æ‰§è¡Œæ¥ä¸‹æ¥çš„æ“ä½œï¼›é‚£å¯¹äºé‚£äº›æ²¡æœ‰æŠ¢åˆ°é”çš„çº¿ç¨‹ï¼Œå®ƒä»¬åº”è¯¥åšäº›ä»€ä¹ˆï¼Ÿ
é‡é‡çº§çš„æ„æ€æ—¶ï¼šå¦‚æœçº¿ç¨‹æ²¡æœ‰æŠ¢åˆ°é”ï¼Œåˆ™çº¿ç¨‹ç›´æ¥æŒ‚èµ·ï¼ˆparkï¼‰ï¼Œå°†CPUç§»å¼€åˆ°å…¶ä»–çº¿ç¨‹ï¼ˆå¯ä»¥åœ¨å¤´è„‘ä¸­ç›´æ¥å°†ä»£è¡¨è¯¥çº¿ç¨‹çš„æ–¹æ¡† ç½®ä¸ºç°è‰²ï¼‰
è¿™æ„å‘³ç€æ¶‰åŠåˆ°ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆç”±æ“ä½œç³»ç»Ÿå®Œæˆï¼Œå„ç§å¯„å­˜å™¨å€¼çš„ä¿å­˜...)
æ„å‘³ç€æ•ˆç‡å¾ˆä½

åœ¨JDK1.6ä¹‹åï¼Œsynchronizedé”ä¼šç»å†ä¸€ä¸ªè¢«ç§°ä¸ºé”å‡çº§çš„è¿‡ç¨‹
åå‘é”ï¼šå½“ç³»ç»Ÿä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œçº¿ç¨‹çœ‹ä¸€ä¸‹é”å¯¹è±¡ä¸­çš„æŸä¸ªå±æ€§ï¼Œå¦‚æœæ˜¯è‡ªå·±ï¼Œç›´æ¥æ‰§è¡Œä»£ç 
è½»é‡çº§é”ï¼šå¦‚æœç¬¬äºŒä¸ªçº¿ç¨‹æ¥äº†ï¼Œå‘ç°é”çš„æ‹¥æœ‰è€…ä¸æ˜¯è‡ªå·±ï¼Œåˆ™ç«‹åˆ»æ‰§è¡ŒCASæ“ä½œè¿›è¡ŒæŠ¢å é”
é‡é‡çº§é”ï¼šå¦‚æœç¬¬ä¸€æ¬¡CASæ“ä½œæŠ¢å å¤±è´¥ï¼Œåˆ™é”å‡çº§ä¸ºé‡é‡çº§é”ï¼šåœ¨é‡é‡çº§é”ä¸­ï¼Œè¯¥çº¿ç¨‹ä¼šè‡ªæ—‹å‡ æ¬¡æ‰§è¡ŒCASæ“ä½œï¼Œå¦‚æœéƒ½æŠ¢ä¸åˆ°é”ï¼Œåˆ™parkæ‰åŠ å…¥é˜Ÿåˆ—
å½“é‡Šæ”¾é”çš„æ—¶å€™ï¼Œä¼šå”¤é†’parkæ‰çš„çº¿ç¨‹ï¼Œè®©å®ƒé‡æ–°ç«äº‰é”ï¼›ä½†æ˜¯ä¸ä¿è¯è¿™ä¸ªçº¿ç¨‹ä¸€å®šèƒ½æŠ¢åˆ°é”ï¼Œå¦‚æœæŠ¢ä¸åˆ°ï¼Œç»§ç»­park
> æ‰€ä»¥synchronizedé”æ˜¯éå…¬å¹³é”

#### æ‚²è§‚é” vs ä¹è§‚é”
æ‚²è§‚é”orä¹è§‚é”æ˜¯é”è¿™ä¸€ä¸ªæ¦‚å¿µçš„å®ç°æ–¹å¼
æ‚²è§‚é”ï¼šåœ¨è®¿é—®å…±äº«å˜é‡ä¹‹å‰å°è¯•åŠ é”ï¼Œé˜²æ­¢å…¶ä»–çº¿ç¨‹è®¿é—®
ä¹è§‚é”ï¼šé€šè¿‡CASçš„æ–¹å¼æ¥åˆ¤è¯»å½“å‰çº¿ç¨‹èƒ½å¦è®¿é—®å…±äº«å˜é‡

### Lockæ¥å£

Lockæ¥å£å®ç°çš„é”ä¸synchronizedä¹‹é—´çš„åŒºåˆ«
1ã€ä½¿ç”¨Locké”æ—¶ï¼Œunlockæ–¹æ³•ä¸€å®šè¦å†™åœ¨finallyé‡Œé¢
è¿™æ˜¯å› ä¸ºå½“å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™ï¼Œsynchronizedé”é»˜è®¤ä¼šé‡Šæ”¾é”ï¼Œè€ŒLocké”å´ä¸ä¼šï¼Œå¦‚æœLocké”çš„unlockæ–¹æ³•ä¸å†™åœ¨finallyé‡Œï¼Œå¯èƒ½ä¼šæ­»é”
#### ReentrantLock

##### å…¬å¹³é” vs éå…¬å¹³é”
ReentrantLockåœ¨åˆ›å»ºçš„æ—¶å€™å¯ä»¥å£°æ˜ä¸ºå…¬å¹³é”æˆ–è€…éå…¬å¹³é”
é€šè¿‡ä¸‹å›¾é˜…è¯»æºç ï¼š
å…¬å¹³é”ï¼šçº¿ç¨‹åœ¨æŠ¢é”çš„æ—¶å€™é¦–å…ˆä¼šçœ‹ä¸€çœ‹ä»¥å‰æœ‰æ²¡æœ‰çº¿ç¨‹æŠ¢é”ï¼ˆé˜Ÿåˆ—ä¸­æœ‰æ²¡æœ‰çº¿ç¨‹ï¼‰
éå…¬å¹³é”ï¼šçº¿ç¨‹ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ç›´æ¥æŠ¢é”

éå…¬å¹³é”ä¼šå¯¼è‡´çº¿ç¨‹é¥¥é¥¿é—®é¢˜ï¼šå³å¯èƒ½ä¼šå‘ç”ŸæŸä¸ªçº¿ç¨‹ä¸€ç›´æŠ¢åˆ°é”çš„æƒ…å†µ

<img src="./Fair and unFair.png">

#### ReentrantLockä¸ºä»€ä¹ˆæ˜¯å¯é‡å…¥é”
å¯é‡å…¥é”æ˜¯æŒ‡ï¼šé”ä¸­å¥—é”ã€‚å¦‚ä¸‹å›¾ï¼š
<img src="./what is reentrant.png">
ReentrantLockä¹‹æ‰€ä»¥æ˜¯å¯é‡å…¥çš„åŸå› ï¼š
<img src="./why ReentrantLock is a reentrant lock.png">

> ps:Synchronizedé”ä¹Ÿæ˜¯å¯é‡å…¥é”ï¼šå¦‚ä¸‹å›¾
<img src="./synchronized is reentrant.png">

### ReentrantReadWriteLock
å¯é‡å…¥è¯»å†™é”ï¼šä¸€ä¸ªèµ„æºèƒ½å¤Ÿè¢«å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œæˆ–è€…è¢«ä¸€ä¸ªå†™çº¿ç¨‹è®¿é—®ï¼›ä½†æ˜¯ä¸èƒ½åŒæ—¶å­˜åœ¨è¯»å†™çº¿ç¨‹

> PSï¼šReentrantReadWriteLockéå¸¸é€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼šä¼šæ¯”å…¶ä»–çš„é”æ›´å¿«
#### äº’æ–¥é” vs å…±äº«é”
åƒsynchronizedï¼ŒReentrantLockï¼šåœ¨è®¿é—®å…±äº«èµ„æºçš„æ—¶å€™é¦–å…ˆè¦ä¸Šé”ã€‚åŒä¸€ä¸ªèµ„æºæ°¸è¿œåªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼›è€ŒReentrantReadWriteLockåœ¨è¯»æ“ä½œä¸Šè¿›è¡Œäº†ä¼˜åŒ–ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»ã€‚æ‰€ä»¥ReentrantReadWriteLockæ˜¯ä¸€ç§å…±äº«é”
#### å†™çº¿ç¨‹é¥¥é¥¿é—®é¢˜
ReentrantReadWriteLockæ˜¯è¯»è¯»å…±äº«ï¼Œè¯»å†™äº’æ–¥
å³åœ¨è¯»çº¿ç¨‹å®Œæˆä¹‹å‰ï¼Œæ˜¯ä¸å…è®¸å†™çº¿ç¨‹æ‰§è¡Œçš„


* `Thread.sleep()`ä¸`TimeUnit.SECONDS.sleep()`çš„åŒºåˆ«ï¼Ÿ
åŠŸèƒ½å®Œå…¨ä¸€æ ·ï¼Œåªä¸è¿‡`TimeUnit.SECONDS.sleep()`å¯è¯»æ€§æ›´å¥½
```java
Thread.sleep(4*60*1000);//èƒ½çœ‹å‡ºæ¥4åˆ†é’Ÿå—ï¼Ÿ
TimeUnit.MINUTES.sleep(4);//æ˜¯ä¸æ˜¯æ›´å¥½è¯»ï¼Ÿ
```
* CompletableFuture
    * ä½¿ç”¨èƒŒæ™¯
    FutureTaskä¸­çš„Futureæ¥å£æœ‰ä¸€äº›ç¼ºç‚¹ï¼šCPUèµ„æºè¢«æµªè´¹
    å¦‚æœæœ‰ä¸¤ä¸ªä»»åŠ¡ï¼Œå…¶ä¸­ä»»åŠ¡äºŒéœ€è¦ä»»åŠ¡ä¸€çš„ç»“æœæ‰èƒ½æ‰§è¡Œã€‚æŠŠä»»åŠ¡ä¸€äº¤ç»™ä¸€ä¸ªçº¿ç¨‹ï¼Œä»»åŠ¡äºŒå¦‚æœåœ¨ä¸»çº¿ç¨‹ï¼Œå°±è¦åŸåœ°ç­‰å¾…äº†ã€‚
    ```java
    //1ã€get()æ–¹æ³•ï¼šå¦‚æœçº¿ç¨‹æ²¡æœ‰æ‰§è¡Œç»“æŸï¼Œmainçº¿ç¨‹ç›´æ¥é˜»å¡ï¼ˆWaitingçŠ¶æ€ï¼‰
    public static void main(String[] args) throws ExecutionException, InterruptedException {
        FutureTask<String> task1 = new FutureTask<>(new MyCallable());
        Thread t1 = new Thread(task1);
        t1.start();
        String res = task1.get(); 
    } 
    //2.è½®è½¬ï¼Œæµªè´¹CPU
    FutureTask<String> task1 = new FutureTask<>(new MyCallable());
    Thread t1 = new Thread(task1,"t1");
    t1.start();
    String res;
    while(true){
        if (task1.isDone()){
            res = task1.get();
            break;
        }
    }
    ```
    * CompletableFuture thenaccept ä¸thenacceptasyncåŒºåˆ«ï¼Ÿ
    thread1è¿è¡ŒCompletableFutureä¸­çš„runæ–¹æ³•ï¼Œå¦‚æœä½¿ç”¨thenacceptä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆç­‰runæ–¹æ³•è¿è¡Œç»“æŸåï¼Œä»ç„¶ç”±thread1æ¥æ‰§è¡Œè¯¥å‡½æ•°ï¼›
    å¦‚æœä½¿ç”¨thenacceptasyncï¼Œé‚£ä¹ˆç”±thread1è°ƒç”¨çº¿ç¨‹æ± ï¼Œåœ¨å¼€ä¸€ä¸ªæ–°çš„çº¿ç¨‹thread2æ¥è¿è¡Œè¯¥å‡½æ•°
    * ä½¿ç”¨
    ```java
    //ç›´æ¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å¯åŠ¨ï¼Œæ²¡æœ‰è¿”å›å€¼
    public static void main(String[] args) {
        ExecutorService executorService = Executors.newFixedThreadPool(3);

        CompletableFuture.runAsync(()->{
            String name = Thread.currentThread().getName();
            System.out.println(name);
        }ï¼ŒexecutorService);

        executorService.shutdown();
    }
    //æœ‰è¿”å›å€¼çš„çº¿ç¨‹ï¼Œå¯åŠ¨
    public static void main(String[] args) throws InterruptedException {
        CompletableFuture.supplyAsync(()->{
            String name = Thread.currentThread().getName();
            System.out.println(name);
            return "task over";
        });
        TimeUnit.SECONDS.sleep(1);//æ³¨æ„ï¼šå¦‚æœä¸»çº¿ç¨‹æå‰ç»“æŸäº†ï¼Œé‚£CompletableFutureä½¿ç”¨çš„é»˜è®¤çº¿ç¨‹æ± å°†ä¼šè¢«å…³é—­ï¼Œå³çº¿ç¨‹ä»»åŠ¡ä¸ä¼šè¢«æ‰§è¡Œå®Œ
    }
    //å›è°ƒå‡½æ•°ï¼Œç”¨ä»¥å¾€çš„çº¿ç¨‹æ± æ˜¯å®ç°ä¸äº†çš„
    static int a = 0;
    public static void main(String[] args) {
        CompletableFuture<Void> completableFuture = CompletableFuture.runAsync(() -> {
            System.out.println("thread begin");
            for (int i = 0; i < 10000; i++) a++;
            System.out.println("thread end");
        });
        completableFuture.whenComplete((v,e)->{
            System.out.println("callback begin");
            System.out.println(a);
            System.out.println("callback end");
        });
    }
    Qï¼šcallbackå‡½æ•°ç”±è°æ‰§è¡Œ?
    å¦‚æœè®¾ç½®callbackçš„æ—¶å€™çº¿ç¨‹ä»»åŠ¡å·²ç»æ‰§è¡Œç»“æŸï¼Œåˆ™ç”±mainçº¿ç¨‹æ‰§è¡Œï¼›
    å¦‚æœçº¿ç¨‹ä»»åŠ¡è¿˜æ²¡ç»“æŸï¼Œåˆ™ç”±çº¿ç¨‹æ‰§è¡Œ
    ```
    * çº¿ç¨‹ä¸²è¡ŒåŒ–
    ```
    ä»»åŠ¡A-ä»»åŠ¡B
    //å¦‚æœä»»åŠ¡Bä¸éœ€è¦ä»»åŠ¡Açš„ç»“æœï¼Œç”¨thenRun
    //å¦‚æœä»»åŠ¡Béœ€è¦ä»»åŠ¡Açš„ç»“æœï¼Œç”¨thenAccpet
    //å¦‚æœä»»åŠ¡Béœ€è¦ä»»åŠ¡Açš„ç»“æœï¼Œå¹¶ä¸”è¿˜éœ€è¦å°†ç»“æœä¼ ç»™ä¸‹ä¸€ä¸ªï¼Œç”¨thenApply 

    ```
    * ä¸¤ä»»åŠ¡ç»„åˆï¼šéƒ½è¦å®Œæˆ
    ```
    //thenCombine
    //thenAcceptBoth
    //runAfterBoth
    ```
    * ä¸¤ä»»åŠ¡ç»„åˆï¼šå®Œæˆä¸€ä¸ªå³å¯
    ```
    //applyToEither
    //acceptEither
    //runAfterEither
    ```
    * å¤šä»»åŠ¡ç»„åˆ
    ```
    //static allOf ï¼šåªæœ‰ä¼ å…¥çš„completableFutureå…¨éƒ¨å®Œæˆå
    //static anyofï¼š åªè¦æœ‰ä¸€ä¸ªcompletableFutureå®Œæˆå³å¯
    ```
    2ã€isDone()æ–¹æ³•ï¼š
    * CompletableFutureä¸­é—´è¿‡ç¨‹çš„æ–¹æ³•
        * thenApply(Function)
        å‚æ•°æ˜¯ä¸€ä¸ªfunctionï¼Œè¾“å…¥å¹¶è¿”å›
        * thenAccept(Consumer)
        å‚æ•°æ˜¯ä¸€ä¸ªConsumerï¼Œåªèƒ½è¾“å…¥ï¼Œä¸èƒ½è¿”å›å€¼
## å®ˆæŠ¤çº¿ç¨‹
* [ã€ŠJavaå¹¶å‘ç¼–ç¨‹æ·±åº¦è§£æä¸å®æˆ˜ã€‹-1.10 å®ˆæŠ¤çº¿ç¨‹]()
## ThreadLocal
* ä½¿ç”¨
```java
//æ¯ä¸ªçº¿ç¨‹å¾€threadLocalé‡Œsetå€¼æ—¶ï¼Œåªæœ‰è‡ªå·±å¯è§
static ThreadLocal<String> tl = new ThreadLocal<>();
public static void main(String[] args) {
    tl.set("main thread");
    new Thread(()->{
        String s = tl.get(); //null
        System.out.println(s);
        tl.set("t1");
    },"t1").start();
    String s = tl.get();//è‡ªå·±setå¾—"main thread"
    System.out.println(s);
}
```
* åŸç†
<img src="./ThreadLocal1.png">
* ä¸ºä»€ä¹ˆThreadLocalMapä¸­çš„keyè¦è®¾è®¡ä¸ºä¸€ä¸ªå¼±å¼•ç”¨ï¼Ÿ
å¦‚ä¸‹å›¾ï¼Œå½“å³è¾¹çš„å¼ºå¼•ç”¨æ¶ˆå¤±åï¼ˆå¯èƒ½æ˜¯æ–¹æ³•é€€å‡ºï¼Œæˆ–è€…æ‰‹åŠ¨è®¾ç½®nullï¼‰ï¼ŒThreadLocalæ‰€å å†…å­˜å°±å¯ä»¥è¢«å›æ”¶äº†ï¼Œç´§æ¥ç€ThreadLocalMapé‡Œé¢çš„replaceStaleEntryæ–¹æ³•ä¹Ÿå¯ä»¥å›æ”¶å†…å­˜ã€‚
å¦‚æœä½¿ç”¨å¼ºå¼•ç”¨ï¼Œè¿™äº›å†…å­˜å°±æ°¸è¿œä¸ä¼šè¢«å›æ”¶ï¼Œé€ æˆå†…å­˜æ³„æ¼
<img src="./ThreadLocal1.png">
* ä¸ºä»€ä¹ˆThreadLocalä½¿ç”¨å®Œåè¦removeï¼Ÿ
å°½ç®¡ThreadLocalæä¾›replaceStaleEntryæ–¹æ³•æ¥å›æ”¶mapå†…å­˜ï¼Œä½†è¿™åªåœ¨setæ–¹æ³•æ‰§è¡Œæ—¶æ‰§è¡Œã€‚å¦‚æœåªæ˜¯ç”¨ä¸€æ¬¡setæ–¹æ³•ï¼ŒThreadLocalåˆè¢«å›æ”¶äº†ï¼Œé‚£åœ¨**ç¬¬äºŒæ¬¡setæ–¹æ³•æ‰§è¡Œå‰**ï¼Œvalueæ‰€å¼•ç”¨çš„å¾ˆå¤§ä¸€å—å†…å­˜æ˜¯ä¸èƒ½è¢«å›æ”¶çš„ã€‚
<img src="./ThreadLocal2.png">
* ä½¿ç”¨èƒŒæ™¯
ä¸šåŠ¡éœ€æ±‚ï¼š
```java
/*
    1æ­£å¸¸å®Œæˆï¼Œ
    ä½†ç”±äºä¸‹é¢çš„ä»£ç å‘ç”Ÿå¼‚å¸¸ï¼Œå¯¼è‡´2æ²¡æœ‰æ‰§è¡Œå°±ç›´æ¥æ¨å‡ºäº†
    è¿™æ—¶å€™æ•°æ®åº“é‡Œå°±åªæœ‰ä¸€ä¸ªè®¢å•å·ï¼Œæ²¡æœ‰è¿™ä¸ªè®¢å•åˆ°åº•ä¹°äº†ä»€ä¹ˆä¸œè¥¿
    è¿™æ—¶æ€ä¹ˆåŠï¼Ÿ
*/
public void LoginService(){
    1ã€æ’å…¥è®¢å•
    å°è£…ä¸€äº›æ•°æ®å¯¹è±¡
    æ•°æ®åº“æ“ä½œ

    æŸäº›ä»£ç ï¼Œä¼šæŠ›å¼‚å¸¸

    2ã€æ’å…¥è®¢å•è¯¦æƒ…
    å°è£…ä¸€äº›æ•°æ®å¯¹è±¡
    æ•°æ®åº“æ“ä½œ
}
```
# è®¾è®¡æ¨¡å¼
* å¼€é—­åŸåˆ™ï¼ˆopen-closeed principleï¼‰
    * èƒŒæ™¯
    è½¯ä»¶çš„è®¾è®¡ä¸å¯èƒ½ä¸€å¼€å§‹å°±è®¾è®¡å¥½äº†ï¼Œè‚¯å®šä¼šä¸æ–­è¿­ä»£å¢åŠ æ–°åŠŸèƒ½ã€‚é‚£è¯¥å¦‚ä½•è®¾è®¡æ‰èƒ½åœ¨è¿­ä»£çš„æ—¶å€™ä¸æŠŠæ•´ä¸ªè½¯ä»¶è®¾è®¡æ¨å¯¼é‡æ¥å‘¢ï¼Ÿ
    * ç†è§£
    å¼€ï¼šå¯ä»¥æ‰©å±•ï¼›é—­ï¼šä½†ä¸èƒ½ä¿®æ”¹
    more specificï¼šåœ¨å†™ç±»çš„æ—¶å€™ï¼Œå°½å¯èƒ½è®©ç±»è¶³å¤Ÿå¥½ï¼Œå†™å¥½å°±ä¸éœ€è¦ä¿®æ”¹äº†ã€‚å¦‚æœæ–°éœ€æ±‚æ¥äº†ï¼Œæˆ‘ä»¬å¢åŠ ä¸€äº›ç±»å°±å®Œäº‹äº†ï¼Œè€Œä¸æ˜¯å»ä¿®æ”¹åŸæ¥çš„ç±»ã€‚
    i.e.é¢å¯¹éœ€æ±‚ï¼Œæˆ‘ä»¬æ˜¯å¢åŠ ä»£ç ï¼Œè€Œä¸æ˜¯ä¿®æ”¹ç±»ã€‚è¿™å°±æ˜¯å¼€é—­åŸåˆ™
* ä¾èµ–å€’è½¬åŸåˆ™
é¢å‘æ¥å£ç¼–ç¨‹
## å•ä¾‹æ¨¡å¼
* ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Ÿ
å¦‚æœæˆ‘åªæƒ³è®©æ•´ä¸ªç³»ç»Ÿä¸­åªå­˜åœ¨ä¸€ä¸ªç±»çš„å®ä¾‹ï¼ˆè¿™ä¸ªç±»çš„å®ä¾‹åŒ–å¾ˆæµªè´¹èµ„æºï¼‰ï¼Œä¸èƒ½è¯´é€šè¿‡äººçš„è‡ªè§‰æ€§åœ¨æ•´ä¸ªç¨‹åºä¸­åªnewä¸€æ¬¡...è¿™æ ·æ˜¯ä¸é è°±çš„ï¼›
é€šè¿‡å†™å•ä¾‹ï¼Œå¯ä»¥å°†ç±»çš„å®ä¾‹çš„åˆ›å»ºæ–¹å¼å†™æ­»
* åœ¨å•ä¾‹çš„ä»£ç ä¸­ä¸ºä»€ä¹ˆè¦å°†`instance`è®¾æˆprivate? å°è£…æ€§ï¼Œé˜²æ­¢å¤–éƒ¨éšä¾¿æ”¹è¿™ä¸ªå±æ€§
é¥¿æ±‰å¼:
```java
//é¥¿æ±‰å¼
class Order{
    private Order(){

    }

    private static Order instance = new Order();

    public static Order getInstance(){
        return instance;
    }

}
```
æ‡’æ±‰å¼ï¼š
```java
//æ‡’æ±‰å¼
class User{
    private User(){

    }
    private static User instance = null;
    public static User getInstance(){
        if (instance == null) instance = new User();
        return instance;
    }

}
```
> æ‡’æ±‰å¼æ¯”é¥¿æ±‰å¼èŠ‚çœå†…å­˜ï¼Œä½†å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šçº¿ç¨‹ä¸å®‰å…¨
æˆ‘è®¤ä¸ºåªè¦å­˜åœ¨ifè¯­å¥ï¼Œéƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼›åŸå› æ˜¯å¦‚æœåˆšåˆ¤æ–­å®Œifè¯­å¥ï¼ŒCPUæŒªèµ°äº†ï¼Œæ‰§è¡Œå¦ä¸€ä¸ªçº¿ç¨‹çš„ifè¯­å¥ï¼Œç»“æœå¯¼è‡´ä¸¤ä¸ªçº¿ç¨‹éƒ½è¿›å…¥äº†ifè¯­å¥å†…ï¼Œç»“æœæ˜¯åœ¨å†…å­˜ä¸­åˆ›å»ºäº†ä¸¤ä¸ªå®ä¾‹
æ‡’æ±‰å¼çº¿ç¨‹æ”¹è¿›
```java
//æ‡’æ±‰å¼ çº¿ç¨‹æ”¹è¿›
class User{
    private User(){

    }
    private static User instance = null;
//æ•ˆç‡ä½
//    public synchronized static User getInstance(){
//        if (instance == null) instance = new User();
//        return instance;
//    }
//æ•ˆç‡ä½åœ¨å“ªï¼Ÿ
//æ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œéƒ½è¦æŠ¢é”ï¼ŒæŠ¢é”å°±æ¶‰åŠåˆ°æ€§èƒ½é—®é¢˜
//ä¸‹é¢è¿™ç§å†™æ³•ï¼šåªæœ‰åœ¨åˆšå¼€å§‹çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæŠ¢é”ï¼ˆâ‰ˆä¸Šé¢çš„æ•ˆç‡ï¼‰ï¼Œä½†æ˜¯è¿è¡Œä¸€æ®µæ—¶å€™åï¼Œæ•ˆç‡>ä¸Šé¢çš„å†™æ³•ï¼ˆä¸æ¶‰åŠåˆ°æŠ¢é”çš„é—®é¢˜äº†ï¼‰
    public static User getInstance(){
        if (instance == null){
            synchronized (User.class){
                //å¿…é¡»åŠ ä¸Šifåˆ¤æ–­è¯­å¥ï¼Œå¦åˆ™çº¿ç¨‹ä¸å®‰å…¨
                //åŸå› ï¼šå¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹éƒ½è¿›å…¥ifè¯­å¥äº†ï¼Œå¦‚æœä¸åˆ¤æ–­ä¸€ä¸‹ï¼Œå°±ä¸æ˜¯å•ä¾‹äº†
                if (instance == null) instance = new User();
            }
        }
        return instance;
    }
}
```
* åŒºåˆ†æ‡’æ±‰å¼å’Œé¥¿æ±‰å¼ï¼šå•¥æ—¶å€™ç”¨å•¥æ—¶å€™é€ å¯¹è±¡-æ‡’æ±‰å¼
* æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼
ä¸€ä¸ªå‡½æ•°`calculateRuntime`ä¸­å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯ç¡®å®šçš„ï¼Œä½†æœ‰ä¸€å°éƒ¨åˆ†`code()`æ˜¯ä¸ç¡®å®šçš„ï¼›äºæ˜¯å°±å°†ä¸ç¡®å®šçš„ä»£ç æŠ½å‡ºæ¥æˆä¸ºä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œäº¤ç»™å­ç±»è¿›è¡Œå…·ä½“çš„å®ç°ã€‚å­ç±»å®ç°åï¼Œå°±å¯ä»¥ç›´æ¥è°ƒç”¨ä»çˆ¶ç±»ç»§æ‰¿è¿‡æ¥çš„æ–¹æ³•å®ŒæˆåŠŸèƒ½
* å·¥å‚æ¨¡å¼ï¼š[click to check detail](#factory)
* ä»£ç†æ¨¡å¼
ä»£ç†æ¨¡å¼ç»™æˆ‘çš„æ„Ÿè§‰å°±æ˜¯åœ¨æ–¹æ³•çš„å¤–é¢åˆåŒ…ä¸Šä¸€å±‚é€»è¾‘
    * é™æ€ä»£ç†
    ```java
    //Personç±»
    public class Person implements MyInterface{
        @Override
        public void method() {
            System.out.println("è¿™æ˜¯è£¸çš„methodæ–¹æ³•");
        }
    }
    //PersonProxy
    class PersonProxy implements MyInterface{
        private Person person;

        public PersonProxy(Person person) {
            this.person = person;
        }
        @Override
        public void method() {
            System.out.println("è¿™æ˜¯åœ¨è£¸çš„ä»£ç å‰åŠ å…¥çš„ä¸€äº›æ–¹æ³•");
            person.method();
            System.out.println("è¿™æ˜¯åœ¨è£¸çš„ä»£ç ååŠ å…¥çš„ä¸€äº›æ–¹æ³•");
        }
    }
    //main
    public static void main(String[] args) {
        Person person = new Person();
        PersonProxy personProxy = new PersonProxy(person);
        personProxy.method();
    }
    ```
    * åŠ¨æ€ä»£ç†
    å¦‚æœæˆ‘æƒ³å¯¹æ‰€æœ‰æ¥å£ä¸­çš„æ–¹æ³•éƒ½å¢åŠ ç›¸åŒçš„æ“ä½œï¼Œè¿™æ ·å°±å¾—æ¯ä¸€ä¸ªæ¥å£å†™ä¸€ä¸ªProxyã€‚äºæ˜¯å°†ä»£ç†å†æ¬¡æŠ½è±¡ä¸€ä¸ªç»´åº¦ï¼Œå°±æœ‰äº†åŸºäºåå°„å®ç°çš„åŠ¨æ€ä»£ç†
    ```java
    //InvocatoinHandler
    class MyInvocationHandler implements InvocationHandler{
        private Object object;

        public MyInvocationHandler(Object object) {
            this.object = object;
        }

        @Override
        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
            System.out.println("before");
            Object res = method.invoke(object, args);
            System.out.println("after");
            return  res;
        }
    }
    //main
    public static void main(String[] args) {
        Person person = new Person();
        Class<?>[] interfaces = Person.class.getInterfaces();
        InvocationHandler myinvo = new MyInvocationHandler(person);
        MyInterface personProxy = (MyInterface) Proxy.newProxyInstance(ProxyTest.class.getClassLoader(), interfaces, myinvo);
        personProxy.method2();
    }
    ```
* facade pattern
å¯¹å·²ç»å­˜åœ¨çš„serviceç±»è¿›è¡Œå†ä¸€æ¬¡å°è£…ã€‚
* è§‚å¯Ÿè€…æ¨¡å¼
# JVM
## å¼•ç”¨
* å¼ºå¼•ç”¨
å¯¹è±¡æ‰€å çš„å†…å­˜æ­»ä¹Ÿä¸å›æ”¶
* è½¯å¼•ç”¨
å†…å­˜ä¸è¶³æ‰å›æ”¶
åƒMybatisä¸­çš„ç¼“å­˜çš„å®ç°ï¼Œç”¨çš„å°±æ˜¯è½¯å¼•ç”¨
* å¼±å¼•ç”¨
ä¸‹ä¸€æ¬¡gcå¿…å›æ”¶
* è™šå¼•ç”¨

åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæ€ä¹ˆè¿›è¡Œèµ‹å€¼

é™æ€å±æ€§åœ¨classå¯¹è±¡ä¸­
æ‰§è¡Œå¼•æ“æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤
newæŒ‡ä»¤ï¼š1ã€åœ¨å †ä¸­å¼€è¾Ÿå†…å­˜2ã€å°†å †ä¸­åˆ›å»ºå¯¹è±¡çš„åœ°å€å‹å…¥æ ˆå¸§ä¸­çš„æ“ä½œæ•°æ ˆ
dupæŒ‡ä»¤ï¼š1ã€å¤åˆ¶æ ˆé¡¶å…ƒç´ 2ã€å†æ¬¡å‹å…¥æ ˆ
ä¸ºä»€ä¹ˆè¦dup?ç»™thisæŒ‡é’ˆèµ‹å€¼ï¼ˆæ‰€ä»¥thiså°±æ˜¯ä¸€ä¸ªåœ°å€ï¼ŒæŒ‡å‘å †ä¸­å¯¹è±¡çš„ä½ç½®ï¼‰
thisæŒ‡é’ˆ&å±€éƒ¨å˜é‡è¡¨ï¼šå±€éƒ¨å˜é‡è¡¨å°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæœ‰ä¸‹æ ‡ï¼Œæˆ‘ä»¬è¯´çš„ä¸‹æ ‡0çš„ä½ç½®å­˜æ”¾thisæŒ‡é’ˆï¼Œä¸æ˜¯è¯´æŠŠ"this"è¿™ä¸ªå­—ç¬¦ä¸²æ”¾è¿›index0ä½ç½®ï¼Œè€Œæ˜¯index0ä½ç½®**ä»£è¡¨**thisæŒ‡é’ˆï¼Œé‡Œé¢æ”¾å…·ä½“çš„åœ°å€

æ‰§è¡Œå¼•æ“åœ¨æ‰§è¡Œä¸€ä¸ªæ–¹æ³•æ—¶ï¼š1ã€åˆ›å»ºæ ˆå¸§2ã€ç»™thisæŒ‡é’ˆèµ‹å€¼

invokespecialæŒ‡ä»¤ï¼š


> Javaè¿è¡Œçš„è¿‡ç¨‹    
å°†classæ–‡ä»¶åŠ è½½åˆ°æ–¹æ³•åŒºï¼ŒåŒæ—¶æ–¹æ³•å»è¿˜ä¼šå­˜åœ¨ä¸€ä¸ªè¿è¡Œæ—¶å¸¸é‡æ± ï¼Œå¹¶åœ¨å †ä¸­ç”Ÿæˆä¸€ä¸ªclasså®ä¾‹

* ç±»çš„åŠ è½½å™¨
    * ä½œç”¨ï¼šç±»çš„åŠ è½½å™¨çš„ä½œç”¨å°±æ˜¯å°†.classæ–‡ä»¶åŠ è½½åˆ°jvmå†…å­˜ä¸­
    Qï¼šç±»çš„åŠ è½½å™¨æ˜¯å°†ç±»åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¯æ˜¯ClassLoaderæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œè°æ¥åŠ è½½ClassLoader.classå‘¢ï¼Ÿ
    æ ¹æ®ä¸‹é¢çš„ä»£ç ï¼ŒçŒœæµ‹æ˜¯BootStrapClassLoader
    ```java
    ClassLoader loader = ClassLoaderTest.class.getClassLoader();
    ClassLoader loader1 = loader.getClass().getClassLoader();
    System.out.println(loader1); //null
    ```

* ç±»çš„åŠ è½½è¿‡ç¨‹ï¼š
    1. åŠ è½½ï¼ˆLoadingï¼‰ï¼šå°†classæ–‡ä»¶è¯»å…¥æ–¹æ³•åŒºï¼Œå¹¶ä¸”åœ¨å †ç©ºé—´ä¸­ç”Ÿæˆå¯¹åº”çš„Classå®ä¾‹
    2. é“¾æ¥ï¼ˆLinkingï¼‰
        * éªŒè¯ï¼ˆverifyï¼‰ï¼šéªŒè¯classæ–‡ä»¶æ˜¯å¦åˆæ³•
        * å‡†å¤‡ï¼ˆprepareï¼‰:ä¸ºç±»å˜é‡ï¼ˆstaticçš„ï¼‰åˆ†é…å†…å­˜ï¼Œå¹¶è®¾ç½®å˜é‡å€¼ä¸ºé»˜è®¤åˆå§‹åŒ–å€¼(`int=0;double=0.0;Object=null...`)ï¼ˆè¿™äº›å˜é‡å­˜åœ¨äºæ–¹æ³•åŒºï¼‰
        > ä¸åŒ…æ‹¬finalä¿®é¥°çš„staticï¼šfinalä¿®é¥°çš„å˜é‡åœ¨ç¼–è¯‘é˜¶æ®µå°±å·²ç»åˆå§‹åŒ–é»˜è®¤å€¼äº†ï¼Œä¼šåœ¨å½“å‰å‡†å¤‡é˜¶æ®µæ˜¾ç¤ºåˆå§‹åŒ–
        * è§£æï¼ˆResolveï¼‰:å°†ç¬¦å·å¼•ç”¨æ¢æˆç›´æ¥å¼•ç”¨
    3. åˆå§‹åŒ–ï¼ˆinitializationï¼‰ï¼šè°ƒç”¨æ‰§è¡Œmethodä¸­çš„clinitæ–¹æ³•ï¼ˆclass initializationï¼‰
    > ä»€ä¹ˆæ˜¯clinitæ–¹æ³•ï¼Ÿæˆ‘æ²¡æœ‰å†™è¿‡å•Š
    ä¸éœ€è¦è‡ªå·±æ‰‹å†™ï¼Œjavacç¼–è¯‘å™¨ä¼šå¸®æˆ‘ä»¬ç”Ÿæˆ
    æ€ä¹ˆç”Ÿæˆçš„clinitæ–¹æ³•ï¼Ÿ
    javacä¼šæ”¶é›†æˆ‘ä»¬å†™çš„ä»£ç ä¸­æ‰€æœ‰çš„`staticå˜é‡ï¼ˆç±»å˜é‡ï¼‰çš„èµ‹å€¼åŠ¨ä½œ`&`é™æ€ä»£ç å—`ï¼Œåˆå¹¶æˆclinitæ–¹æ³•ã€‚ä¸åŒ…å«é™æ€æ–¹æ³•

    clinitæ–¹æ³•ä¸­çš„æŒ‡ä»¤æŒ‰ç…§åœ¨æºæ–‡ä»¶ä¸­çš„å‡ºç°çš„é¡ºåºæ‰§è¡Œ
    ```java
    public class Test {

    static {
        num = 2;
    }

    public static int num = 1;

    public static void main(String[] args) {
        System.out.println(num); //num=1
        }
    }
    //clinitï¼ˆï¼‰å…ˆæ‰§è¡Œé™æ€ä»£ç å—ï¼Œåœ¨æ‰§è¡Œèµ‹å€¼åŠ¨ä½œ
    public class Test {

    public static int num = 1;
    static {
        num = 2;
    }
    public static void main(String[] args) {
        System.out.println(num); //num=2
        }
    }
    //clinit()å…ˆæ‰§è¡Œèµ‹å€¼åŠ¨ä½œï¼Œåœ¨æ‰§è¡Œé™æ€ä»£ç å—
    ```
    > åˆå§‹åŒ–é˜¶æ®µçš„clinit()å¹¶ä¸æ˜¯ä¸€å®šä¼šè¢«è°ƒç”¨ï¼Œç±»çš„ä¸»åŠ¨ä½¿ç”¨ä¼šè°ƒç”¨clinitï¼Œè¢«åŠ¨ä½¿ç”¨åˆ™ä¸ä¼š
    ä»€ä¹ˆæ˜¯ç±»çš„ä¸»åŠ¨ä½¿ç”¨orè¢«åŠ¨ä½¿ç”¨ï¼Ÿ
* åŒäº²å§”æ´¾æœºåˆ¶
    * ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æœºåˆ¶ï¼Ÿ
    åœ¨æ—¥å¸¸ç¼–å†™ä»£ç æ—¶ï¼Œå¦‚æœç¬¬ä¸€æ¬¡ç”¨åˆ°ä¸€ä¸ªç±»ï¼Œjvmå°±ä¼šé€šè¿‡classloaderè¿›è¡ŒåŠ è½½ï¼Œè¿™ä¸ªä»»åŠ¡é¦–å…ˆäº¤ç»™appclassloaderï¼Œä½†appclassloaderä¸ä¼šä¸Šæ¥å°±è‡ªå·±åŠ è½½ï¼Œè€Œæ˜¯ä¼šå°†ä»»åŠ¡å¾€ä¸ŠæŠ›ç»™ä¸Šä¸€çº§extclassloaderï¼ŒextclassloaderæŠ›ç»™bootstrapclassloaderï¼›ç„¶åä»bootstrapclassloaderå¼€å§‹å†³å®šæ˜¯å¦è¦åŠ è½½è¿™ä¸ªç±»ï¼Œå¦‚æœä¸å½’ä»–åŠ è½½ï¼Œå°±æŠŠåŠ è½½ä»»åŠ¡å¾€ä¸‹æŠ›
    * ä¸ºä»€ä¹ˆè¦ä½¿ç”¨åŒäº²å§”æ´¾ï¼Ÿ
    1.å®‰å…¨ï¼šå¦‚æœæ²¡æœ‰åŒäº²å§”æ´¾ï¼Œæˆ‘åœ¨ä¸€ä¸ªå·²ç»å†™å¥½çš„å·¥ç¨‹ä¸‹ï¼Œè‡ªå®šä¹‰java.lang.Stringç±»ï¼Œé‚£é¡¹ç›®è¿è¡Œèµ·æ¥çš„æ—¶å€™ç”¨çš„Stringéƒ½ä¼šå˜æˆæˆ‘å†™çš„ï¼Œé¡¹ç›®å¼‚å¸¸
## JVMè¿è¡Œæ—¶æ•°æ®åŒº
<img src="./%E5%8D%95%E4%B8%AAJava%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E6%97%B6%E7%9A%84%E5%86%85%E5%AD%98.png" width="300px" />

* æ–¹æ³•åŒº&å †ï¼ˆä¸€ä¸ªJVMä¸€ä¸ªï¼‰ï¼Œç¨‹åºè®¡æ•°å™¨&æœ¬åœ°æ–¹æ³•æ ˆ&è™šæ‹Ÿæœºæ ˆï¼ˆä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªï¼‰
* PC(Programe Counter)ï¼šæŒ‡å‘æ ˆå¸§é‡Œé¢codeä¸‹ï¼šä¸€è¡Œä¸€è¡ŒæŒ‡ä»¤

    * ä¸€ä¸ªè¿›ç¨‹ä»£è¡¨ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œä¸ºä»€ä¹ˆè¿˜è¦å¼•å…¥çº¿ç¨‹å‘¢ï¼Ÿ
    * PCçš„ä½œç”¨ï¼šCPUåœ¨çº¿ç¨‹ä¹‹é—´è¿›è¡Œåˆ‡æ¢çš„æ—¶å€™ï¼Œé€šè¿‡PCæ¥è¡¨ç¤ºå½“å‰çº¿ç¨‹æ‰§è¡Œåˆ°å“ªäº†
* Java Stack/è™šæ‹Ÿæœºæ ˆï¼š
    * åŸºæœ¬å•ä½ï¼šæ ˆå¸§ï¼Œä¸€ä¸ªæ ˆå¸§å¯¹åº”ç€ä¸€ä¸ªæ–¹æ³•è°ƒç”¨ã€‚ï¼ˆä¸€æºœæ ˆè¢«åˆ†ä¸ºå‡ å—ï¼Œæ¯ä¸€å—å°±è¢«å«åšä¸€ä¸ªæ ˆå¸§ï¼‰
        * æ ˆå¸§ç»“æ„ <img src="./%E6%A0%88%E5%B8%A7%E7%BB%93%E6%9E%84.png" width="300px"/>
    * æˆ‘åœ¨å½“å‰æ–¹æ³•Aï¼Œè°ƒç”¨æ–¹æ³•Bï¼Œé‚£æ–¹æ³•Bçš„æ ˆå¸§å…¥æ ˆè¿›è¡Œæ‰§è¡Œï¼Œæ‰§è¡Œå®Œåå‡ºæ ˆï¼Œç»§ç»­æ‰§è¡Œæ–¹æ³•A
    * `-Xss`
    * ä¸ºä»€ä¹ˆè¦å†™try catch:å› ä¸ºå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œæ–¹æ³•ä¼šå°†è¿™ä¸ªå¼‚å¸¸ä¸æ–­å¾€å›æŠ›ï¼Œç›´åˆ°mainå‡½æ•°ï¼›ä¸€ä¸ªå‡½æ•°çš„æ‰§è¡Œç»“æŸï¼ˆjava stackå¼¹å‡ºï¼‰åˆ†ä¸ºæ­£å¸¸ç»“æŸï¼ˆreturnæŒ‡ä»¤å°†æ ˆå¸§å¼¹å‡ºï¼‰ä»¥åŠæŠ›å‡ºå¼‚å¸¸ç»“æŸï¼ˆå¼‚å¸¸æŒ‡ä»¤å°†æ ˆå¸§å¼¹å‡ºï¼‰ï¼›æ­£å¸¸ç»“æŸä¼šæŠŠå‡½æ•°é‡Œçš„æ­¥éª¤æ‰§è¡Œå®Œè¿”å›ï¼Œè€ŒæŠ›å‡ºå¼‚å¸¸ç»“æŸç›´æ¥åœ¨å¼‚å¸¸å¤„è¿”å›ï¼Œä¸‹é¢çš„æ­¥éª¤éƒ½ä¸æ‰§è¡Œäº†ã€‚
        * å±€éƒ¨å˜é‡è¡¨
            * 0å·ä½ç½®å­˜çš„æ˜¯thisæŒ‡é’ˆï¼Œé‚£æ˜¯ä»€ä¹ˆï¼Ÿå½“å‰æ–¹æ³•æ‰€å±**ç±»çš„å¯¹è±¡**çš„å¼•ç”¨ï¼ˆäººè¯ï¼šæ˜¯ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æŒ‡å‘å †ä¸­çš„ä¸€å—å†…å­˜ï¼Œè¿™ä¸ªå†…å­˜é‡Œé¢è£…çš„æ˜¯å½“å‰ç±»çš„å®ä¾‹åŒ–ï¼‰ã€å°šç¡…è°·JVM p251 10m20sã€‘
* æ–¹æ³•åŒºï¼šåŠ è½½ç±»çš„ä¿¡æ¯ï¼›å †ï¼šå­˜æ”¾ç±»çš„å®ä¾‹åŒ–å¯¹è±¡
    * æ–¹æ³•åŒºçš„OOM:å¦‚æœå®šä¹‰çš„ç±»å¤ªå¤šè¶…å‡ºæ–¹æ³•åŒºï¼ŒJVMå°±ä¼šæŠ¥OutOfMemoryError:PermGen space/Metaspaceï¼ˆæ–¹æ³•åŒºåœ¨JDK7ä»¥åŠä¹‹å‰è¢«ç§°ä¸ºæ°¸ä¹…ä»£ï¼Œä¹‹åä¸ºç§°ä¸ºå…ƒç©ºé—´ï¼‰
        * JVMå†…å­˜å’Œç›´æ¥å†…å­˜ï¼šæ°¸ä¹…ä»£ç”¨çš„æ˜¯JVMå†…å­˜ï¼ˆåŸºäºIOï¼‰ï¼Œå…ƒç©ºé—´ç”¨çš„æ˜¯ç›´æ¥å†…å­˜ï¼ˆåŸºäºNIOï¼‰
            * ç›´æ¥å†…å­˜æ¯”è¾ƒå¿«
            * `-XX:MaxDirectMemorySize`
    * æ°¸ä¹…ä»£`-XX:PermSize`,`-XX:MaxPermSize` | å…ƒç©ºé—´ï¼š`-XX:MetaspaceSize`,`-XX:MaxMetaspaceSize`
    * å­˜çš„å†…å®¹ï¼šclassæ–‡ä»¶ä¸­çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è¿è¡Œæ—¶å¸¸é‡æ±  | è¿è¡Œæ—¶å¸¸é‡æ± ä¸classæ–‡ä»¶ä¸­çš„å¸¸é‡æ± çš„åŒºåˆ«ï¼š1. é™æ€æ¦‚å¿µä¸åŠ¨æ€æ¦‚å¿µ 2. è¿è¡Œæ—¶å¸¸é‡æ± é‡Œé¢å­˜çš„å°±æ˜¯ä¸€ä¸ªä¸ªåœ°å€äº†ï¼Œè€Œä¸æ˜¯ç¬¦å·å¼•ç”¨äº†3.è¿è¡Œæ—¶å¸¸é‡æ± >= å¸¸é‡æ± ï¼š`String.intern()å°±æœ‰å¯èƒ½å¾€è¿è¡Œæ—¶å¸¸é‡æ± é‡ŒåŠ å…¥ä¸œè¥¿`ï¼›åŒ…æ‹¬**å…·ä½“çš„ä»£ç æŒ‡ä»¤ï¼**ï¼‰
    > 1ã€å­—èŠ‚ç æŒ‡ä»¤ä¸­`ldc #2 <cbc>`ï¼Œåœ¨å®é™…è¿è¡Œä¸­ï¼Œ`#2`æ˜¯ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€é‡Œé¢å­˜çš„æ˜¯`cbc`ã€‚
    2ã€å­—ç¬¦ä¸²å¸¸é‡å€¼åœ¨1.7ä»¥åŠä»¥å‰åœ¨å †ä¸­ï¼Œ1.8åå°±åœ¨æ–¹æ³•åŒºä¸­äº†
### å †ï¼ˆheapï¼‰
å¯¹è±¡å®ä¾‹åŒ–éƒ½åœ¨å †ä¸­
> æ‰€æœ‰çº¿ç¨‹å…±äº«å †ï¼Œä½†å¹¶ä¸æ˜¯å †ä¸­æ‰€æœ‰éƒ¨åˆ†éƒ½æ˜¯å…±äº«çš„ï¼Œä¾‹å¦‚TLAB

> ä»å †åˆ°GCï¼šæ–¹æ³•ä¸­åˆ›å»ºçš„å¯¹è±¡ï¼Œä¸ä¼šåœ¨æ–¹æ³•ç»“æŸåç«‹å³å›æ”¶ï¼Œè€Œæ˜¯ä¼šåœ¨åƒåœ¾æ”¶é›†çš„æ—¶å€™è¢«å›æ”¶
ä¸ºä»€ä¹ˆï¼Ÿå¦‚æœç«‹å³å›æ”¶ï¼Œä¼šå¢åŠ GCçš„é¢‘ç‡ï¼Œè€ŒGCçº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹æ˜¯å¹¶å‘çš„ï¼Œä¼šå½±å“ç”¨æˆ·çº¿ç¨‹çš„æ‰§è¡Œ
* å †çš„ç»†åˆ†
<img src="./heap.png" width="400px" />
JDK7ä»¥åŠä»¥å‰ï¼š Young Generation Space,Tenure Generation Space,Permanent Space
JDK8åŠä»¥åï¼šYoung Generation Space,Tenure Generation Space,Meta Space
* `-Xmx`:å †ç©ºé—´å¯ç”¨çš„æœ€å¤§,`-Xms`ï¼šå †åˆå§‹å¤§å°
> -X + ms(memory start)
* newçš„å¯¹è±¡åœ¨å †ä¸­çš„ç»†èŠ‚
    * å¯¹è±¡å¤´ï¼ˆheaderï¼‰
        1. è¿è¡Œæ—¶å…ƒæ•°æ®ï¼šå“ˆå¸Œå€¼ã€å¹´é¾„è®¡æ•°å™¨ï¼ˆYGCå°†Edenä¸­çš„å¯¹è±¡è½¬ç§»åˆ°S0ï¼Œå¹´é¾„è®¡æ•°å™¨å˜ä¸º1ï¼‰
        2. ç±»å‹æŒ‡é’ˆï¼šæŒ‡å‘classå¯¹è±¡
    * å®ä¾‹æ•°æ®ï¼ˆInstance Dataï¼‰
* GC
åˆ›å»ºçš„å¯¹è±¡ä¼šå…ˆè¢«åˆ†é…åœ¨EdenåŒºï¼Œå¦‚æœEdenæ»¡äº†ä¼šè§¦å‘YoungGCï¼ŒYGCä¼šåœ¨EdenåŒºè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œæ²¡ç”¨çš„å¯¹è±¡è¢«å›æ”¶ï¼Œå¦‚æœè¿˜æœ‰ç”¨å°±ä¼šå°†å…¶æ”¾è¿›S0/S1åŒºï¼›é™¤æ­¤ä¹‹ä½ï¼ŒYGCè¿˜ä¼šå¯¹S0/S1è¿›è¡Œåƒåœ¾å›æ”¶ï¼ŒYGCçš„ç»“æœæ˜¯EdenåŒºå’ŒS0/S1å †ç©ºé—´ä¸ºç©ºï¼›
å¦‚æœè¿›è¡Œä¸€ä¸ªYGCåï¼ˆS0/S1æ”¾ä¸ä¸‹æˆ–è€…æ¬¡æ•°è¶…è¿‡äº†15ï¼‰åœ¨æ–°ç”Ÿä»£ä»ç„¶æ”¾ä¸ä¸‹è¯¥å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°±ä¼šè¿›å…¥è€å¹´åŒº
å½“è€å¹´åŒºè¢«æ”¾æ»¡æ—¶ï¼Œå°±ä¼šè§¦å‘full/major GCï¼Œå¦‚æœmajor GCä¸èƒ½å›æ”¶ï¼Œå°±ä¼šOOM
> full GC:ä¼šå¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£è¿›è¡Œå…¨é¢æ‰«æï¼Œæ¥å°½å¯èƒ½çš„å›æ”¶å†…å­˜

* GCå®ç°çš„ç»†èŠ‚
GC Rootsï¼Œå¯è¾¾æ€§åˆ†æç®—æ³•ï¼š

* å†…å­˜æº¢å‡º&å†…å­˜æ³„æ¼
    * å†…å­˜æº¢å‡ºï¼ˆOOMï¼‰
        1. å †ç©ºé—´è®¾ç½®çš„å¤ªå°
        2. ä»£ç æœ‰é—®é¢˜ï¼Œå †ä¸­ç”Ÿæˆçš„å¯¹è±¡ä¸èƒ½è¢«å›æ”¶
    * å†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰
    <br><br>
> æ³¨ï¼šä¸‹é¢ä»£ç ç³»ç»ŸGCæ˜¯å¯ä»¥è‡ªåŠ¨å¤„ç†çš„
å¦‚å›¾æ‰€ç¤ºï¼Œjvmæœ€ç»ˆä¼šåœ¨è€å¹´ä»£è§¦å‘major GCï¼Œå›æ”¶å †å†…å­˜
```java
public static void main(String[] args) {
    while(true){
        String str = new String();
    }
}
```
<img src="./while-true-newString.png" width="500px" />

## GC
åœ¨ä»£ç ä¸­newçš„å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡ä¸ç”¨äº†ï¼Œé‚£å°±éœ€è¦æŠŠå…¶æ‰€å çš„å†…å­˜é‡Šæ”¾æ‰ï¼Œé‚£åœ¨ä»€ä¹ˆæ—¶å€™æŠŠå†…å­˜é‡Šæ”¾æ‰ï¼Œè¿™å°±æ˜¯GCçš„ä»»åŠ¡
* GCRoot
å½“jvmè¿›è¡Œgcçš„æ—¶å€™ï¼Œä¼šä»ç±»å˜é‡ï¼ˆæ–¹æ³•åŒºä¸­ï¼‰ï¼Œå±€éƒ¨å˜é‡è¡¨ä¸­çš„å¼•ç”¨å‡ºå‘ï¼Œå¦‚æœæŸä¸€ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼Œé‚£å°±éœ€è¦å›æ”¶å†…å­˜
* `System.gc()`
æ‰‹åŠ¨è§¦å‘full gc

* å¯¹è±¡çš„finalizationæœºåˆ¶
jvmåœ¨è¿›è¡Œgcçš„æ—¶å€™ï¼Œæœ‰ä»¥ä¸‹æ­¥éª¤
1ã€å¯¹äºæŸä¸ªå¯¹è±¡ï¼Œä»gcRootå‡ºå‘ï¼Œåˆ¤æ–­æ˜¯å¦å¯è¾¾
2ã€å¦‚æœä¸å¯è¾¾ï¼Œä¸”è¯¥å¯¹è±¡è¿›è¡Œè°ƒç”¨è¿‡finalizeæ–¹æ³•ï¼Œç«‹å³å›æ”¶
3ã€å¦‚æœä¸å¯è¾¾ï¼Œä¸”è¯¥å¯¹è±¡è¿˜æ²¡æœ‰è°ƒç”¨finalizeæ–¹æ³•ï¼Œè°ƒç”¨finalizeæ–¹æ³•
4ã€è°ƒç”¨finalizeæ–¹æ³•åï¼Œåˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦å¯ä»gcRootåˆ°è¾¾ï¼Œå¦‚æœå¯è¾¾ï¼Œè¯¥å¯¹è±¡å¤æ´»ï¼›å¦‚æœä¸å¯è¾¾ï¼Œå›æ”¶å†…å­˜
```java
public class FinalizationTest {
    static Object obj;

    @Override
    protected void finalize() throws Throwable {
        super.finalize();
        obj = this;
    }

    public static void main(String[] args) throws InterruptedException {
        obj = new FinalizationTest();
        obj = null;
        System.gc();
        Thread.sleep(10); //ç­‰å¾…finalizerçº¿ç¨‹æ‰§è¡Œï¼Œå› ä¸ºè¯¥çº¿ç¨‹ä¼˜å…ˆçº§æ¯”è¾ƒä½
        System.out.println(obj); //ä¸æ˜¯nullï¼com.example.jvm.FinalizationTest@14ae5a5
    }
}
```

* æ‰§è¡Œå¼•æ“

* ä¸ºä»€ä¹ˆJavaè¦å¼•å…¥classæ–‡ä»¶ï¼Œä¸èƒ½åƒCä¸€æ ·ç›´æ¥ç¼–è¯‘è¿è¡Œå—ï¼Ÿå› ä¸ºJavaè¢«ç§°ä¸ºè·¨å¹³å°è¯­è¨€ï¼Œâ€œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚Cå°±ä¸èƒ½ä¸€æ¬¡ç¼–è¯‘åˆ°å¤„è¿è¡Œï¼›é‚£ä¸ºä»€ä¹ˆJava**è¦**ä¸€æ¬¡ç¼–è¯‘åˆ°å¤„è¿è¡Œå‘¢ï¼Ÿï¼ˆä¸€æ¬¡ç¼–è¯‘åˆ°å¤„è¿è¡Œçš„å¥½å¤„ï¼Ÿï¼šå…¶å®è‹±è¯­åŸæ–‡æ˜¯â€œwrite onceï¼Œrun everywhereâ€ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜Cä»£ç åœ¨ä¸åŒçš„å¹³å°éœ€è¦æ”¹æºç ï¼Ÿç°åœ¨åªèƒ½è¿™æ ·ç†è§£äº†ï¼‰
* Classæ–‡ä»¶ç»“æ„
    * magic u4
    * ç‰ˆæœ¬å· u4ï¼ˆu2+u2ï¼‰
    * å¸¸é‡æ± ä¸­çš„ä¸ªæ•° u2ï¼ˆä¸ºä»€ä¹ˆå®é™…ä¸­çš„å¸¸é‡æ± ä¸ªæ•°=u2-1ï¼Ÿï¼‰
    * å¸¸é‡æ±  
    > ä»€ä¹ˆæ˜¯å¸¸é‡æ± ï¼Ÿ
    * è®¿é—®æ ‡è¯† u2 è¡¨ç¤ºçš„æ•°æ˜¯ä¸ªå’Œ ä¾‹å¦‚0x21è¡¨ç¤º0x20(public)+0x01(super);åŒæ—¶è¿™ä¸ªæ•°ä¹Ÿç”¨æ¥æ ‡è¯†è¿™ä¸ªclassæ˜¯ä¸ªç±»è¿˜æ˜¯æ¥å£
    * u2ï¼ˆé€šè¿‡å¸¸é‡æ± æŒ‡å‡ºå½“å‰ç±»çš„åå­—ï¼‰+u2ï¼ˆå¸¸é‡æ± ï¼šçˆ¶ç±»ï¼‰+u2ï¼ˆæ¥å£ä¸ªæ•°ï¼‰+æ¥å£ç´¢å¼•é›†åˆ
    * å­—æ®µè®¡æ•°å™¨ u2ï¼šè¡¨ç¤ºç±»ä¸­çš„æˆå‘˜ä¸ªæ•°
    * å­—æ®µè¡¨
    * æ–¹æ³•è®¡æ•°å™¨
    * æ–¹æ³•è¡¨
    * å±æ€§ï¼šæ–¹æ³•1ä¸­çš„Codeï¼ˆå…·ä½“æ“ä½œçš„äºŒè¿›åˆ¶ï¼‰æ–¹æ³•2ä¸­çš„Code...
        * LineNumberTable: StartPcï¼šå…·ä½“æŒ‡ä»¤çš„è¡Œæ•°  <-> LineNumber:Javaä»£ç çš„è¡Œæ•°
* ä¸€ä¸ªæ–¹æ³•JVMä¼šå¼€è¾Ÿä¸€æºœå†…å­˜ï¼Œè¿™ä¸€å—è¢«ç§°ä¸ºæ ˆå¸§ï¼›æ ˆå¸§è¢«åˆ†ä¸ºå‡ å°å—ï¼ŒåŒ…æ‹¬ï¼šæ“ä½œæ•°æ ˆ+å±€éƒ¨å˜é‡è¡¨+... å±€éƒ¨å˜é‡è¡¨æ”¾çš„æ˜¯ï¼šthisæŒ‡é’ˆï¼Ÿæ–¹æ³•ä¼ å…¥çš„å½¢å‚+æ–¹æ³•é‡Œé¢çš„å±€éƒ¨å˜é‡
* ä¸€ä¸ªæ–¹æ³•é‡Œé¢çš„å˜é‡è¢«ç§°ä¸ºå±€éƒ¨å˜é‡ï¼Œè¯·æ€è€ƒå±€éƒ¨å˜é‡ä¸å±€éƒ¨å˜é‡è¡¨ä¹‹é—´çš„å…³ç³»
* æŒ‡ä»¤ ï¼ˆç”¨ä¸€ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼‰
    * åŠ è½½ä¸å‚¨å­˜
        * å±€éƒ¨å˜é‡å‹æ ˆæŒ‡ä»¤:xload_\<n>
        * å¸¸é‡å…¥æ ˆæŒ‡ä»¤:xconst,bipush/sipush,ldc
        * å°†æ“ä½œæ•°æ ˆä¸­çš„å…ƒç´ å¼¹å‡ºå¹¶è£…å…¥å±€éƒ¨å˜é‡è¡¨ï¼šistore
    * ç®—æœ¯æŒ‡ä»¤
    * ç±»å‹è½¬æ¢æŒ‡ä»¤
        * å®½åŒ–ï¼ˆè‡ªåŠ¨ï¼šint->longï¼‰
        * çª„åŒ–ï¼ˆå¼ºåˆ¶ç±»å‹è½¬åŒ–ï¼Œè¦æ˜¾ç¤ºå†™å‡ºæ¥ï¼šint->shortï¼‰
    * å¯¹è±¡çš„åˆ›å»ºä¸è®¿é—®æŒ‡ä»¤
        * åˆ›å»ºæŒ‡ä»¤ï¼šnewï¼ˆåœ¨å †é‡Œå¼€è¾Ÿä¸€å—ç©ºé—´å¹¶åˆå§‹åŒ–ç±»ï¼Œå°†ç±»çš„åœ°å€å…¥æ“ä½œæ•°æ ˆï¼‰ã€newarray
        * è®¿é—®æŒ‡ä»¤ï¼šgetstaticã€putstaticã€getfieldã€putfield
    * æ–¹æ³•è°ƒç”¨ä¸è¿”å›æŒ‡ä»¤
    * æ“ä½œæ•°æ ˆç®¡ç†æŒ‡ä»¤
        * dupï¼šduplication å°†æ“ä½œæ•°æ ˆé¡¶å…ƒç´ å¤åˆ¶ä¸€ä»½åœ¨å…¥æ ˆ
* JVMå·¥å…·
    * jps
    * jstat
* JVMå†…å­˜åˆ†ç±»ï¼šæ–¹æ³•åŒº+å †+Java Stack+æœ¬åœ°æ–¹æ³•æ ˆ+ç¨‹åºè®¡æ•°å™¨
* xxxï¼Œåœ¨å†…å­˜çš„æ–¹æ³•åŒºå°±å­˜åœ¨ä¸€ä¸ªç±»çš„æ¨¡æ¿
----
* å‰ç«¯ç¼–è¯‘å™¨
    * ä¸ºä»€ä¹ˆè§‰å¾—ï¼šeclipseåœ¨Run ASçš„æ—¶å€™è¦æ¯”ideaè¿è¡Œçš„æ—¶å€™è¦å¿«ä¸€ç‚¹ï¼Ÿideaé»˜è®¤ä½¿ç”¨javacç¼–è¯‘å™¨ï¼Œé‡‡ç”¨å…¨é‡å¼ç¼–è¯‘ï¼ˆæ¯æ¬¡è¿è¡Œçš„æ—¶å€™éƒ½è¦è¿›è¡Œå…¨éƒ¨ç¼–è¯‘ï¼‰ï¼Œè€Œeclipseä½¿ç”¨çš„æ˜¯ECJï¼ˆeclipse compiler for javaï¼‰ï¼Œé‡‡ç”¨å¢é‡å¼ç¼–è¯‘å™¨ï¼Œå°±æ˜¯åŸæ¥ç¼–è¯‘è¿‡çš„å°±ä¸ç¼–è¯‘äº†
* ä¸ºä»€ä¹ˆè¯´Javaæ˜¯è§£é‡Š+ç¼–è¯‘ï¼šè¿™ä¸JVMæœ‰å…³ï¼ŒJVMä¸­æœ‰ä¸€ä¸ªéƒ¨åˆ†ç”¨æ¥è§£é‡Šç¨‹åºè¿è¡Œï¼ˆä¸€èˆ¬æ˜¯ç¨‹åºç¬¬ä¸€æ¬¡è¿è¡Œï¼‰ï¼Œå¦ä¸€éƒ¨åˆ†ç”¨æ¥ç¼–è¯‘ï¼ˆé€šå¸¸æ˜¯å¸¸ç”¨ä»£ç ï¼‰ã€‚ä¸»è¦æ˜¯ä¸ºäº†é€Ÿåº¦
* newä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šåœ¨å†…å­˜ï¼ˆheapï¼‰é‡Œåˆ†é…å†…å­˜
* ==Javaæ˜¯æ€ä¹ˆè¿è¡Œèµ·æ¥çš„ï¼Ÿ== ï¼ˆæ¥æºï¼šå°šç¡…è°·JavaåŸºç¡€p317ï¼Œ01ï¼š57è®²staticæ—¶ï¼Œè¯´äº†ä¸€å¥é€šè¿‡æ„é€ æ–¹æ³•åœ¨heapä¸­åˆ›å»ºå¯¹è±¡ï¼Œè¿˜æ˜¯ä¸ç†è§£Javaçš„è¿è¡Œè¿‡ç¨‹ï¼‰ã€curï¼šJVMp207ã€‘
* `å½“ä½¿ç”¨ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œè¿™ä¸ªç±»å°±ä¼šåŠ è½½åˆ°å†…å­˜é‡Œ`ï¼ŒåŠ è½½çš„æ—¶å€™ï¼ŒåŠ è½½åˆ°å“ªï¼Ÿä»€ä¹ˆçŠ¶æ€ï¼Ÿï¼ˆæ¥æºï¼šå°šç¡…è°·JavaåŸºç¡€å®‹p330ï¼Œ9m53sï¼‰
* å¸¸é‡æ± -string static
# JavaWeb

## JavaScript


* å›å¿†æ™®é€šçš„JavaWebé¡¹ç›®çš„æ•´ä½“æµç¨‹(jsp+servlet)ã€ç‹‚ç¥springmvc p3ã€‘æµè§ˆå™¨è¯·æ±‚é€šè¿‡web.xmlçš„å¼•å¯¼è¿›å…¥å¯¹åº”çš„servletï¼Œåœ¨servletä¸­é€šè¿‡è°ƒç”¨serviceå’Œdaoå±‚è¿›è¡ŒåŠŸèƒ½å¤„ç†ï¼Œæœ€ç»ˆåœ¨servleté€šè¿‡è½¬å‘æˆ–è€…é‡å®šå‘å‘Šè¯‰æµè§ˆå™¨è¯¥è¯¥è®¿é—®ä»€ä¹ˆé¡µé¢
* å‰ç«¯
    * getè¯·æ±‚ä¸postè¯·æ±‚çš„åŒºåˆ«ï¼Ÿ getè¯·æ±‚æ–¹å¼ä¼šåœ¨URLä¸Šæ˜¾ç¤ºå‚æ•° ç‹‚ç¥JavaWeb p14ï¼Œ18min22s ï¼›è€Œpostçš„æ•°æ®ä¼šåœ¨Form dataé‡Œé¢
    * ä¸€ä¸ªurl`xxxx?username=cbc&password=123456`é‡Œé¢çš„usernameå’Œpasswordæ˜¯ä»å“ªæ¥çš„ï¼Ÿç‹‚ç¥JavaWeb p14ï¼Œ19min15s 
## ELè¡¨è¾¾å¼  
* ELè¡¨è¾¾å¼æ˜¯ä¸ºäº†ç®€åŒ–jspè¾“å‡ºï¼Œç”¨${}ä»£æ›¿<%= %>
```java
${key} =
<%= xxx.getAtrribute("key",something)%>
//ELè¡¨è¾¾å¼æœ‰ç‚¹åƒä¸€ä¸ªmapæ˜ å°„ï¼Œé€šè¿‡${key}æ¥å¾—åˆ°setAtrribute("key",something)ä¸­çš„something

/*è¿™æ ·çš„è¯ELè¡¨è¾¾å¼ä¸­çš„éšå¼å¯¹è±¡ä¹Ÿå°±å¾ˆå¥½ç†è§£äº†
    ä¸ºä»€ä¹ˆELè¡¨è¾¾å¼ä¸­çš„ApplicationScopeå¯¹è±¡=jspä¸­çš„applicationï¼Ÿ
    æˆ‘è§‰å¾—åº•å±‚è‚¯å®šæœ‰è¿™æ ·ä¸€è¡Œä»£ç ï¼šxxx.setAttribute("ApplicationScope",application);
*/
```
* `${key}`,å½“å››ä¸ªåŸŸä¸­éƒ½æœ‰keyçš„æ—¶å€™ï¼ŒELè¡¨è¾¾å¼ä¼šæ€ä¹ˆè¿›è¡Œå–å€¼ï¼Ÿ
pageContext->request->session->application
* ELè¡¨è¾¾å¼ä¹Ÿèƒ½å¤Ÿè¿›è¡Œä¸€äº›ç®€å•çš„é€»è¾‘è¿ç®—å’Œç®—æœ¯è¿ç®—
    * ${empty sessionScope.indexuser}ï¼šè‹¥indexuseræœ‰å€¼ï¼Œè¾“å‡ºfalse
* `.`æ“ä½œç¬¦&`[]`æ“ä½œç¬¦
    * `.`æ“ä½œç¬¦
    `${person.name}`ä¸­çš„personåªèƒ½æ˜¯ä¸€ä¸ªMapæˆ–è€…ä¸€ä¸ªbeanï¼›nameåªèƒ½æ˜¯Mapä¸­çš„keyæˆ–è€…beanä¸­çš„ä¸€ä¸ªå±æ€§
    å½“personæ˜¯ä¸€ä¸ªbeanæ—¶ï¼Œ${person.name}ç›¸å½“äºperson.getName()
## Servlet
* ä»€ä¹ˆæ˜¯Servletï¼šServletå°±æ˜¯ä¸€ä¸ªç¨‹åºï¼Œæ¥æ”¶Tomcatä¼ è¿‡æ¥çš„requestå¯¹è±¡ï¼ŒServletè¿›è¡Œå¤„ç†ååœ¨æ‰”ç»™Tomcatï¼ŒTomcatå°†ç»“æœå‘å›æµè§ˆå™¨
* ä¸ºä»€ä¹ˆè¦ç”¨Servletï¼Ÿ å› ä¸ºTomcatéœ€è¦[link](https://www.zhihu.com/question/21416727/answer/690289895) Tomcatçš„ä»£ç å›¾
* æ˜¯æ€ä¹ˆé€šè¿‡URLåœ¨æ‰¾åˆ°å…·ä½“çš„Servletçš„ï¼Ÿã€å°šç¡…è°·JavaWebp124ã€‘
* Servletæ˜¯ä¸€ä¸ªclassï¼Œé‡Œé¢æœ‰å„ç§å„æ ·çš„æ–¹æ³•ï¼Œé‚£æœ‰ä¸ªé—®é¢˜ï¼šè°è°ƒç”¨çš„Servletï¼Ÿ[link](https://www.zhihu.com/question/21416727/answer/690289895)
* ä»€ä¹ˆæ˜¯ServletContextï¼Ÿ ã€ç‹‚ç¥p10ã€‘
    * `context.getInitParameter`
    * `context.getRequestDispatcher("").forward()`,ç†è§£è½¬å‘ ä¸ é‡å®šå‘ä¹‹é—´çš„åŒºåˆ«ï¼šé‡å®šå‘èµ°äº†ä¸¤è¶Ÿï¼›servlet+jspå°±æ˜¯è½¬å‘
    * é€šè¿‡contextè¯»å–å¤–éƒ¨é…ç½®æ–‡ä»¶
* è§£å†³è¯·æ±‚ä¹±ç é—®é¢˜
    * getè¯·æ±‚
    getè¯·æ±‚éœ€è¦å»ä¿®æ”¹Tomcatçš„é…ç½®ï¼›æˆ–è€…åœ¨å‰ç«¯åšä¸€äº›æ”¯æŒ[link](https://www.likecs.com/show-305417381.html)
    * postè¯·æ±‚
    ```java
    req.setCharacterEncoding("UTF-8"); //setCharacterEncodingåªå¯¹è¯·æ±‚ä½“è®¾ç½®å­—ç¬¦ç¼–ç ï¼Œæ‰€ä»¥å¦‚æœæ˜¯getè¯·æ±‚ï¼Œå°±æ²¡ç”¨
    String name = req.getParameter("name");
    ```
* è§£å†³å“åº”ä¹±ç é—®é¢˜
```java
    resp.setCharacterEncoding("utf-8");//è®¾ç½®responseçš„ç¼–ç æ ¼å¼
    resp.setHeader("Content-Type","text/html;charset=utf-8");//è®¾ç½®æµè§ˆå™¨è§£æç¼–ç çš„æ ¼å¼

    //===================================æˆ–è€…===============
    resp.setContentType("text/html;charset=utf-8");//åŒæ—¶è®¾ç½®æœåŠ¡å™¨å’Œæµè§ˆå™¨çš„ç¼–ç æ–¹å¼
```
* HttpServletRequest
    * è·å–å‰ç«¯å‚æ•°ï¼šä¸ºä»€ä¹ˆèƒ½è·å–åˆ°ï¼Ÿæ€ä¹ˆè·å–ï¼Ÿ
        * è·å¾—ä¸€ä¸ª
        * è·å¾—ä¸€ç»„
    * è½¬å‘ï¼š`req.getRequestDispatcher("").forward()`
* HttpServletResponse
    * respé‡å®šå‘çš„åŸç†ï¼šåç«¯Servletæ¥è®¾ç½®responseå¯¹è±¡ï¼Œ1.è®¾ç½®çŠ¶æ€ç 302ï¼›2.ç»™å‡ºæ–°çš„åœ°å€ï¼›ç„¶åæœåŠ¡å™¨å°†responseå‘ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£æååœ¨å‘æ–°åœ°å€å‘èµ·è¯·æ±‚
    * å¦‚ä½•ä½¿ç”¨responseç»™å®¢æˆ·ç«¯ä¼ å­—ç¬¦ä¸²æ•°æ®ï¼Ÿ
    ```java
    //é€šè¿‡æµ
    PrintWriter writer = resp.getWriter();
    writer.println("<h1>i am cbc html version</h1>");
    writer.write("<h1>i am cbc html version</h1>");
    ```
* web.xml
    * `<welcome-file-list> </welcome-file-list>`çš„ä½œç”¨ï¼Ÿ é…ç½®åˆå§‹é¡µé¢
    * `<url-pattern>/</url-patter>`è¡¨ç¤ºä»€ä¹ˆï¼Ÿ
    /  æ˜ å°„åˆ° http://ip:port/å·¥ç¨‹å/
    * é…ç½®é”™è¯¯é¡µé¢
    ```xml
    <error-page>
        <!-- å¼‚å¸¸ä»£ç ï¼Œå¯ä»¥404ã€500 -->
        <error-code>404</error-code>
        <!-- å¦‚æœTomcatå†…éƒ¨äº§ç”Ÿå¼‚å¸¸ï¼Œè·³è½¬çš„è·¯å¾„ -->
        <location>/error.jsp</location>
    </error-page>
    ```
* Filter
    * ä½¿ç”¨èƒŒæ™¯
    æƒé™ç®¡ç†ï¼šåªæœ‰ç™»å½•åæ‰èƒ½è®¿é—®æŸäº›èµ„æº
    * è¿‡æ»¤å™¨å››ä¸ªæ–¹æ³•ï¼ˆ+æ„é€ æ–¹æ³•ï¼‰çš„æ‰§è¡Œé¡ºåºï¼Ÿ
    æ„é€ å’Œinitæ–¹æ³•åœ¨tomcatå¯åŠ¨çš„æ—¶å€™å°±ä¼šæ‰§è¡Œï¼›æ¯æ¬¡è¯·æ±‚è¿›æ¥å°±ä¼šæ‰§è¡Œdofilteræ–¹æ³•ï¼›å½“tomcatå…³é—­ï¼Œæ‰§è¡Œdestroyæ–¹æ³•
    * FilterConfig
    å°±æ˜¯å°†web.xmlä¸­é…ç½®çš„filterä¿¡æ¯å°è£…åˆ°FilterConfigä¸­ï¼Œå¯ä»¥é€šè¿‡FilterConfigä¸­çš„æ–¹æ³•å¾—åˆ°é…ç½®ä¿¡æ¯
    * FilterChain
    <img src="./FilterChain.png">
    * å…·ä½“ä½¿ç”¨
    ```java
    1ã€æ–°å»ºä¸€ä¸ªç±»ï¼Œimplements Filteræ¥å£ï¼ˆjavax.servletï¼‰
    2ã€åœ¨doFilteræ–¹æ³•é‡Œå†™ä¸Šç™»å½•åˆ¤æ–­
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        //è½¬æ¢ç±»å‹
        HttpServletRequest httpServletRequest = (HttpServletRequest)request;

        //è·å–sessionçš„user
        User user = (User) httpServletRequest.getSession().getAttribute("user");

        //ç”¨æˆ·æ²¡æœ‰ç™»å½•
        if(user == null){
            //ç®¡ç†å‘˜ç™»å½•é¡µé¢
            httpServletRequest.getRequestDispatcher("/pages/manager/admin_login.jsp").forward(request,response);
        }else{
            //ç™»å½•å·²å®Œæˆ
            chain.doFilter(request,response);
        }
    }
    3ã€åœ¨web.xmlä¸­é…ç½®Filter
    ```
* Cookie
    * cookieæ˜¯ä»€ä¹ˆï¼šcookieæ˜¯ç”±æœåŠ¡å™¨åˆ›å»ºï¼Œå¹¶å‘é€ç»™æµè§ˆå™¨ï¼›è®©æµè§ˆå™¨æ¯æ¬¡è®¿é—®åœ¨request headerå¸¦ä¸Šcookie
    * cookieä¿å­˜åœ¨å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼Ÿ
* Session
    * sessioné»˜è®¤çš„å­˜åœ¨æ—¶é•¿æ˜¯ï¼Ÿ
    é€šè¿‡`session.getMaxInactiveInterval()`å¯å¾—åˆ°ï¼š1800sï¼Œå³30min
    * ä»£ç ä¸­æ˜¯é€šè¿‡`request.getSession()`æ¥å¾—åˆ°å¯¹åº”çš„sessionï¼Œé‚£å¦‚æœæ˜¯åŒä¸€ä¸ªç”¨æˆ·å‘èµ·ä¸åŒçš„è¯·æ±‚ï¼Œç”¨è¿™äº›requestè°ƒç”¨getSessionæ–¹æ³•ï¼Œå¾—åˆ°çš„sessionæ˜¯åŒä¸€ä¸ªsessionå—ï¼Ÿ
    ```java
    requet.getSession()
    å½“ç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ï¼ŒæœåŠ¡å™¨ä¼šåˆ†é…ä¸€å—å†…å­˜ä½œä¸ºsessionï¼Œä¸æ­¤åŒæ—¶ä¼šæ–°å»ºä¸€ä¸ªCookieï¼Œå®ƒçš„keyæ˜¯jsessionidï¼Œå®ƒçš„valueæ˜¯sessionid
    è¯¥Cookieçš„å­˜æ´»æ—¶é—´æ˜¯ï¼šå½“æµè§ˆå™¨å…³é—­å³æ¶ˆå¤±ã€‚
    è¯¥Cookieçš„åˆ›å»ºã€åˆå§‹åŒ–ã€è¿”å›ç»™æµè§ˆå™¨æ˜¯æˆ‘ä»¬ä¸å¯æ§çš„ï¼Œå…¨éƒ¨ç”±webæœåŠ¡å™¨æ‰§è¡Œ

    ä¸Šé¢é—®é¢˜çš„ç­”æ¡ˆæ˜¯ï¼š
    æ‰¾sessionå¹¶ä¸æ˜¯é€šè¿‡requestæ¥æ‰¾çš„ï¼Œè€Œæ˜¯é€šè¿‡keyä¸ºjsessionçš„cookieçš„valueæ¥æ‰¾çš„
    ```
    * Qï¼šæœåŠ¡å™¨ç«¯åˆ›å»ºSessionå¯¹è±¡çš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰åœ¨èƒŒååˆ›å»ºCookieå¯¹è±¡ï¼Ÿ
    æ˜¯æœ‰çš„ï¼Œå›å¿†Cookieçš„ä½¿ç”¨ï¼Œåªæœ‰æˆ‘ä»¬`resp.addCookie()`çš„æ—¶å€™ï¼Œæµè§ˆå™¨ç«¯æ‰ä¼šåˆ›å»ºä¸€ä¸ªcookieã€‚è€Œå½“æˆ‘ä»¬åªå†™ä¸ª`getSession`çš„æ—¶å€™ï¼Œæµè§ˆå™¨ç«¯ä¹Ÿä¼šå­˜åœ¨cookieã€‚
    æ‰€ä»¥å¯ä»¥çŒœæµ‹Tomcatåœ¨èƒŒåæ˜¯åˆ›å»ºäº†ä¸€ä¸ªCookieçš„
    * `request.getSession(true)`ä»€ä¹ˆæ„æ€ï¼Ÿ ä¸`request.getSession(false)`åšå¯¹æ¯”
    ```java
    request.getSession(true)//ï¼šè‹¥å­˜åœ¨ä¼šè¯åˆ™è¿”å›è¯¥ä¼šè¯ï¼Œå¦åˆ™æ–°å»ºä¸€ä¸ªä¼šè¯ã€‚
    request.getSession(false)//ï¼šè‹¥å­˜åœ¨ä¼šè¯åˆ™è¿”å›è¯¥ä¼šè¯ï¼Œå¦åˆ™è¿”å›NULL
    ```
    * `request.getSession()`åŸç†
    å¦‚æœè®¿é—®åˆ°è¿™è¡Œä»£ç ï¼Œå¦‚æœæµè§ˆå™¨ä¼ è¿‡æ¥çš„æœ‰sessionidï¼Œé‚£ä¹ˆå°±å›å»æ‰¾
    å¦‚æœæ²¡æœ‰sessionidï¼Œå°±ç›´æ¥æ–°åˆ›å»º
    > æ˜¯ä¸€ä¸ªæµè§ˆå™¨ä¸€ä¸ªsessionå—ï¼Ÿ
    åœ¨æ­£å¸¸ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œæ˜¯çš„
    ä½†å¯ä»¥è‡ªå·±æ‰‹åŠ¨åˆ é™¤sessionidçš„cookieï¼Œè¿™æ ·ä¹Ÿèƒ½åœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸¤ä¸ªsession
    * sessionè¶…æ—¶æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ
    * `req.setattribute()`ä¸`req.getsession.setattribute()`ä¹‹é—´çš„åŒºåˆ«ï¼Ÿä»requestçš„æŒç»­æ—¶é—´ä¸sessionçš„æŒç»­æ—¶é—´ç†è§£
    * sessionè¶…æ—¶çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ sessionè¢«é”€æ¯ï¼Œå­˜åœ¨sessioné‡Œé¢çš„æ•°æ®éƒ½æ²¡äº†
 * Cookie
    * Cookieæ˜¯ä»€ä¹ˆï¼Ÿå°±æ˜¯ä¸ªé”®å€¼å¯¹
    * ä¸ºä»€ä¹ˆéœ€è¦Cookieï¼ŸCookieè¢«è®¾è®¡å‡ºæ¥æ˜¯ä¸ºäº†è¾…åŠ©Sessionçš„ï¼Œç”¨æ¥ä¼ é€’sessionidçš„ï¼Œæœ‰å¾ˆå¤šä¸ªæµè§ˆå™¨ï¼Œä¹Ÿæœ‰å¾ˆå¤šä¸ªsessionï¼Œç”¨sessionidé˜²æ­¢ææ··
    * Cookieæ˜¯å­˜æ”¾åœ¨æµè§ˆå™¨ä¸­çš„ï¼Œé‚£Cookie.setMaxAgeæ˜¯ä»€ä¹ˆæ„æ€ï¼ŸæœåŠ¡å™¨æ€ä¹ˆç›´åˆ°Cookieå•¥æ—¶å€™åˆ°æœŸï¼Ÿ emmï¼Œç†è§£æœ‰é—®é¢˜ï¼Œè¿™ä¸ªsetMaxAgeæ˜¯å‘Šè¯‰æµè§ˆå™¨çš„ï¼Œå³åˆ°äº†æ—¶é—´å°±ä¼šæŠŠå¯¹åº”çš„Cookieåˆ é™¤
    * Cookieçš„ä½¿ç”¨
    ```java
        //åˆ›å»º
        Cookie cookie = new Cookie("key","value");
        //é€šçŸ¥æµè§ˆå™¨
        resp.addCookie(cookie);
    ```
* Servletä»£ç ä¼˜åŒ–
    * ç”¨æˆ·æ¨¡å—ï¼Œæ—¢æœ‰æ³¨å†ŒåŠŸèƒ½ï¼Œåˆæœ‰ç™»å½•åŠŸèƒ½ï¼Œéš¾é“è¦å†™ä¸¤ä¸ªServletï¼Ÿ--é€šè¿‡htmlçš„éšè—åŸŸ+if elseåœ¨UserServletä¸­åˆ¤æ–­
    * æ€ä¹ˆæŠŠifelseç»™çœæ‰ å°šç¡…è°·p227
    * æ€ä¹ˆæŠŠç”¨æˆ·æ¨¡å—å’Œå…¶ä»–æ¨¡å—çš„åå°„æ“ä½œè¿›è¡Œä»£ç å¤ç”¨ å°šç¡…è°·p228   
## jsp
* ä¸ºä»€ä¹ˆéœ€è¦jspï¼Ÿã€å°šç¡…è°·JavaWeb p172ã€‘
* ä¸ºä»€ä¹ˆè¯´jspçš„æœ¬è´¨æ˜¯ä¸ªServletï¼Ÿã€å°šç¡…è°·JavaWeb p174ã€‘
* å‰ç«¯æœ‰ä¸ªformè¡¨å•ï¼Œformé‡Œçš„actionåº”è¯¥å†™æ•´ä¸ªçš„urlï¼Œä½†æˆ‘æ€ä¹ˆçŸ¥é“é¡¹ç›®è¢«éƒ¨ç½²åˆ°å“ªå»ï¼Ÿ
* è„šæœ¬
    * è¾“å‡ºï¼Ÿ`<%=  somevalue  %>`
    * åœ¨jspä¸­,`<%  %>`ä»€ä¹ˆæ„æ€ã€å°šç¡…è°·JavaWeb p191ã€‘
* ELè¡¨è¾¾å¼
    * `${ key }`ä»€ä¹ˆæ„æ€ï¼Ÿ ç›¸å½“äº`<%=  req.getattribute("key")  %>`ï¼Œåœ¨è¾“å‡ºä¸Šï¼ŒELè¡¨è¾¾å¼è¿˜æ¯”jspè„šæœ¬ä¼˜è¶Šåœ¨å“ªé‡Œï¼Ÿ ï¼ˆnullä¸Šï¼‰


* ä¸‰å±‚æ¶æ„
    * ä»€ä¹ˆæ˜¯pojoåŒ…ï¼Ÿpojo(plain ordinary java project)
    * dao
        * ä¸ºä»€ä¹ˆdaoå±‚è¿˜è¦æä¸ªæ¥å£ï¼Ÿ ææ¥å£çš„ç›®çš„åœ¨äºï¼Œå°½ç®¡æ•°æ®åº“ä»£ç è¿˜æ²¡æœ‰å†™ï¼Œä»ç„¶ä¸å½±å“serviceå±‚è°ƒç”¨ã€‚ä¸ä¼šæŠ¥é”™   
## JSTL
* ä»€ä¹ˆæ˜¯JSTLï¼Ÿ JSTLç”¨JSTLæ ‡ç­¾`<c:set> <c:if>`ç­‰ä»£æ›¿<% %>;ç”¨`<c:if>`ä¸¾ä¾‹ï¼Œå¦‚æœæ²¡æœ‰`<c:if>`,æˆ‘ä»¬å°±è¦è‡ªå·±å†™è„šæœ¬<% %>,åœ¨è„šæœ¬é‡Œè¿›è¡Œåˆ¤æ–­;
> æƒ³è¦ä½¿ç”¨JSTLï¼Œéœ€è¦åœ¨jspä¸­å¯¼å…¥ï¼š`<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>`
* æ ‡ç­¾
    * `<c:set>`
    * `<c:if>`çš„ç”¨æ³•ï¼Ÿ testå±æ€§é‡Œé¢å¦‚æœä¸ºtrueåˆ™æ˜¾ç¤ºï¼Œå¦åˆ™ä¸æ˜¾ç¤ºï¼›é€šå¸¸ç”¨ELè¡¨è¾¾å¼æ¥å†™` <c:if  test="${!empty sessionScope.indexuser}">`
    * `<c:foreach>`
    ```html
    <c:forEach items="${movieList}" var="movie">
        ${movie}
    </c:forEach>
    ```
    * `<c:choose>`
    ```html
    <c:choose>
        <c:when test="${page.pageNo == 1}">ä¸Šä¸€é¡µ</c:when>
        <c:otherwise><a href="${path}/article/index?pageNo=${page.pageNo-1}">ä¸Šä¸€é¡µ</a></c:otherwise>
    </c:choose>
    ```
## Tomcat
* web.xml
å¦‚æœservlet-mappingä¸­ä¸å†™`/`å³
```xml
    <servlet-mapping>
        <servlet-name>Test2</servlet-name>
        <url-pattern>test</url-pattern>
    </servlet-mapping>
```
ä¼šæŠ¥é”™
* tomcatä¸­æ ¹æ®urlåŒ¹é…servletçš„æµç¨‹
    1ã€ç²¾å‡†åŒ¹é…ï¼š`/test`
    2ã€å‰ç¼€é€šé…ç¬¦åŒ¹é…:`*.jsp`
    3ã€æ‰©å±•åé€šé…ç¬¦åŒ¹é…:`a.*`
    4ã€é»˜è®¤åŒ¹é…:`/`
    > å¦‚ä½•ç†è§£/å’Œ/*çš„åŒºåˆ«æ˜¯/ä¸èƒ½åŒ¹é…jspï¼Œè€Œ/ *å´å¯ä»¥?
    /*åœ¨ç¬¬ä¸€é˜¶æ®µå°±ä¼šè¢«ç²¾å‡†åŒ¹é…ï¼Œæ‰€ä»¥ *.jspç¬¦åˆè¦æ±‚
    è€Œ/åœ¨æœ€åæ‰ä¼šè¢«åŒ¹é…ï¼Œåœ¨è¿™ä¹‹å‰ï¼Œä½ çš„*.jspå·²ç»è¢«tomcatè‡ªå·±çš„web.xmlåŒ¹é…æˆåŠŸäº†
* tomcatä¸­çš„web.xmlä¸è‡ªå·±çš„web.xmlä¹‹é—´çš„å…³ç³»
    1ã€`<welcome-file-list>`ï¼šå¦‚æœè‡ªå·±çš„å†™äº†ï¼Œè‡ªå·±çš„ä¼šå°†tomcatä¸­çš„æ›¿æ¢æ‰ï¼ˆtomcatè‡ªå·±è¯´çš„ï¼‰

<img src="./tomcatè¿æ¥å™¨.png" width="700px">

# æ¶æ„
* ä¸ºä»€ä¹ˆéœ€è¦Voï¼Ÿ
ä¸€ä¸ªé¡µé¢éœ€è¦çš„æ•°æ®å¯èƒ½æ¥è‡ªå¾ˆå¤šå¯¹è±¡
åœ¨ä»¥å‰ï¼Œæˆ‘ä»¬å°†å¾ˆå¤šå¯¹è±¡éƒ½å¡è¿›requesté‡Œé¢è¿”å›ç»™å‰ç«¯ï¼Œè¿™æ ·æœ‰ä¸€äº›å¼Šå¤„ï¼š
1ã€æš´éœ²äº†ä¸€äº›æ•°æ®ï¼šä¸€ä¸ªå¯¹è±¡ä¸­å¹¶ä¸æ˜¯æ‰€æœ‰å±æ€§éƒ½ä¼šç”¨åˆ°
2ã€å‰ç«¯å¾ˆéº»çƒ¦ï¼šå‰ç«¯éœ€è¦çŸ¥é“è¿”å›æ¥å‡ ä¸ªå¯¹è±¡ï¼Œä»¥åŠå¯¹è±¡ä¸­çš„å„ä¸ªå±æ€§çš„å«ä¹‰
å¼•å…¥Voä¹‹åï¼š
1ã€é¡µé¢éœ€è¦ä»€ä¹ˆï¼ŒVoå®šä¹‰ä»€ä¹ˆã€‚ä¸ä¼šæš´éœ²å¤šä½™çš„æ•°æ®
2ã€å‰ç«¯åªéœ€è¦çŸ¥é“Voä¸­çš„å„ä¸ªå±æ€§çš„å«ä¹‰å°±å¥½äº†ï¼Œè€Œä¸”åªæœ‰ä¸€ä¸ªVoå¯¹è±¡è¿”å›ç»™å‰ç«¯ï¼Œæ›´æ–¹ä¾¿
# JWT(Json Web Token)
* å‚è€ƒ
    * [ç¼–ç¨‹ä¸è‰¯äººBç«™è§†é¢‘](https://www.bilibili.com/video/BV1i54y1m7cP/?spm_id_from=333.999.0.0)
* cookieæ—¶ä»£
å½“æµè§ˆå™¨ç¬¬ä¸€æ¬¡è®¿é—®æœåŠ¡å™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šåœ¨è‡ªå·±å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªsessionï¼Œç„¶åæŠŠsessionIdï¼ˆCookieï¼‰ä¼ ç»™ç»™æµè§ˆå™¨ã€‚
æµè§ˆå™¨æ¯æ¬¡è¯·æ±‚æ—¶ä¼šæŠŠCookieç»™å¸¦ä¸Šï¼ŒæœåŠ¡å™¨ä¸€çœ‹æœ‰è‡ªå·±å‘çš„Cookieï¼Œå°±ç»™ä»–æä¾›æœåŠ¡ï¼›å¦åˆ™å°±æ‹’ç»æä¾›æœåŠ¡æˆ–è€…è®©æµè§ˆå™¨å»ç™»å½•
ç¼ºç‚¹ï¼š
1ã€sessionæ˜¯åœ¨æœåŠ¡å™¨çš„å†…å­˜é‡Œé¢çš„ï¼Œå¦‚æœç”¨æˆ·è¿‡å¤šï¼Œå…‰sessionå°±ä¼šå æ®æœåŠ¡å™¨ç»å¤§å¤šå†…å­˜
2ã€åˆ†å¸ƒå¼æ—¶ä»£ï¼Œsessionåªå­˜åœ¨ä¸å•ä¸ªæœºå™¨å†…éƒ¨ï¼Œå¦‚æœç”¨æˆ·ç™»å½•è¿‡äº†ï¼Œä½†æ˜¯è¯·æ±‚åˆ†é…ç»™å¦å¤–ä¸€å°æœºå™¨ï¼Œæœ€ç»ˆè¿˜æ˜¯æ˜¾ç¤ºç”¨æˆ·æ²¡ç™»é™†
3ã€ä¸å®‰å…¨ï¼šåœ¨å…å¯†ç™»å½•ä¸­ï¼Œå¦‚æœæˆ‘èƒ½æˆªè·cookieï¼Œé‚£æˆ‘å°±èƒ½éšæ„ç™»å½•ä»»ä½•ä¸€ä¸ªäººçš„è´¦æˆ·
* <img src = "./JWT.png">
* JWTçš„ä¼˜ç‚¹
1ã€ç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œä½†åªä¼ ç»™å‰ç«¯ï¼Œä¸ä¿å­˜åœ¨è‡ªå·±çš„å†…å­˜é‡Œï¼ˆè§£å†³å†…å­˜å ç”¨é—®é¢˜ï¼‰
2ã€å½“æœåŠ¡å™¨ç”ŸæˆJWTæ—¶ï¼Œä¼šæŠŠä¸€äº›ä¿¡æ¯ç¼–ç è¿›JWTä¸­ï¼Œè¿™æ ·æ¯æ¬¡æœåŠ¡å™¨æ‹¿åˆ°ä¸€ä¸ªJWTï¼Œå°±å¯ä»¥æ ¹æ®ç›¸åº”çš„ç®—æ³•æŠŠä¿¡æ¯å°±è§£ç å‡ºæ¥ï¼›è¿™æ ·ä¸€æ¥ï¼Œä»¥å‰ä¿å­˜åœ¨sessionä¸­çš„ä¿¡æ¯éƒ½å¯ä»¥ç¼–ç è¿›JWTä¸­ï¼ˆè§£å†³åˆ†å¸ƒå¼é—®é¢˜ï¼‰
3ã€JWTä¸èƒ½è§£å†³ä¸Šè¿°sessionçš„å®‰å…¨é—®é¢˜ï¼Œå¦‚æœJWTè¢«æˆªè·ç›—ç”¨ï¼Œä»ç„¶å¯ä»¥è®¿é—®è´¦æˆ·
* JWTä¸€èˆ¬æ”¾åœ¨responseè¯·æ±‚headerä¸­